import{r as $,j as a,a as ns,R as os,b as as,c as ls,d as cs,s as hs}from"./index-DA40QGzh.js";const de=[{label:"Sales Growth %",color:"#FF6B6B",value:"+12.5%"},{label:"Conversion Rate",color:"#4ECDC4",value:"4.2%"},{label:"Mystery Audit",color:"#45B7D1",value:"92/100"},{label:"NPS Score",color:"#96CEB4",value:"78"},{label:"VM Compliance",color:"#FFEEAD",value:"98%"},{label:"Inventory Turn",color:"#D4A5A5",value:"6.5x"}];function ct(){const[n,t]=$.useState(!1),[e,s]=$.useState(0),[i,o]=$.useState(null),u=()=>{if(n)return;t(!0),o(null);const f=Math.floor(Math.random()*360)+1440,d=e+f;s(d),setTimeout(()=>{t(!1);const p=d%360,_=Math.floor((360-p)/(360/de.length))%de.length;o(de[_])},4e3)};return a.jsxs("div",{className:"wheel-container",children:[a.jsx("h2",{className:"game-title",children:"Retail Premier League"}),a.jsxs("div",{className:"wheel-wrapper",children:[a.jsx("div",{className:"wheel-pointer"}),a.jsx("div",{className:`wheel ${n?"spinning":""}`,style:{transform:`rotate(${e}deg)`},children:de.map((f,d)=>a.jsx("div",{className:"wheel-segment",style:{"--i":d,"--clr":f.color,"--total":de.length},children:a.jsx("span",{className:"segment-text",children:f.label})},d))}),a.jsx("button",{className:"spin-button",onClick:u,disabled:n,children:n?"...":"SPIN"})]}),i&&a.jsxs("div",{className:"result-popup fade-in",children:[a.jsx("h3",{children:i.label}),a.jsx("div",{className:"result-value",children:i.value}),a.jsx("p",{children:"Top Performance this month!"})]})]})}const fs=[{label:"Donations Collected",value:"$12,450",icon:"volunteer_activism"},{label:"Trees Planted",value:"450",icon:"park"},{label:"Meals Distributed",value:"1,200",icon:"restaurant"},{label:"Volunteer Hours",value:"320",icon:"schedule"},{label:"Water Bottles Recycled",value:"5,000",icon:"recycling"},{label:"Kindness Notes Shared",value:"850",icon:"favorite"}];function us(){const[n,t]=$.useState(!1),[e,s]=$.useState(1),[i,o]=$.useState(null),u=()=>{if(n)return;t(!0),o(null);const f=Math.floor(Math.random()*6)+1;setTimeout(()=>{s(f),t(!1),o(fs[f-1])},1500)};return a.jsxs("div",{className:"dice-container",children:[a.jsx("h2",{className:"game-title",children:"Ramadan Kindness Quest"}),a.jsx("div",{className:"dice-scene",children:a.jsxs("div",{className:`dice ${n?"rolling":""}`,"data-side":e,children:[a.jsx("div",{className:"side one",children:a.jsx("div",{className:"dot"})}),a.jsxs("div",{className:"side two",children:[a.jsx("div",{className:"dot"}),a.jsx("div",{className:"dot"})]}),a.jsxs("div",{className:"side three",children:[a.jsx("div",{className:"dot"}),a.jsx("div",{className:"dot"}),a.jsx("div",{className:"dot"})]}),a.jsxs("div",{className:"side four",children:[a.jsx("div",{className:"dot"}),a.jsx("div",{className:"dot"}),a.jsx("div",{className:"dot"}),a.jsx("div",{className:"dot"})]}),a.jsxs("div",{className:"side five",children:[a.jsx("div",{className:"dot"}),a.jsx("div",{className:"dot"}),a.jsx("div",{className:"dot"}),a.jsx("div",{className:"dot"}),a.jsx("div",{className:"dot"})]}),a.jsxs("div",{className:"side six",children:[a.jsx("div",{className:"dot"}),a.jsx("div",{className:"dot"}),a.jsx("div",{className:"dot"}),a.jsx("div",{className:"dot"}),a.jsx("div",{className:"dot"}),a.jsx("div",{className:"dot"})]})]})}),a.jsx("button",{className:"roll-button",onClick:u,disabled:n,children:n?"ROLLING...":"ROLL DICE"}),i&&a.jsxs("div",{className:"quest-result fade-in",children:[a.jsx("span",{className:"material-symbols-outlined quest-icon",children:i.icon}),a.jsx("h3",{children:i.label}),a.jsx("div",{className:"quest-value",children:i.value}),a.jsx("p",{children:"Subhan Allah! Keep it up!"})]})]})}const ds=[{title:"Paper Wastage",value:"15%",goal:"5%",icon:"description",color:"#ff6b6b",desc:"Lower is better"},{title:"Energy Consumed",value:"420 kWh",goal:"350 kWh",icon:"bolt",color:"#ffd700",desc:"Monthly store average"},{title:"Recycling Rate",value:"68%",goal:"85%",icon:"recycling",color:"#4ecdc4",desc:"Targeting zero waste"}];function ps(){return a.jsxs("div",{className:"sustainability-container",children:[a.jsx("h2",{className:"game-title",children:"Sustainability Mission"}),a.jsx("div",{className:"metrics-grid",children:ds.map((n,t)=>a.jsxs("div",{className:"metric-card",style:{"--accent":n.color},children:[a.jsxs("div",{className:"metric-header",children:[a.jsx("span",{className:"material-symbols-outlined metric-icon",children:n.icon}),a.jsx("h3",{children:n.title})]}),a.jsxs("div",{className:"metric-body",children:[a.jsxs("div",{className:"value-display",children:[a.jsx("span",{className:"current-value",children:n.value}),a.jsxs("span",{className:"goal-label",children:["Goal: ",n.goal]})]}),a.jsx("div",{className:"progress-bar-bg",children:a.jsx("div",{className:"progress-bar-fill",style:{width:t===0?"75%":t===1?"85%":"68%"}})}),a.jsx("p",{className:"metric-desc",children:n.desc})]})]},t))}),a.jsxs("div",{className:"mission-footer",children:[a.jsx("p",{children:"Every small step counts towards a greener future."}),a.jsx("button",{className:"pledge-button",children:"Take the Pledge"})]})]})}function gs(n){return n!==null?{comment:n,variations:[]}:{variations:[]}}function ms(n,t,e,s,i){const o={move:n,variations:i};return t&&(o.suffix=t),e&&(o.nag=e),s!==null&&(o.comment=s),o}function _s(...n){const[t,...e]=n;let s=t;for(const i of e)i!==null&&(s.variations=[i,...i.variations],i.variations=[],s=i);return t}function vs(n,t){if(t.marker&&t.marker.comment){let e=t.root;for(;;){const s=e.variations[0];if(!s){e.comment=t.marker.comment;break}e=s}}return{headers:n,root:t.root,result:(t.marker&&t.marker.result)??void 0}}function bs(n,t){function e(){this.constructor=n}e.prototype=t.prototype,n.prototype=new e}function ae(n,t,e,s){var i=Error.call(this,n);return Object.setPrototypeOf&&Object.setPrototypeOf(i,ae.prototype),i.expected=t,i.found=e,i.location=s,i.name="SyntaxError",i}bs(ae,Error);function Me(n,t,e){return e=e||" ",n.length>t?n:(t-=n.length,e+=e.repeat(t),n+e.slice(0,t))}ae.prototype.format=function(n){var t="Error: "+this.message;if(this.location){var e=null,s;for(s=0;s<n.length;s++)if(n[s].source===this.location.source){e=n[s].text.split(/\r\n|\n|\r/g);break}var i=this.location.start,o=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(i):i,u=this.location.source+":"+o.line+":"+o.column;if(e){var f=this.location.end,d=Me("",o.line.toString().length," "),p=e[i.line-1],_=i.line===f.line?f.column:p.length+1,k=_-i.column||1;t+=`
 --> `+u+`
`+d+` |
`+o.line+" | "+p+`
`+d+" | "+Me("",i.column-1," ")+Me("",k,"^")}else t+=`
 at `+u}return t};ae.buildMessage=function(n,t){var e={literal:function(p){return'"'+i(p.text)+'"'},class:function(p){var _=p.parts.map(function(k){return Array.isArray(k)?o(k[0])+"-"+o(k[1]):o(k)});return"["+(p.inverted?"^":"")+_.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(p){return p.description}};function s(p){return p.charCodeAt(0).toString(16).toUpperCase()}function i(p){return p.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(_){return"\\x0"+s(_)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(_){return"\\x"+s(_)})}function o(p){return p.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(_){return"\\x0"+s(_)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(_){return"\\x"+s(_)})}function u(p){return e[p.type](p)}function f(p){var _=p.map(u),k,m;if(_.sort(),_.length>0){for(k=1,m=1;k<_.length;k++)_[k-1]!==_[k]&&(_[m]=_[k],m++);_.length=m}switch(_.length){case 1:return _[0];case 2:return _[0]+" or "+_[1];default:return _.slice(0,-1).join(", ")+", or "+_[_.length-1]}}function d(p){return p?'"'+i(p)+'"':"end of input"}return"Expected "+f(n)+" but "+d(t)+" found."};function xs(n,t){t=t!==void 0?t:{};var e={},s=t.grammarSource,i={pgn:Je},o=Je,u="[",f='"',d="]",p=".",_="O-O-O",k="O-O",m="0-0-0",v="0-0",E="$",j="{",q="}",re=";",G="(",Pe=")",Y="1-0",le="0-1",z="1/2-1/2",Te="*",H=/^[a-zA-Z]/,_e=/^[^"]/,ee=/^[0-9]/,ce=/^[.]/,he=/^[a-zA-Z1-8\-=]/,ve=/^[+#]/,be=/^[!?]/,xe=/^[^}]/,y=/^[^\r\n]/,C=/^[ \t\r\n]/,P=B("tag pair"),M=O("[",!1),R=O('"',!1),V=O("]",!1),Se=B("tag name"),ne=W([["a","z"],["A","Z"]],!1,!1),fe=B("tag value"),Be=W(['"'],!0,!1),ft=B("move number"),Ne=W([["0","9"]],!1,!1),ut=O(".",!1),Ge=W(["."],!1,!1),dt=B("standard algebraic notation"),pt=O("O-O-O",!1),gt=O("O-O",!1),mt=O("0-0-0",!1),_t=O("0-0",!1),Qe=W([["a","z"],["A","Z"],["1","8"],"-","="],!1,!1),vt=W(["+","#"],!1,!1),bt=B("suffix annotation"),We=W(["!","?"],!1,!1),xt=B("NAG"),St=O("$",!1),Nt=B("brace comment"),wt=O("{",!1),He=W(["}"],!0,!1),kt=O("}",!1),Et=B("rest of line comment"),yt=O(";",!1),Ve=W(["\r",`
`],!0,!1),Ct=B("variation"),At=O("(",!1),jt=O(")",!1),$t=B("game termination marker"),Pt=O("1-0",!1),Tt=O("0-1",!1),It=O("1/2-1/2",!1),Mt=O("*",!1),Rt=B("whitespace"),Ye=W([" ","	","\r",`
`],!1,!1),Ot=function(r,c){return vs(r,c)},Lt=function(r){return Object.fromEntries(r)},Kt=function(r,c){return[r,c]},qt=function(r,c){return{root:r,marker:c}},Ft=function(r,c){return _s(gs(r),...c.flat())},Dt=function(r,c,h,x,S){return ms(r,c,h,x,S)},Ut=function(r){return r},Bt=function(r){return r.replace(/[\r\n]+/g," ")},Gt=function(r){return r.trim()},Qt=function(r){return r},Wt=function(r,c){return{result:r,comment:c}},l=t.peg$currPos|0,oe=[{line:1,column:1}],Q=l,we=t.peg$maxFailExpected||[],g=t.peg$silentFails|0,ue;if(t.startRule){if(!(t.startRule in i))throw new Error(`Can't start parsing from rule "`+t.startRule+'".');o=i[t.startRule]}function O(r,c){return{type:"literal",text:r,ignoreCase:c}}function W(r,c,h){return{type:"class",parts:r,inverted:c,ignoreCase:h}}function Ht(){return{type:"end"}}function B(r){return{type:"other",description:r}}function ze(r){var c=oe[r],h;if(c)return c;if(r>=oe.length)h=oe.length-1;else for(h=r;!oe[--h];);for(c=oe[h],c={line:c.line,column:c.column};h<r;)n.charCodeAt(h)===10?(c.line++,c.column=1):c.column++,h++;return oe[r]=c,c}function Ze(r,c,h){var x=ze(r),S=ze(c),A={source:s,start:{offset:r,line:x.line,column:x.column},end:{offset:c,line:S.line,column:S.column}};return A}function b(r){l<Q||(l>Q&&(Q=l,we=[]),we.push(r))}function Vt(r,c,h){return new ae(ae.buildMessage(r,c),r,c,h)}function Je(){var r,c,h;return r=l,c=Yt(),h=Jt(),r=Ot(c,h),r}function Yt(){var r,c,h;for(r=l,c=[],h=Xe();h!==e;)c.push(h),h=Xe();return h=D(),r=Lt(c),r}function Xe(){var r,c,h,x,S,A,te;return g++,r=l,D(),n.charCodeAt(l)===91?(c=u,l++):(c=e,g===0&&b(M)),c!==e?(D(),h=zt(),h!==e?(D(),n.charCodeAt(l)===34?(x=f,l++):(x=e,g===0&&b(R)),x!==e?(S=Zt(),n.charCodeAt(l)===34?(A=f,l++):(A=e,g===0&&b(R)),A!==e?(D(),n.charCodeAt(l)===93?(te=d,l++):(te=e,g===0&&b(V)),te!==e?r=Kt(h,S):(l=r,r=e)):(l=r,r=e)):(l=r,r=e)):(l=r,r=e)):(l=r,r=e),g--,r===e&&g===0&&b(P),r}function zt(){var r,c,h;if(g++,r=l,c=[],h=n.charAt(l),H.test(h)?l++:(h=e,g===0&&b(ne)),h!==e)for(;h!==e;)c.push(h),h=n.charAt(l),H.test(h)?l++:(h=e,g===0&&b(ne));else c=e;return c!==e?r=n.substring(r,l):r=c,g--,r===e&&(c=e,g===0&&b(Se)),r}function Zt(){var r,c,h;for(g++,r=l,c=[],h=n.charAt(l),_e.test(h)?l++:(h=e,g===0&&b(Be));h!==e;)c.push(h),h=n.charAt(l),_e.test(h)?l++:(h=e,g===0&&b(Be));return r=n.substring(r,l),g--,c=e,g===0&&b(fe),r}function Jt(){var r,c,h;return r=l,c=et(),D(),h=rs(),h===e&&(h=null),D(),r=qt(c,h),r}function et(){var r,c,h,x;for(r=l,c=Ie(),c===e&&(c=null),h=[],x=tt();x!==e;)h.push(x),x=tt();return r=Ft(c,h),r}function tt(){var r,c,h,x,S,A,te,ke;if(r=l,D(),Xt(),D(),c=es(),c!==e){for(h=ts(),h===e&&(h=null),x=[],S=st();S!==e;)x.push(S),S=st();for(S=D(),A=Ie(),A===e&&(A=null),te=[],ke=it();ke!==e;)te.push(ke),ke=it();r=Dt(c,h,x,A,te)}else l=r,r=e;return r}function Xt(){var r,c,h,x,S,A;for(g++,r=l,c=[],h=n.charAt(l),ee.test(h)?l++:(h=e,g===0&&b(Ne));h!==e;)c.push(h),h=n.charAt(l),ee.test(h)?l++:(h=e,g===0&&b(Ne));if(n.charCodeAt(l)===46?(h=p,l++):(h=e,g===0&&b(ut)),h!==e){for(x=D(),S=[],A=n.charAt(l),ce.test(A)?l++:(A=e,g===0&&b(Ge));A!==e;)S.push(A),A=n.charAt(l),ce.test(A)?l++:(A=e,g===0&&b(Ge));c=[c,h,x,S],r=c}else l=r,r=e;return g--,r===e&&(c=e,g===0&&b(ft)),r}function es(){var r,c,h,x,S,A;if(g++,r=l,c=l,n.substr(l,5)===_?(h=_,l+=5):(h=e,g===0&&b(pt)),h===e&&(n.substr(l,3)===k?(h=k,l+=3):(h=e,g===0&&b(gt)),h===e&&(n.substr(l,5)===m?(h=m,l+=5):(h=e,g===0&&b(mt)),h===e&&(n.substr(l,3)===v?(h=v,l+=3):(h=e,g===0&&b(_t)),h===e))))if(h=l,x=n.charAt(l),H.test(x)?l++:(x=e,g===0&&b(ne)),x!==e){if(S=[],A=n.charAt(l),he.test(A)?l++:(A=e,g===0&&b(Qe)),A!==e)for(;A!==e;)S.push(A),A=n.charAt(l),he.test(A)?l++:(A=e,g===0&&b(Qe));else S=e;S!==e?(x=[x,S],h=x):(l=h,h=e)}else l=h,h=e;return h!==e?(x=n.charAt(l),ve.test(x)?l++:(x=e,g===0&&b(vt)),x===e&&(x=null),h=[h,x],c=h):(l=c,c=e),c!==e?r=n.substring(r,l):r=c,g--,r===e&&(c=e,g===0&&b(dt)),r}function ts(){var r,c,h;for(g++,r=l,c=[],h=n.charAt(l),be.test(h)?l++:(h=e,g===0&&b(We));h!==e;)c.push(h),c.length>=2?h=e:(h=n.charAt(l),be.test(h)?l++:(h=e,g===0&&b(We)));return c.length<1?(l=r,r=e):r=c,g--,r===e&&(c=e,g===0&&b(bt)),r}function st(){var r,c,h,x,S;if(g++,r=l,D(),n.charCodeAt(l)===36?(c=E,l++):(c=e,g===0&&b(St)),c!==e){if(h=l,x=[],S=n.charAt(l),ee.test(S)?l++:(S=e,g===0&&b(Ne)),S!==e)for(;S!==e;)x.push(S),S=n.charAt(l),ee.test(S)?l++:(S=e,g===0&&b(Ne));else x=e;x!==e?h=n.substring(h,l):h=x,h!==e?r=Ut(h):(l=r,r=e)}else l=r,r=e;return g--,r===e&&g===0&&b(xt),r}function Ie(){var r;return r=ss(),r===e&&(r=is()),r}function ss(){var r,c,h,x,S;if(g++,r=l,n.charCodeAt(l)===123?(c=j,l++):(c=e,g===0&&b(wt)),c!==e){for(h=l,x=[],S=n.charAt(l),xe.test(S)?l++:(S=e,g===0&&b(He));S!==e;)x.push(S),S=n.charAt(l),xe.test(S)?l++:(S=e,g===0&&b(He));h=n.substring(h,l),n.charCodeAt(l)===125?(x=q,l++):(x=e,g===0&&b(kt)),x!==e?r=Bt(h):(l=r,r=e)}else l=r,r=e;return g--,r===e&&(c=e,g===0&&b(Nt)),r}function is(){var r,c,h,x,S;if(g++,r=l,n.charCodeAt(l)===59?(c=re,l++):(c=e,g===0&&b(yt)),c!==e){for(h=l,x=[],S=n.charAt(l),y.test(S)?l++:(S=e,g===0&&b(Ve));S!==e;)x.push(S),S=n.charAt(l),y.test(S)?l++:(S=e,g===0&&b(Ve));h=n.substring(h,l),r=Gt(h)}else l=r,r=e;return g--,r===e&&(c=e,g===0&&b(Et)),r}function it(){var r,c,h,x;return g++,r=l,D(),n.charCodeAt(l)===40?(c=G,l++):(c=e,g===0&&b(At)),c!==e?(h=et(),h!==e?(D(),n.charCodeAt(l)===41?(x=Pe,l++):(x=e,g===0&&b(jt)),x!==e?r=Qt(h):(l=r,r=e)):(l=r,r=e)):(l=r,r=e),g--,r===e&&g===0&&b(Ct),r}function rs(){var r,c,h;return g++,r=l,n.substr(l,3)===Y?(c=Y,l+=3):(c=e,g===0&&b(Pt)),c===e&&(n.substr(l,3)===le?(c=le,l+=3):(c=e,g===0&&b(Tt)),c===e&&(n.substr(l,7)===z?(c=z,l+=7):(c=e,g===0&&b(It)),c===e&&(n.charCodeAt(l)===42?(c=Te,l++):(c=e,g===0&&b(Mt))))),c!==e?(D(),h=Ie(),h===e&&(h=null),r=Wt(c,h)):(l=r,r=e),g--,r===e&&(c=e,g===0&&b($t)),r}function D(){var r,c;for(g++,r=[],c=n.charAt(l),C.test(c)?l++:(c=e,g===0&&b(Ye));c!==e;)r.push(c),c=n.charAt(l),C.test(c)?l++:(c=e,g===0&&b(Ye));return g--,c=e,g===0&&b(Rt),r}if(ue=o(),t.peg$library)return{peg$result:ue,peg$currPos:l,peg$FAILED:e,peg$maxFailExpected:we,peg$maxFailPos:Q};if(ue!==e&&l===n.length)return ue;throw ue!==e&&l<n.length&&b(Ht()),Vt(we,Q<n.length?n.charAt(Q):null,Q<n.length?Ze(Q,Q+1):Ze(Q,Q))}const Ae=0xffffffffffffffffn;function Re(n,t){return(n<<t|n>>64n-t)&0xffffffffffffffffn}function rt(n,t){return n*t&Ae}function Ss(n){return function(){let t=BigInt(n&Ae),e=BigInt(n>>64n&Ae);const s=rt(Re(rt(t,5n),7n),9n);return e^=t,t=(Re(t,24n)^e^e<<16n)&Ae,e=Re(e,37n),n=e<<64n|t,s}}const $e=Ss(0xa187eb39cdcaed8f31c4b365b102e01en),Ns=Array.from({length:2},()=>Array.from({length:6},()=>Array.from({length:128},()=>$e()))),ws=Array.from({length:8},()=>$e()),ks=Array.from({length:16},()=>$e()),Oe=$e(),F="w",U="b",T="p",De="n",je="b",ge="r",X="q",I="k",Le="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1";class Ee{color;from;to;piece;captured;promotion;flags;san;lan;before;after;constructor(t,e){const{color:s,piece:i,from:o,to:u,flags:f,captured:d,promotion:p}=e,_=L(o),k=L(u);this.color=s,this.piece=i,this.from=_,this.to=k,this.san=t._moveToSan(e,t._moves({legal:!0})),this.lan=_+k,this.before=t.fen(),t._makeMove(e),this.after=t.fen(),t._undoMove(),this.flags="";for(const m in w)w[m]&f&&(this.flags+=se[m]);d&&(this.captured=d),p&&(this.promotion=p,this.lan+=p)}isCapture(){return this.flags.indexOf(se.CAPTURE)>-1}isPromotion(){return this.flags.indexOf(se.PROMOTION)>-1}isEnPassant(){return this.flags.indexOf(se.EP_CAPTURE)>-1}isKingsideCastle(){return this.flags.indexOf(se.KSIDE_CASTLE)>-1}isQueensideCastle(){return this.flags.indexOf(se.QSIDE_CASTLE)>-1}isBigPawn(){return this.flags.indexOf(se.BIG_PAWN)>-1}}const K=-1,se={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q",NULL_MOVE:"-"},w={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64,NULL_MOVE:128},Ue={Event:"?",Site:"?",Date:"????.??.??",Round:"?",White:"?",Black:"?",Result:"*"},Es={WhiteTitle:null,BlackTitle:null,WhiteElo:null,BlackElo:null,WhiteUSCF:null,BlackUSCF:null,WhiteNA:null,BlackNA:null,WhiteType:null,BlackType:null,EventDate:null,EventSponsor:null,Section:null,Stage:null,Board:null,Opening:null,Variation:null,SubVariation:null,ECO:null,NIC:null,Time:null,UTCTime:null,UTCDate:null,TimeControl:null,SetUp:null,FEN:null,Termination:null,Annotator:null,Mode:null,PlyCount:null},ys={...Ue,...Es},N={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},Ke={b:[16,32,17,15],w:[-16,-32,-17,-15]},nt={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},Cs=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],As=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],js={p:1,n:2,b:4,r:8,q:16,k:32},$s="pnbrqkPNBRQK",ot=[De,je,ge,X],Ps=7,Ts=6,Is=1,Ms=0,ye={[I]:w.KSIDE_CASTLE,[X]:w.QSIDE_CASTLE},Z={w:[{square:N.a1,flag:w.QSIDE_CASTLE},{square:N.h1,flag:w.KSIDE_CASTLE}],b:[{square:N.a8,flag:w.QSIDE_CASTLE},{square:N.h8,flag:w.KSIDE_CASTLE}]},Rs={b:Is,w:Ts},qe="--";function ie(n){return n>>4}function me(n){return n&15}function ht(n){return"0123456789".indexOf(n)!==-1}function L(n){const t=me(n),e=ie(n);return"abcdefgh".substring(t,t+1)+"87654321".substring(e,e+1)}function pe(n){return n===F?U:F}function Os(n){const t=n.split(/\s+/);if(t.length!==6)return{ok:!1,error:"Invalid FEN: must contain six space-delimited fields"};const e=parseInt(t[5],10);if(isNaN(e)||e<=0)return{ok:!1,error:"Invalid FEN: move number must be a positive integer"};const s=parseInt(t[4],10);if(isNaN(s)||s<0)return{ok:!1,error:"Invalid FEN: half move counter number must be a non-negative integer"};if(!/^(-|[abcdefgh][36])$/.test(t[3]))return{ok:!1,error:"Invalid FEN: en-passant square is invalid"};if(/[^kKqQ-]/.test(t[2]))return{ok:!1,error:"Invalid FEN: castling availability is invalid"};if(!/^(w|b)$/.test(t[1]))return{ok:!1,error:"Invalid FEN: side-to-move is invalid"};const i=t[0].split("/");if(i.length!==8)return{ok:!1,error:"Invalid FEN: piece data does not contain 8 '/'-delimited rows"};for(let u=0;u<i.length;u++){let f=0,d=!1;for(let p=0;p<i[u].length;p++)if(ht(i[u][p])){if(d)return{ok:!1,error:"Invalid FEN: piece data is invalid (consecutive number)"};f+=parseInt(i[u][p],10),d=!0}else{if(!/^[prnbqkPRNBQK]$/.test(i[u][p]))return{ok:!1,error:"Invalid FEN: piece data is invalid (invalid piece)"};f+=1,d=!1}if(f!==8)return{ok:!1,error:"Invalid FEN: piece data is invalid (too many squares in rank)"}}if(t[3][1]=="3"&&t[1]=="w"||t[3][1]=="6"&&t[1]=="b")return{ok:!1,error:"Invalid FEN: illegal en-passant square"};const o=[{color:"white",regex:/K/g},{color:"black",regex:/k/g}];for(const{color:u,regex:f}of o){if(!f.test(t[0]))return{ok:!1,error:`Invalid FEN: missing ${u} king`};if((t[0].match(f)||[]).length>1)return{ok:!1,error:`Invalid FEN: too many ${u} kings`}}return Array.from(i[0]+i[7]).some(u=>u.toUpperCase()==="P")?{ok:!1,error:"Invalid FEN: some pawns are on the edge rows"}:{ok:!0}}function Ls(n,t){const e=n.from,s=n.to,i=n.piece;let o=0,u=0,f=0;for(let d=0,p=t.length;d<p;d++){const _=t[d].from,k=t[d].to,m=t[d].piece;i===m&&e!==_&&s===k&&(o++,ie(e)===ie(_)&&u++,me(e)===me(_)&&f++)}return o>0?u>0&&f>0?L(e):f>0?L(e).charAt(1):L(e).charAt(0):""}function J(n,t,e,s,i,o=void 0,u=w.NORMAL){const f=ie(s);if(i===T&&(f===Ps||f===Ms))for(let d=0;d<ot.length;d++){const p=ot[d];n.push({color:t,from:e,to:s,piece:i,captured:o,promotion:p,flags:u|w.PROMOTION})}else n.push({color:t,from:e,to:s,piece:i,captured:o,flags:u})}function at(n){let t=n.charAt(0);return t>="a"&&t<="h"?n.match(/[a-h]\d.*[a-h]\d/)?void 0:T:(t=t.toLowerCase(),t==="o"?I:t)}function Fe(n){return n.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}class Ks{_board=new Array(128);_turn=F;_header={};_kings={w:K,b:K};_epSquare=-1;_halfMoves=0;_moveNumber=0;_history=[];_comments={};_castling={w:0,b:0};_hash=0n;_positionCount=new Map;constructor(t=Le,{skipValidation:e=!1}={}){this.load(t,{skipValidation:e})}clear({preserveHeaders:t=!1}={}){this._board=new Array(128),this._kings={w:K,b:K},this._turn=F,this._castling={w:0,b:0},this._epSquare=K,this._halfMoves=0,this._moveNumber=1,this._history=[],this._comments={},this._header=t?this._header:{...ys},this._hash=this._computeHash(),this._positionCount=new Map,this._header.SetUp=null,this._header.FEN=null}load(t,{skipValidation:e=!1,preserveHeaders:s=!1}={}){let i=t.split(/\s+/);if(i.length>=2&&i.length<6){const f=["-","-","0","1"];t=i.concat(f.slice(-(6-i.length))).join(" ")}if(i=t.split(/\s+/),!e){const{ok:f,error:d}=Os(t);if(!f)throw new Error(d)}const o=i[0];let u=0;this.clear({preserveHeaders:s});for(let f=0;f<o.length;f++){const d=o.charAt(f);if(d==="/")u+=8;else if(ht(d))u+=parseInt(d,10);else{const p=d<"a"?F:U;this._put({type:d.toLowerCase(),color:p},L(u)),u++}}this._turn=i[1],i[2].indexOf("K")>-1&&(this._castling.w|=w.KSIDE_CASTLE),i[2].indexOf("Q")>-1&&(this._castling.w|=w.QSIDE_CASTLE),i[2].indexOf("k")>-1&&(this._castling.b|=w.KSIDE_CASTLE),i[2].indexOf("q")>-1&&(this._castling.b|=w.QSIDE_CASTLE),this._epSquare=i[3]==="-"?K:N[i[3]],this._halfMoves=parseInt(i[4],10),this._moveNumber=parseInt(i[5],10),this._hash=this._computeHash(),this._updateSetup(t),this._incPositionCount()}fen({forceEnpassantSquare:t=!1}={}){let e=0,s="";for(let u=N.a8;u<=N.h1;u++){if(this._board[u]){e>0&&(s+=e,e=0);const{color:f,type:d}=this._board[u];s+=f===F?d.toUpperCase():d.toLowerCase()}else e++;u+1&136&&(e>0&&(s+=e),u!==N.h1&&(s+="/"),e=0,u+=8)}let i="";this._castling[F]&w.KSIDE_CASTLE&&(i+="K"),this._castling[F]&w.QSIDE_CASTLE&&(i+="Q"),this._castling[U]&w.KSIDE_CASTLE&&(i+="k"),this._castling[U]&w.QSIDE_CASTLE&&(i+="q"),i=i||"-";let o="-";if(this._epSquare!==K)if(t)o=L(this._epSquare);else{const u=this._epSquare+(this._turn===F?16:-16),f=[u+1,u-1];for(const d of f){if(d&136)continue;const p=this._turn;if(this._board[d]?.color===p&&this._board[d]?.type===T){this._makeMove({color:p,from:d,to:this._epSquare,piece:T,captured:T,flags:w.EP_CAPTURE});const _=!this._isKingAttacked(p);if(this._undoMove(),_){o=L(this._epSquare);break}}}}return[s,this._turn,i,o,this._halfMoves,this._moveNumber].join(" ")}_pieceKey(t){if(!this._board[t])return 0n;const{color:e,type:s}=this._board[t],i={w:0,b:1}[e],o={p:0,n:1,b:2,r:3,q:4,k:5}[s];return Ns[i][o][t]}_epKey(){return this._epSquare===K?0n:ws[this._epSquare&7]}_castlingKey(){const t=this._castling.w>>5|this._castling.b>>3;return ks[t]}_computeHash(){let t=0n;for(let e=N.a8;e<=N.h1;e++){if(e&136){e+=7;continue}this._board[e]&&(t^=this._pieceKey(e))}return t^=this._epKey(),t^=this._castlingKey(),this._turn==="b"&&(t^=Oe),t}_updateSetup(t){this._history.length>0||(t!==Le?(this._header.SetUp="1",this._header.FEN=t):(this._header.SetUp=null,this._header.FEN=null))}reset(){this.load(Le)}get(t){return this._board[N[t]]}findPiece(t){const e=[];for(let s=N.a8;s<=N.h1;s++){if(s&136){s+=7;continue}!this._board[s]||this._board[s]?.color!==t.color||this._board[s].color===t.color&&this._board[s].type===t.type&&e.push(L(s))}return e}put({type:t,color:e},s){return this._put({type:t,color:e},s)?(this._updateCastlingRights(),this._updateEnPassantSquare(),this._updateSetup(this.fen()),!0):!1}_set(t,e){this._hash^=this._pieceKey(t),this._board[t]=e,this._hash^=this._pieceKey(t)}_put({type:t,color:e},s){if($s.indexOf(t.toLowerCase())===-1||!(s in N))return!1;const i=N[s];if(t==I&&!(this._kings[e]==K||this._kings[e]==i))return!1;const o=this._board[i];return o&&o.type===I&&(this._kings[o.color]=K),this._set(i,{type:t,color:e}),t===I&&(this._kings[e]=i),!0}_clear(t){this._hash^=this._pieceKey(t),delete this._board[t]}remove(t){const e=this.get(t);return this._clear(N[t]),e&&e.type===I&&(this._kings[e.color]=K),this._updateCastlingRights(),this._updateEnPassantSquare(),this._updateSetup(this.fen()),e}_updateCastlingRights(){this._hash^=this._castlingKey();const t=this._board[N.e1]?.type===I&&this._board[N.e1]?.color===F,e=this._board[N.e8]?.type===I&&this._board[N.e8]?.color===U;(!t||this._board[N.a1]?.type!==ge||this._board[N.a1]?.color!==F)&&(this._castling.w&=-65),(!t||this._board[N.h1]?.type!==ge||this._board[N.h1]?.color!==F)&&(this._castling.w&=-33),(!e||this._board[N.a8]?.type!==ge||this._board[N.a8]?.color!==U)&&(this._castling.b&=-65),(!e||this._board[N.h8]?.type!==ge||this._board[N.h8]?.color!==U)&&(this._castling.b&=-33),this._hash^=this._castlingKey()}_updateEnPassantSquare(){if(this._epSquare===K)return;const t=this._epSquare+(this._turn===F?-16:16),e=this._epSquare+(this._turn===F?16:-16),s=[e+1,e-1];if(this._board[t]!==null||this._board[this._epSquare]!==null||this._board[e]?.color!==pe(this._turn)||this._board[e]?.type!==T){this._hash^=this._epKey(),this._epSquare=K;return}const i=o=>!(o&136)&&this._board[o]?.color===this._turn&&this._board[o]?.type===T;s.some(i)||(this._hash^=this._epKey(),this._epSquare=K)}_attacked(t,e,s){const i=[];for(let o=N.a8;o<=N.h1;o++){if(o&136){o+=7;continue}if(this._board[o]===void 0||this._board[o].color!==t)continue;const u=this._board[o],f=o-e;if(f===0)continue;const d=f+119;if(Cs[d]&js[u.type]){if(u.type===T){if(f>0&&u.color===F||f<=0&&u.color===U)if(s)i.push(L(o));else return!0;continue}if(u.type==="n"||u.type==="k")if(s){i.push(L(o));continue}else return!0;const p=As[d];let _=o+p,k=!1;for(;_!==e;){if(this._board[_]!=null){k=!0;break}_+=p}if(!k)if(s){i.push(L(o));continue}else return!0}}return s?i:!1}attackers(t,e){return e?this._attacked(e,N[t],!0):this._attacked(this._turn,N[t],!0)}_isKingAttacked(t){const e=this._kings[t];return e===-1?!1:this._attacked(pe(t),e)}hash(){return this._hash.toString(16)}isAttacked(t,e){return this._attacked(e,N[t])}isCheck(){return this._isKingAttacked(this._turn)}inCheck(){return this.isCheck()}isCheckmate(){return this.isCheck()&&this._moves().length===0}isStalemate(){return!this.isCheck()&&this._moves().length===0}isInsufficientMaterial(){const t={b:0,n:0,r:0,q:0,k:0,p:0},e=[];let s=0,i=0;for(let o=N.a8;o<=N.h1;o++){if(i=(i+1)%2,o&136){o+=7;continue}const u=this._board[o];u&&(t[u.type]=u.type in t?t[u.type]+1:1,u.type===je&&e.push(i),s++)}if(s===2)return!0;if(s===3&&(t[je]===1||t[De]===1))return!0;if(s===t[je]+2){let o=0;const u=e.length;for(let f=0;f<u;f++)o+=e[f];if(o===0||o===u)return!0}return!1}isThreefoldRepetition(){return this._getPositionCount(this._hash)>=3}isDrawByFiftyMoves(){return this._halfMoves>=100}isDraw(){return this.isDrawByFiftyMoves()||this.isStalemate()||this.isInsufficientMaterial()||this.isThreefoldRepetition()}isGameOver(){return this.isCheckmate()||this.isDraw()}moves({verbose:t=!1,square:e=void 0,piece:s=void 0}={}){const i=this._moves({square:e,piece:s});return t?i.map(o=>new Ee(this,o)):i.map(o=>this._moveToSan(o,i))}_moves({legal:t=!0,piece:e=void 0,square:s=void 0}={}){const i=s?s.toLowerCase():void 0,o=e?.toLowerCase(),u=[],f=this._turn,d=pe(f);let p=N.a8,_=N.h1,k=!1;if(i)if(i in N)p=_=N[i],k=!0;else return[];for(let v=p;v<=_;v++){if(v&136){v+=7;continue}if(!this._board[v]||this._board[v].color===d)continue;const{type:E}=this._board[v];let j;if(E===T){if(o&&o!==E)continue;j=v+Ke[f][0],this._board[j]||(J(u,f,v,j,T),j=v+Ke[f][1],Rs[f]===ie(v)&&!this._board[j]&&J(u,f,v,j,T,void 0,w.BIG_PAWN));for(let q=2;q<4;q++)j=v+Ke[f][q],!(j&136)&&(this._board[j]?.color===d?J(u,f,v,j,T,this._board[j].type,w.CAPTURE):j===this._epSquare&&J(u,f,v,j,T,T,w.EP_CAPTURE))}else{if(o&&o!==E)continue;for(let q=0,re=nt[E].length;q<re;q++){const G=nt[E][q];for(j=v;j+=G,!(j&136);){if(!this._board[j])J(u,f,v,j,E);else{if(this._board[j].color===f)break;J(u,f,v,j,E,this._board[j].type,w.CAPTURE);break}if(E===De||E===I)break}}}}if((o===void 0||o===I)&&(!k||_===this._kings[f])){if(this._castling[f]&w.KSIDE_CASTLE){const v=this._kings[f],E=v+2;!this._board[v+1]&&!this._board[E]&&!this._attacked(d,this._kings[f])&&!this._attacked(d,v+1)&&!this._attacked(d,E)&&J(u,f,this._kings[f],E,I,void 0,w.KSIDE_CASTLE)}if(this._castling[f]&w.QSIDE_CASTLE){const v=this._kings[f],E=v-2;!this._board[v-1]&&!this._board[v-2]&&!this._board[v-3]&&!this._attacked(d,this._kings[f])&&!this._attacked(d,v-1)&&!this._attacked(d,E)&&J(u,f,this._kings[f],E,I,void 0,w.QSIDE_CASTLE)}}if(!t||this._kings[f]===-1)return u;const m=[];for(let v=0,E=u.length;v<E;v++)this._makeMove(u[v]),this._isKingAttacked(f)||m.push(u[v]),this._undoMove();return m}move(t,{strict:e=!1}={}){let s=null;if(typeof t=="string")s=this._moveFromSan(t,e);else if(t===null)s=this._moveFromSan(qe,e);else if(typeof t=="object"){const o=this._moves();for(let u=0,f=o.length;u<f;u++)if(t.from===L(o[u].from)&&t.to===L(o[u].to)&&(!("promotion"in o[u])||t.promotion===o[u].promotion)){s=o[u];break}}if(!s)throw typeof t=="string"?new Error(`Invalid move: ${t}`):new Error(`Invalid move: ${JSON.stringify(t)}`);if(this.isCheck()&&s.flags&w.NULL_MOVE)throw new Error("Null move not allowed when in check");const i=new Ee(this,s);return this._makeMove(s),this._incPositionCount(),i}_push(t){this._history.push({move:t,kings:{b:this._kings.b,w:this._kings.w},turn:this._turn,castling:{b:this._castling.b,w:this._castling.w},epSquare:this._epSquare,halfMoves:this._halfMoves,moveNumber:this._moveNumber})}_movePiece(t,e){this._hash^=this._pieceKey(t),this._board[e]=this._board[t],delete this._board[t],this._hash^=this._pieceKey(e)}_makeMove(t){const e=this._turn,s=pe(e);if(this._push(t),t.flags&w.NULL_MOVE){e===U&&this._moveNumber++,this._halfMoves++,this._turn=s,this._epSquare=K;return}if(this._hash^=this._epKey(),this._hash^=this._castlingKey(),t.captured&&(this._hash^=this._pieceKey(t.to)),this._movePiece(t.from,t.to),t.flags&w.EP_CAPTURE&&(this._turn===U?this._clear(t.to-16):this._clear(t.to+16)),t.promotion&&(this._clear(t.to),this._set(t.to,{type:t.promotion,color:e})),this._board[t.to].type===I){if(this._kings[e]=t.to,t.flags&w.KSIDE_CASTLE){const i=t.to-1,o=t.to+1;this._movePiece(o,i)}else if(t.flags&w.QSIDE_CASTLE){const i=t.to+1,o=t.to-2;this._movePiece(o,i)}this._castling[e]=0}if(this._castling[e]){for(let i=0,o=Z[e].length;i<o;i++)if(t.from===Z[e][i].square&&this._castling[e]&Z[e][i].flag){this._castling[e]^=Z[e][i].flag;break}}if(this._castling[s]){for(let i=0,o=Z[s].length;i<o;i++)if(t.to===Z[s][i].square&&this._castling[s]&Z[s][i].flag){this._castling[s]^=Z[s][i].flag;break}}if(this._hash^=this._castlingKey(),t.flags&w.BIG_PAWN){let i;e===U?i=t.to-16:i=t.to+16,!(t.to-1&136)&&this._board[t.to-1]?.type===T&&this._board[t.to-1]?.color===s||!(t.to+1&136)&&this._board[t.to+1]?.type===T&&this._board[t.to+1]?.color===s?(this._epSquare=i,this._hash^=this._epKey()):this._epSquare=K}else this._epSquare=K;t.piece===T?this._halfMoves=0:t.flags&(w.CAPTURE|w.EP_CAPTURE)?this._halfMoves=0:this._halfMoves++,e===U&&this._moveNumber++,this._turn=s,this._hash^=Oe}undo(){const t=this._hash,e=this._undoMove();if(e){const s=new Ee(this,e);return this._decPositionCount(t),s}return null}_undoMove(){const t=this._history.pop();if(t===void 0)return null;this._hash^=this._epKey(),this._hash^=this._castlingKey();const e=t.move;this._kings=t.kings,this._turn=t.turn,this._castling=t.castling,this._epSquare=t.epSquare,this._halfMoves=t.halfMoves,this._moveNumber=t.moveNumber,this._hash^=this._epKey(),this._hash^=this._castlingKey(),this._hash^=Oe;const s=this._turn,i=pe(s);if(e.flags&w.NULL_MOVE)return e;if(this._movePiece(e.to,e.from),e.piece&&(this._clear(e.from),this._set(e.from,{type:e.piece,color:s})),e.captured)if(e.flags&w.EP_CAPTURE){let o;s===U?o=e.to-16:o=e.to+16,this._set(o,{type:T,color:i})}else this._set(e.to,{type:e.captured,color:i});if(e.flags&(w.KSIDE_CASTLE|w.QSIDE_CASTLE)){let o,u;e.flags&w.KSIDE_CASTLE?(o=e.to+1,u=e.to-1):(o=e.to-2,u=e.to+1),this._movePiece(u,o)}return e}pgn({newline:t=`
`,maxWidth:e=0}={}){const s=[];let i=!1;for(const m in this._header)this._header[m]&&s.push(`[${m} "${this._header[m]}"]`+t),i=!0;i&&this._history.length&&s.push(t);const o=m=>{const v=this._comments[this.fen()];if(typeof v<"u"){const E=m.length>0?" ":"";m=`${m}${E}{${v}}`}return m},u=[];for(;this._history.length>0;)u.push(this._undoMove());const f=[];let d="";for(u.length===0&&f.push(o(""));u.length>0;){d=o(d);const m=u.pop();if(!m)break;if(!this._history.length&&m.color==="b"){const v=`${this._moveNumber}. ...`;d=d?`${d} ${v}`:v}else m.color==="w"&&(d.length&&f.push(d),d=this._moveNumber+".");d=d+" "+this._moveToSan(m,this._moves({legal:!0})),this._makeMove(m)}if(d.length&&f.push(o(d)),f.push(this._header.Result||"*"),e===0)return s.join("")+f.join(" ");const p=function(){return s.length>0&&s[s.length-1]===" "?(s.pop(),!0):!1},_=function(m,v){for(const E of v.split(" "))if(E){if(m+E.length>e){for(;p();)m--;s.push(t),m=0}s.push(E),m+=E.length,s.push(" "),m++}return p()&&m--,m};let k=0;for(let m=0;m<f.length;m++){if(k+f[m].length>e&&f[m].includes("{")){k=_(k,f[m]);continue}k+f[m].length>e&&m!==0?(s[s.length-1]===" "&&s.pop(),s.push(t),k=0):m!==0&&(s.push(" "),k++),s.push(f[m]),k+=f[m].length}return s.join("")}header(...t){for(let e=0;e<t.length;e+=2)typeof t[e]=="string"&&typeof t[e+1]=="string"&&(this._header[t[e]]=t[e+1]);return this._header}setHeader(t,e){return this._header[t]=e??Ue[t]??null,this.getHeaders()}removeHeader(t){return t in this._header?(this._header[t]=Ue[t]||null,!0):!1}getHeaders(){const t={};for(const[e,s]of Object.entries(this._header))s!==null&&(t[e]=s);return t}loadPgn(t,{strict:e=!1,newlineChar:s=`\r?
`}={}){s!==`\r?
`&&(t=t.replace(new RegExp(s,"g"),`
`));const i=xs(t);this.reset();const o=i.headers;let u="";for(const p in o)p.toLowerCase()==="fen"&&(u=o[p]),this.header(p,o[p]);if(!e)u&&this.load(u,{preserveHeaders:!0});else if(o.SetUp==="1"){if(!("FEN"in o))throw new Error("Invalid PGN: FEN tag must be supplied with SetUp tag");this.load(o.FEN,{preserveHeaders:!0})}let f=i.root;for(;f;){if(f.move){const p=this._moveFromSan(f.move,e);if(p==null)throw new Error(`Invalid move in PGN: ${f.move}`);this._makeMove(p),this._incPositionCount()}f.comment!==void 0&&(this._comments[this.fen()]=f.comment),f=f.variations[0]}const d=i.result;d&&Object.keys(this._header).length&&this._header.Result!==d&&this.setHeader("Result",d)}_moveToSan(t,e){let s="";if(t.flags&w.KSIDE_CASTLE)s="O-O";else if(t.flags&w.QSIDE_CASTLE)s="O-O-O";else{if(t.flags&w.NULL_MOVE)return qe;if(t.piece!==T){const i=Ls(t,e);s+=t.piece.toUpperCase()+i}t.flags&(w.CAPTURE|w.EP_CAPTURE)&&(t.piece===T&&(s+=L(t.from)[0]),s+="x"),s+=L(t.to),t.promotion&&(s+="="+t.promotion.toUpperCase())}return this._makeMove(t),this.isCheck()&&(this.isCheckmate()?s+="#":s+="+"),this._undoMove(),s}_moveFromSan(t,e=!1){let s=Fe(t);if(e||(s==="0-0"?s="O-O":s==="0-0-0"&&(s="O-O-O")),s==qe)return{color:this._turn,from:0,to:0,piece:"k",flags:w.NULL_MOVE};let i=at(s),o=this._moves({legal:!0,piece:i});for(let m=0,v=o.length;m<v;m++)if(s===Fe(this._moveToSan(o[m],o)))return o[m];if(e)return null;let u,f,d,p,_,k=!1;if(f=s.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/),f?(u=f[1],d=f[2],p=f[3],_=f[4],d.length==1&&(k=!0)):(f=s.match(/([pnbrqkPNBRQK])?([a-h]?[1-8]?)x?-?([a-h][1-8])([qrbnQRBN])?/),f&&(u=f[1],d=f[2],p=f[3],_=f[4],d.length==1&&(k=!0))),i=at(s),o=this._moves({legal:!0,piece:u||i}),!p)return null;for(let m=0,v=o.length;m<v;m++)if(d){if((!u||u.toLowerCase()==o[m].piece)&&N[d]==o[m].from&&N[p]==o[m].to&&(!_||_.toLowerCase()==o[m].promotion))return o[m];if(k){const E=L(o[m].from);if((!u||u.toLowerCase()==o[m].piece)&&N[p]==o[m].to&&(d==E[0]||d==E[1])&&(!_||_.toLowerCase()==o[m].promotion))return o[m]}}else if(s===Fe(this._moveToSan(o[m],o)).replace("x",""))return o[m];return null}ascii(){let t=`   +------------------------+
`;for(let e=N.a8;e<=N.h1;e++){if(me(e)===0&&(t+=" "+"87654321"[ie(e)]+" |"),this._board[e]){const s=this._board[e].type,o=this._board[e].color===F?s.toUpperCase():s.toLowerCase();t+=" "+o+" "}else t+=" . ";e+1&136&&(t+=`|
`,e+=8)}return t+=`   +------------------------+
`,t+="     a  b  c  d  e  f  g  h",t}perft(t){const e=this._moves({legal:!1});let s=0;const i=this._turn;for(let o=0,u=e.length;o<u;o++)this._makeMove(e[o]),this._isKingAttacked(i)||(t-1>0?s+=this.perft(t-1):s++),this._undoMove();return s}setTurn(t){return this._turn==t?!1:(this.move("--"),!0)}turn(){return this._turn}board(){const t=[];let e=[];for(let s=N.a8;s<=N.h1;s++)this._board[s]==null?e.push(null):e.push({square:L(s),type:this._board[s].type,color:this._board[s].color}),s+1&136&&(t.push(e),e=[],s+=8);return t}squareColor(t){if(t in N){const e=N[t];return(ie(e)+me(e))%2===0?"light":"dark"}return null}history({verbose:t=!1}={}){const e=[],s=[];for(;this._history.length>0;)e.push(this._undoMove());for(;;){const i=e.pop();if(!i)break;t?s.push(new Ee(this,i)):s.push(this._moveToSan(i,this._moves())),this._makeMove(i)}return s}_getPositionCount(t){return this._positionCount.get(t)??0}_incPositionCount(){this._positionCount.set(this._hash,(this._positionCount.get(this._hash)??0)+1)}_decPositionCount(t){const e=this._positionCount.get(t)??0;e===1?this._positionCount.delete(t):this._positionCount.set(t,e-1)}_pruneComments(){const t=[],e={},s=i=>{i in this._comments&&(e[i]=this._comments[i])};for(;this._history.length>0;)t.push(this._undoMove());for(s(this.fen());;){const i=t.pop();if(!i)break;this._makeMove(i),s(this.fen())}this._comments=e}getComment(){return this._comments[this.fen()]}setComment(t){this._comments[this.fen()]=t.replace("{","[").replace("}","]")}deleteComment(){return this.removeComment()}removeComment(){const t=this._comments[this.fen()];return delete this._comments[this.fen()],t}getComments(){return this._pruneComments(),Object.keys(this._comments).map(t=>({fen:t,comment:this._comments[t]}))}deleteComments(){return this.removeComments()}removeComments(){return this._pruneComments(),Object.keys(this._comments).map(t=>{const e=this._comments[t];return delete this._comments[t],{fen:t,comment:e}})}setCastlingRights(t,e){for(const i of[I,X])e[i]!==void 0&&(e[i]?this._castling[t]|=ye[i]:this._castling[t]&=~ye[i]);this._updateCastlingRights();const s=this.getCastlingRights(t);return(e[I]===void 0||e[I]===s[I])&&(e[X]===void 0||e[X]===s[X])}getCastlingRights(t){return{[I]:(this._castling[t]&ye[I])!==0,[X]:(this._castling[t]&ye[X])!==0}}moveNumber(){return this._moveNumber}}class qs{constructor(){const t="/ATG-Test/",s=`${t.endsWith("/")?t:`${t}/`}stockfish/stockfish.js`;console.log("Initializing Stockfish Worker from:",s);try{this.worker=new Worker(s),this.worker.onerror=i=>{console.error("Stockfish Worker Error:",i.message,i)}}catch(i){console.error("Failed to create Stockfish Worker:",i),this.worker={postMessage:()=>{},onmessage:null,terminate:()=>{}}}this.isReady=!1,this.worker.onmessage=i=>{i.data==="uciok"&&(this.isReady=!0,console.log("Stockfish Engine Ready"))},this.worker.postMessage("uci")}onMessage(t){this.worker.onmessage=e=>{e.data==="uciok"&&(this.isReady=!0,console.log("Stockfish Engine Ready (from hook)")),t(e.data)}}evaluatePosition(t,e=800){console.log(`Sending to Stockfish: position fen ${t}`),console.log(`Sending to Stockfish: go movetime ${e}`),this.worker.postMessage("ucinewgame"),this.worker.postMessage(`position fen ${t}`),this.worker.postMessage(`go movetime ${e}`)}stop(){this.worker.postMessage("stop")}quit(){this.worker.postMessage("quit"),this.worker.terminate()}}function Fs({moves:n=[]}){const t=$.useRef(null);$.useEffect(()=>{t.current&&(t.current.scrollTop=t.current.scrollHeight)},[n]);const e=[],s=Array.isArray(n)?n:[];for(let i=0;i<s.length;i+=2)e.push({number:Math.floor(i/2)+1,white:s[i],black:s[i+1]||null});return a.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-xl overflow-hidden flex flex-col h-64 md:h-96",children:[a.jsx("div",{className:"bg-brand-navy/50 p-3 border-b border-white/10",children:a.jsx("h3",{className:"text-white font-display font-bold text-sm uppercase tracking-wider",children:"Move History"})}),a.jsxs("div",{ref:t,className:"flex-1 overflow-y-auto p-2 scrollbar-thin scrollbar-thumb-white/20 scrollbar-track-transparent",children:[a.jsxs("table",{className:"w-full text-sm text-slate-300",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"text-xs text-slate-500 uppercase text-left",children:[a.jsx("th",{className:"py-1 pl-2 w-10",children:"#"}),a.jsx("th",{className:"py-1",children:"White"}),a.jsx("th",{className:"py-1",children:"Black"})]})}),a.jsx("tbody",{children:e.map(i=>a.jsxs("tr",{className:"hover:bg-white/5 transition-colors border-b border-white/5 last:border-0",children:[a.jsxs("td",{className:"py-2 pl-2 font-mono text-slate-500",children:[i.number,"."]}),a.jsxs("td",{className:"py-2 font-medium text-white",children:[a.jsx("span",{className:"mr-2",children:i.white.san}),a.jsxs("span",{className:"text-xs text-slate-500",children:["(",i.white.from,"→",i.white.to,")"]})]}),a.jsx("td",{className:"py-2 font-medium text-slate-300",children:i.black?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"mr-2",children:i.black.san}),a.jsxs("span",{className:"text-xs text-slate-500",children:["(",i.black.from,"→",i.black.to,")"]})]}):""})]},i.number))})]}),n.length===0&&a.jsx("div",{className:"h-full flex items-center justify-center text-slate-500 text-sm italic",children:"No moves yet. Start the game!"})]})]})}function Ds({onCommand:n}){const[t,e]=$.useState(!1),[s,i]=$.useState(""),[o,u]=$.useState(!1);$.useEffect(()=>{!("webkitSpeechRecognition"in window)&&!("SpeechRecognition"in window)&&u(!0)},[]);const f=()=>{if(o)return;if(t){e(!1);return}const d=window.SpeechRecognition||window.webkitSpeechRecognition,p=new d;p.lang="en-US",p.interimResults=!1,p.maxAlternatives=1,p.onstart=()=>{e(!0),i("Listening...")},p.onresult=_=>{const k=_.results.length-1,m=_.results[k][0].transcript;i(`Recognized: "${m}"`),n&&n(m)},p.onerror=_=>{i(`Error: ${_.error}`),e(!1)},p.onend=()=>{e(!1)},p.start()};return o?a.jsx("div",{className:"mt-4 text-xs text-red-400",children:"Voice control not supported in this browser."}):a.jsxs("div",{className:"mt-4 flex flex-col items-center gap-2",children:[a.jsxs("button",{onClick:f,className:`flex items-center gap-2 px-6 py-3 rounded-full transition-all shadow-lg ${t?"bg-red-500 hover:bg-red-600 text-white animate-pulse":"bg-brand-orange hover:bg-orange-600 text-white"}`,children:[a.jsx("span",{className:"material-symbols-outlined",children:t?"mic":"mic_none"}),a.jsx("span",{className:"font-medium",children:t?"Stop Listening":"Voice Command"})]}),s&&a.jsx("div",{className:"text-white/80 text-sm font-light italic",children:s})]})}const Ce="ATG_CHESS_APP_SECRET_SALT_2026",Us={encrypt:n=>{if(!n)return"";let t="";for(let e=0;e<n.length;e++)t+=String.fromCharCode(n.charCodeAt(e)^Ce.charCodeAt(e%Ce.length));return btoa(t)},decrypt:n=>{if(!n)return"";try{const t=atob(n);let e="";for(let s=0;s<t.length;s++)e+=String.fromCharCode(t.charCodeAt(s)^Ce.charCodeAt(s%Ce.length));return e}catch(t){return console.error("Failed to decrypt key",t),""}}},Bs={GEMINI_API_KEY_ENC:"Pz4zOj0+Pj4="},Gs={getMoveFromNaturalLanguage:async(n,t)=>{try{const e=Us.decrypt(Bs.GEMINI_API_KEY_ENC);if(!e||e==="DUMMY_KEY"||e.includes("Pz4zOj0+Pj4="))return console.warn("Gemini API Key is missing or invalid. Voice commands needing AI interpretation will fail safely."),null;const s=`
            You are a chess engine helper. 
            Current board FEN: ${t}
            User command: "${n}"
            
            Interpret the command and return the move in UCI format (e.g., "e2e4" or "g1f3" or "a7a8q" for promotion).
            If the command is ambiguous or invalid, return "INVALID".
            Only return the move string, nothing else.
            `,u=(await(await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:s}]}]})})).json()).candidates?.[0]?.content?.parts?.[0]?.text?.trim();return!u||u==="INVALID"?null:u.length>=4?{from:u.substring(0,2),to:u.substring(2,4),promotion:u.length>4?u[4]:"q"}:null}catch(e){return console.error("Error calling Gemini API:",e),null}}},Qs={w:{p:"https://upload.wikimedia.org/wikipedia/commons/4/45/Chess_plt45.svg",r:"https://upload.wikimedia.org/wikipedia/commons/7/72/Chess_rlt45.svg",n:"https://upload.wikimedia.org/wikipedia/commons/7/70/Chess_nlt45.svg",b:"https://upload.wikimedia.org/wikipedia/commons/b/b1/Chess_blt45.svg",q:"https://upload.wikimedia.org/wikipedia/commons/1/15/Chess_qlt45.svg",k:"https://upload.wikimedia.org/wikipedia/commons/4/42/Chess_klt45.svg"},b:{p:"https://upload.wikimedia.org/wikipedia/commons/c/c7/Chess_pdt45.svg",r:"https://upload.wikimedia.org/wikipedia/commons/f/ff/Chess_rdt45.svg",n:"https://upload.wikimedia.org/wikipedia/commons/e/ef/Chess_ndt45.svg",b:"https://upload.wikimedia.org/wikipedia/commons/9/98/Chess_bdt45.svg",q:"https://upload.wikimedia.org/wikipedia/commons/4/47/Chess_qdt45.svg",k:"https://upload.wikimedia.org/wikipedia/commons/f/f0/Chess_kdt45.svg"}};function Ws(){const{user:n}=ns(),e=$.useRef(new Ks).current,[s,i]=$.useState(e.fen()),[o,u]=$.useState([]),[f,d]=$.useState("white"),[p,_]=$.useState("Initializing AI..."),[k,m]=$.useState(!1),[v,E]=$.useState(!1),[j,q]=$.useState(null),[re,G]=$.useState({});async function Pe(){if(!n)return;let y="Draw";if(e.isCheckmate()){const C=e.turn()==="w"?"Black":"White";y=C==="White"&&f==="white"?"Win":"Loss",C!==(e.turn()==="w"?"Black":"White")&&(y="Loss")}try{await as(ls(cs,`users/${n.uid}/games`),{pgn:e.pgn(),fen:e.fen(),date:hs(),result:y,opponent:"Stockfish AI"}),console.log("Game saved!")}catch(C){console.error("Error saving game:",C)}}function Y(y){try{console.log("Attempting move:",y);const C=e.move(y);if(C)return console.log("Move valid:",C),i(e.fen()),u(e.history({verbose:!0})),C;console.warn("Move rejected by chess.js")}catch(C){return console.warn("Exception in safeMakeMove:",C),null}return null}const le=$.useRef(Y);$.useEffect(()=>{le.current=Y});const z=os.useRef(null);$.useEffect(()=>{const y=new qs;return z.current=y,y.onMessage(C=>{if(C.startsWith("bestmove")){const P=C.split(" ")[1];P&&(le.current({from:P.substring(0,2),to:P.substring(2,4),promotion:P.length>4?P[4]:"q"}),m(!1),_("Your Turn"))}}),_("AI Ready"),()=>{y.quit(),z.current=null}},[]),$.useEffect(()=>{e.isGameOver()&&!v&&(E(!0),_("Game Over"),Pe())},[s,v]);function Te(y){if(console.log("Clicked:",y),e.turn()!==f[0]||k||v)return;if(j===y){q(null),G({});return}if(j){const P=e.get(j),R=P&&P.type==="p"&&(P.color==="w"&&y[1]==="8"||P.color==="b"&&y[1]==="1"),V={from:j,to:y};if(R&&(V.promotion="q"),Y(V)){q(null),G({}),H();return}}const C=e.get(y);if(C&&C.color===f[0]){q(y);const P=e.moves({square:y,verbose:!0}),M={};P.forEach(R=>{M[R.to]={isOption:!0}}),M[y]={isSelected:!0},G(M)}else{G({});return}}$.useEffect(()=>{!e.isGameOver()&&(e.turn()==="w"&&f==="black"||e.turn()==="b"&&f==="white")&&H()},[s,f]);function H(){z.current&&(e.isGameOver()||(m(!0),_("AI Thinking..."),setTimeout(()=>{z.current&&z.current.evaluatePosition(e.fen(),800)},500)))}async function _e(y){if(v)return;const C=y.toLowerCase().replace(/to/g,"").replace(/ /g,"");if(C.match(/^[a-h][1-8][a-h][1-8]$/)){const R={from:C.substring(0,2),to:C.substring(2,4),promotion:"q"};if(Y(R)){H();return}}_("Processing Speech...");const M=await Gs.getMoveFromNaturalLanguage(y,e.fen());M?Y(M)?H():_("Invalid Move Interpretation"):_("Could not understand command")}const ee=["a","b","c","d","e","f","g","h"],ce=["8","7","6","5","4","3","2","1"],he=f==="white"?ce:[...ce].reverse(),ve=f==="white"?ee:[...ee].reverse(),be=(y,C,P)=>{const M=`${C}${y}`,R=e.get(M),V=re[M]?.isSelected,Se=re[M]?.isOption;let ne=P?"bg-[#ebecd0]":"bg-[#779556]",fe=null;return V?ne="bg-[rgba(255,255,0,0.5)]":Se&&(fe=a.jsx("div",{className:"absolute w-3 h-3 bg-[rgba(0,0,0,0.2)] rounded-full"}),R&&(fe=a.jsx("div",{className:"absolute w-full h-full border-4 border-[rgba(0,0,0,0.2)] rounded-full"}))),a.jsxs("div",{onClick:()=>Te(M),className:`w-full h-full flex items-center justify-center relative cursor-pointer ${ne}`,"data-square":M,children:[C===ve[0]&&a.jsx("span",{className:`absolute top-0 left-1 text-[10px] font-bold ${P?"text-[#779556]":"text-[#ebecd0]"}`,children:y}),y===he[7]&&a.jsx("span",{className:`absolute bottom-0 right-1 text-[10px] font-bold ${P?"text-[#779556]":"text-[#ebecd0]"}`,children:C}),R&&a.jsx("img",{src:Qs[R.color][R.type],alt:`${R.color}${R.type}`,className:"w-[85%] h-[85%] select-none pointer-events-none"}),fe]},M)},xe=()=>{const y=[];for(let C=0;C<8;C++)for(let P=0;P<8;P++){const M=he[C],R=ve[P],V=(C+P)%2===0;y.push(be(M,R,V))}return y};return a.jsxs("div",{className:"flex flex-col h-full bg-slate-900 text-white p-4 overflow-y-auto",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold bg-gradient-to-r from-blue-400 to-purple-500 bg-clip-text text-transparent",children:"Grandmaster Chess"}),a.jsxs("p",{className:"text-slate-400 text-sm",children:["Powered by Stockfish 16 • ",p]})]}),a.jsx("div",{className:"flex items-center gap-4",children:a.jsx("div",{className:`px-3 py-1 rounded-full text-xs font-bold ${p==="Your Turn"?"bg-green-500/20 text-green-400":p.includes("Thinking")?"bg-blue-500/20 text-blue-400 animate-pulse":"bg-slate-700 text-slate-400"}`,children:p})})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6 max-w-7xl mx-auto w-full",children:[a.jsx("div",{className:"lg:col-span-8 flex justify-center",children:a.jsxs("div",{className:"relative aspect-square w-full max-w-[600px] shadow-2xl rounded-lg overflow-hidden border-4 border-slate-700",children:[a.jsx("div",{className:"grid grid-cols-8 grid-rows-8 w-full h-full",children:xe()}),v&&a.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-slate-800 p-8 rounded-2xl border border-slate-600 shadow-xl text-center",children:[a.jsx("h2",{className:"text-3xl font-bold mb-2",children:"Game Over"}),a.jsx("p",{className:"text-xl mb-6 text-slate-300",children:e.isCheckmate()?"Checkmate!":"Draw"}),a.jsx("button",{onClick:()=>{e.reset(),i(e.fen()),u([]),E(!1),q(null),G({}),d("white"),_("AI Ready")},className:"bg-blue-600 hover:bg-blue-500 text-white px-6 py-2 rounded-lg font-bold transition-all",children:"Play Again"})]})})]})}),a.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[a.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 border border-slate-700 h-[300px] flex flex-col",children:[a.jsx("h3",{className:"text-sm font-bold text-slate-400 mb-3 uppercase tracking-wider",children:"Move History"}),a.jsx(Fs,{moves:o})]}),a.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 border border-slate-700 grid grid-cols-2 gap-3",children:[a.jsx("button",{className:"bg-slate-700 hover:bg-slate-600 py-2 rounded text-sm transition-colors",onClick:()=>{e.reset(),i(e.fen()),u([]),E(!1),q(null),G({}),_("AI Ready")},children:"New Game"}),a.jsx("button",{className:"bg-slate-700 hover:bg-slate-600 py-2 rounded text-sm transition-colors",onClick:()=>{d(f==="white"?"black":"white"),q(null),G({}),e.fen()==="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1"&&f==="white"&&H()},children:"Switch Sides"})]}),a.jsx("div",{className:"opacity-100",children:a.jsx(Ds,{onCommand:_e,isListening:!v})})]})]}),a.jsx("div",{className:"hidden"})]})}class Hs extends $.Component{constructor(t){super(t),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,e){console.error("ErrorBoundary caught an error",t,e),this.setState({error:t,errorInfo:e})}render(){return this.state.hasError?a.jsxs("div",{className:"p-6 bg-red-50 border border-red-200 rounded-lg text-center",children:[a.jsx("h2",{className:"text-xl font-bold text-red-700 mb-2",children:"Something went wrong."}),a.jsx("p",{className:"text-red-600 mb-4",children:"We couldn't load this game."}),a.jsxs("details",{className:"text-left bg-white p-4 rounded border border-red-100 text-xs text-red-500 overflow-auto max-h-40",children:[this.state.error&&this.state.error.toString(),a.jsx("br",{}),this.state.errorInfo&&this.state.errorInfo.componentStack]}),a.jsx("button",{className:"mt-4 px-4 py-2 bg-red-100 hover:bg-red-200 text-red-700 rounded transition-colors",onClick:()=>window.location.reload(),children:"Reload Page"})]}):this.props.children}}const lt=[{id:"chess",title:"Grandmaster AI",icon:"smart_toy",component:Ws},{id:"premier",title:"Retail Premier League",icon:"workspace_premium",component:ct},{id:"ramadan",title:"Kindness Quest",icon:"volunteer_activism",component:us},{id:"green",title:"Sustainability",icon:"eco",component:ps}];function Ys(){const[n,t]=$.useState("chess"),e=lt.find(s=>s.id===n)?.component||ct;return a.jsxs("div",{className:"games-page-container fade-in",children:[a.jsx("div",{className:"games-header",children:a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl md:text-4xl font-display font-medium text-brand-navy mb-1 md:mb-2",children:"Gamified Insights"}),a.jsx("p",{className:"text-slate-500 text-sm md:text-lg font-light",children:"Information made fun and interactive."})]})}),a.jsxs("div",{className:"games-layout",children:[a.jsx("div",{className:"games-sidebar",children:lt.map(s=>a.jsxs("button",{className:`game-nav-item ${n===s.id?"active":""}`,onClick:()=>t(s.id),children:[a.jsx("span",{className:"material-symbols-outlined",children:s.icon}),a.jsx("span",{className:"game-nav-label",children:s.title})]},s.id))}),a.jsx("div",{className:"game-display-area",children:a.jsx(Hs,{children:a.jsx(e,{})},n)})]})]})}export{Ys as default};
