import{b as as,r as d,j as l,R as J,a as dr,q as ls,l as cs,o as us,c as fr,d as hr,e as ds,f as fs,s as hs}from"./index-DX2uhJuB.js";var Lt=as();const Et=[{label:"Sales Growth %",color:"#FF6B6B",value:"+12.5%"},{label:"Conversion Rate",color:"#4ECDC4",value:"4.2%"},{label:"Mystery Audit",color:"#45B7D1",value:"92/100"},{label:"NPS Score",color:"#96CEB4",value:"78"},{label:"VM Compliance",color:"#FFEEAD",value:"98%"},{label:"Inventory Turn",color:"#D4A5A5",value:"6.5x"}];function gr(){const[n,e]=d.useState(!1),[t,r]=d.useState(0),[s,i]=d.useState(null),a=()=>{if(n)return;e(!0),i(null);const o=Math.floor(Math.random()*360)+1440,c=t+o;r(c),setTimeout(()=>{e(!1);const u=c%360,f=Math.floor((360-u)/(360/Et.length))%Et.length;i(Et[f])},4e3)};return l.jsxs("div",{className:"wheel-container",children:[l.jsx("h2",{className:"game-title",children:"Retail Premier League"}),l.jsxs("div",{className:"wheel-wrapper",children:[l.jsx("div",{className:"wheel-pointer"}),l.jsx("div",{className:`wheel ${n?"spinning":""}`,style:{transform:`rotate(${t}deg)`},children:Et.map((o,c)=>l.jsx("div",{className:"wheel-segment",style:{"--i":c,"--clr":o.color,"--total":Et.length},children:l.jsx("span",{className:"segment-text",children:o.label})},c))}),l.jsx("button",{className:"spin-button",onClick:a,disabled:n,children:n?"...":"SPIN"})]}),s&&l.jsxs("div",{className:"result-popup fade-in",children:[l.jsx("h3",{children:s.label}),l.jsx("div",{className:"result-value",children:s.value}),l.jsx("p",{children:"Top Performance this month!"})]})]})}const gs=[{label:"Donations Collected",value:"$12,450",icon:"volunteer_activism"},{label:"Trees Planted",value:"450",icon:"park"},{label:"Meals Distributed",value:"1,200",icon:"restaurant"},{label:"Volunteer Hours",value:"320",icon:"schedule"},{label:"Water Bottles Recycled",value:"5,000",icon:"recycling"},{label:"Kindness Notes Shared",value:"850",icon:"favorite"}];function ps(){const[n,e]=d.useState(!1),[t,r]=d.useState(1),[s,i]=d.useState(null),a=()=>{if(n)return;e(!0),i(null);const o=Math.floor(Math.random()*6)+1;setTimeout(()=>{r(o),e(!1),i(gs[o-1])},1500)};return l.jsxs("div",{className:"dice-container",children:[l.jsx("h2",{className:"game-title",children:"Ramadan Kindness Quest"}),l.jsx("div",{className:"dice-scene",children:l.jsxs("div",{className:`dice ${n?"rolling":""}`,"data-side":t,children:[l.jsx("div",{className:"side one",children:l.jsx("div",{className:"dot"})}),l.jsxs("div",{className:"side two",children:[l.jsx("div",{className:"dot"}),l.jsx("div",{className:"dot"})]}),l.jsxs("div",{className:"side three",children:[l.jsx("div",{className:"dot"}),l.jsx("div",{className:"dot"}),l.jsx("div",{className:"dot"})]}),l.jsxs("div",{className:"side four",children:[l.jsx("div",{className:"dot"}),l.jsx("div",{className:"dot"}),l.jsx("div",{className:"dot"}),l.jsx("div",{className:"dot"})]}),l.jsxs("div",{className:"side five",children:[l.jsx("div",{className:"dot"}),l.jsx("div",{className:"dot"}),l.jsx("div",{className:"dot"}),l.jsx("div",{className:"dot"}),l.jsx("div",{className:"dot"})]}),l.jsxs("div",{className:"side six",children:[l.jsx("div",{className:"dot"}),l.jsx("div",{className:"dot"}),l.jsx("div",{className:"dot"}),l.jsx("div",{className:"dot"}),l.jsx("div",{className:"dot"}),l.jsx("div",{className:"dot"})]})]})}),l.jsx("button",{className:"roll-button",onClick:a,disabled:n,children:n?"ROLLING...":"ROLL DICE"}),s&&l.jsxs("div",{className:"quest-result fade-in",children:[l.jsx("span",{className:"material-symbols-outlined quest-icon",children:s.icon}),l.jsx("h3",{children:s.label}),l.jsx("div",{className:"quest-value",children:s.value}),l.jsx("p",{children:"Subhan Allah! Keep it up!"})]})]})}const ms=[{title:"Paper Wastage",value:"15%",goal:"5%",icon:"description",color:"#ff6b6b",desc:"Lower is better"},{title:"Energy Consumed",value:"420 kWh",goal:"350 kWh",icon:"bolt",color:"#ffd700",desc:"Monthly store average"},{title:"Recycling Rate",value:"68%",goal:"85%",icon:"recycling",color:"#4ecdc4",desc:"Targeting zero waste"}];function vs(){return l.jsxs("div",{className:"sustainability-container",children:[l.jsx("h2",{className:"game-title",children:"Sustainability Mission"}),l.jsx("div",{className:"metrics-grid",children:ms.map((n,e)=>l.jsxs("div",{className:"metric-card",style:{"--accent":n.color},children:[l.jsxs("div",{className:"metric-header",children:[l.jsx("span",{className:"material-symbols-outlined metric-icon",children:n.icon}),l.jsx("h3",{children:n.title})]}),l.jsxs("div",{className:"metric-body",children:[l.jsxs("div",{className:"value-display",children:[l.jsx("span",{className:"current-value",children:n.value}),l.jsxs("span",{className:"goal-label",children:["Goal: ",n.goal]})]}),l.jsx("div",{className:"progress-bar-bg",children:l.jsx("div",{className:"progress-bar-fill",style:{width:e===0?"75%":e===1?"85%":"68%"}})}),l.jsx("p",{className:"metric-desc",children:n.desc})]})]},e))}),l.jsxs("div",{className:"mission-footer",children:[l.jsx("p",{children:"Every small step counts towards a greener future."}),l.jsx("button",{className:"pledge-button",children:"Take the Pledge"})]})]})}function bs(n){return n!==null?{comment:n,variations:[]}:{variations:[]}}function ys(n,e,t,r,s){const i={move:n,variations:s};return e&&(i.suffix=e),t&&(i.nag=t),r!==null&&(i.comment=r),i}function xs(...n){const[e,...t]=n;let r=e;for(const s of t)s!==null&&(r.variations=[s,...s.variations],s.variations=[],r=s);return e}function ws(n,e){if(e.marker&&e.marker.comment){let t=e.root;for(;;){const r=t.variations[0];if(!r){t.comment=e.marker.comment;break}t=r}}return{headers:n,root:e.root,result:(e.marker&&e.marker.result)??void 0}}function Ss(n,e){function t(){this.constructor=n}t.prototype=e.prototype,n.prototype=new t}function bt(n,e,t,r){var s=Error.call(this,n);return Object.setPrototypeOf&&Object.setPrototypeOf(s,bt.prototype),s.expected=e,s.found=t,s.location=r,s.name="SyntaxError",s}Ss(bt,Error);function ln(n,e,t){return t=t||" ",n.length>e?n:(e-=n.length,t+=t.repeat(e),n+t.slice(0,e))}bt.prototype.format=function(n){var e="Error: "+this.message;if(this.location){var t=null,r;for(r=0;r<n.length;r++)if(n[r].source===this.location.source){t=n[r].text.split(/\r\n|\n|\r/g);break}var s=this.location.start,i=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(s):s,a=this.location.source+":"+i.line+":"+i.column;if(t){var o=this.location.end,c=ln("",i.line.toString().length," "),u=t[s.line-1],f=s.line===o.line?o.column:u.length+1,m=f-s.column||1;e+=`
 --> `+a+`
`+c+` |
`+i.line+" | "+u+`
`+c+" | "+ln("",s.column-1," ")+ln("",m,"^")}else e+=`
 at `+a}return e};bt.buildMessage=function(n,e){var t={literal:function(u){return'"'+s(u.text)+'"'},class:function(u){var f=u.parts.map(function(m){return Array.isArray(m)?i(m[0])+"-"+i(m[1]):i(m)});return"["+(u.inverted?"^":"")+f.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(u){return u.description}};function r(u){return u.charCodeAt(0).toString(16).toUpperCase()}function s(u){return u.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(f){return"\\x0"+r(f)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(f){return"\\x"+r(f)})}function i(u){return u.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(f){return"\\x0"+r(f)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(f){return"\\x"+r(f)})}function a(u){return t[u.type](u)}function o(u){var f=u.map(a),m,g;if(f.sort(),f.length>0){for(m=1,g=1;m<f.length;m++)f[m-1]!==f[m]&&(f[g]=f[m],g++);f.length=g}switch(f.length){case 1:return f[0];case 2:return f[0]+" or "+f[1];default:return f.slice(0,-1).join(", ")+", or "+f[f.length-1]}}function c(u){return u?'"'+s(u)+'"':"end of input"}return"Expected "+o(n)+" but "+c(e)+" found."};function Cs(n,e){e=e!==void 0?e:{};var t={},r=e.grammarSource,s={pgn:In},i=In,a="[",o='"',c="]",u=".",f="O-O-O",m="O-O",g="0-0-0",v="0-0",S="$",x="{",C="}",N=";",M="(",R=")",O="1-0",k="0-1",_="1/2-1/2",A="*",E=/^[a-zA-Z]/,q=/^[^"]/,K=/^[0-9]/,P=/^[.]/,V=/^[a-zA-Z1-8\-=]/,U=/^[+#]/,le=/^[!?]/,Ce=/^[^}]/,ze=/^[^\r\n]/,se=/^[ \t\r\n]/,et=ge("tag pair"),Ee=Y("[",!1),Te=Y('"',!1),We=Y("]",!1),ce=ge("tag name"),I=te([["a","z"],["A","Z"]],!1,!1),tt=ge("tag value"),ct=te(['"'],!0,!1),me=ge("move number"),Ye=te([["0","9"]],!1,!1),ue=Y(".",!1),Ue=te(["."],!1,!1),X=ge("standard algebraic notation"),_e=Y("O-O-O",!1),$e=Y("O-O",!1),Oe=Y("0-0-0",!1),de=Y("0-0",!1),Ae=te([["a","z"],["A","Z"],["1","8"],"-","="],!1,!1),fe=te(["+","#"],!1,!1),Qe=ge("suffix annotation"),nt=te(["!","?"],!1,!1),Pe=ge("NAG"),he=Y("$",!1),Ve=ge("brace comment"),rt=Y("{",!1),qe=te(["}"],!0,!1),Ge=Y("}",!1),St=ge("rest of line comment"),Ct=Y(";",!1),Ie=te(["\r",`
`],!0,!1),Ke=ge("variation"),Xe=Y("(",!1),pt=Y(")",!1),De=ge("game termination marker"),mt=Y("1-0",!1),_t=Y("0-1",!1),kt=Y("1/2-1/2",!1),B=Y("*",!1),W=ge("whitespace"),G=te([" ","	","\r",`
`],!1,!1),st=function(h,b){return ws(h,b)},Ne=function(h){return Object.fromEntries(h)},Le=function(h,b){return[h,b]},Je=function(h,b){return{root:h,marker:b}},Q=function(h,b){return xs(bs(h),...b.flat())},ve=function(h,b,y,j,D){return ys(h,b,y,j,D)},be=function(h){return h},He=function(h){return h.replace(/[\r\n]+/g," ")},ke=function(h){return h.trim()},ye=function(h){return h},Me=function(h,b){return{result:h,comment:b}},p=e.peg$currPos|0,H=[{line:1,column:1}],Z=p,xe=e.peg$maxFailExpected||[],w=e.peg$silentFails|0,Be;if(e.startRule){if(!(e.startRule in s))throw new Error(`Can't start parsing from rule "`+e.startRule+'".');i=s[e.startRule]}function Y(h,b){return{type:"literal",text:h,ignoreCase:b}}function te(h,b,y){return{type:"class",parts:h,inverted:b,ignoreCase:y}}function ut(){return{type:"end"}}function ge(h){return{type:"other",description:h}}function Pn(h){var b=H[h],y;if(b)return b;if(h>=H.length)y=H.length-1;else for(y=h;!H[--y];);for(b=H[y],b={line:b.line,column:b.column};y<h;)n.charCodeAt(y)===10?(b.line++,b.column=1):b.column++,y++;return H[h]=b,b}function qn(h,b,y){var j=Pn(h),D=Pn(b),F={source:r,start:{offset:h,line:j.line,column:j.column},end:{offset:b,line:D.line,column:D.column}};return F}function L(h){p<Z||(p>Z&&(Z=p,xe=[]),xe.push(h))}function Vr(h,b,y){return new bt(bt.buildMessage(h,b),h,b,y)}function In(){var h,b,y;return h=p,b=Xr(),y=es(),h=st(b,y),h}function Xr(){var h,b,y;for(h=p,b=[],y=Kn();y!==t;)b.push(y),y=Kn();return y=we(),h=Ne(b),h}function Kn(){var h,b,y,j,D,F,dt;return w++,h=p,we(),n.charCodeAt(p)===91?(b=a,p++):(b=t,w===0&&L(Ee)),b!==t?(we(),y=Jr(),y!==t?(we(),n.charCodeAt(p)===34?(j=o,p++):(j=t,w===0&&L(Te)),j!==t?(D=Zr(),n.charCodeAt(p)===34?(F=o,p++):(F=t,w===0&&L(Te)),F!==t?(we(),n.charCodeAt(p)===93?(dt=c,p++):(dt=t,w===0&&L(We)),dt!==t?h=Le(y,D):(p=h,h=t)):(p=h,h=t)):(p=h,h=t)):(p=h,h=t)):(p=h,h=t),w--,h===t&&w===0&&L(et),h}function Jr(){var h,b,y;if(w++,h=p,b=[],y=n.charAt(p),E.test(y)?p++:(y=t,w===0&&L(I)),y!==t)for(;y!==t;)b.push(y),y=n.charAt(p),E.test(y)?p++:(y=t,w===0&&L(I));else b=t;return b!==t?h=n.substring(h,p):h=b,w--,h===t&&(b=t,w===0&&L(ce)),h}function Zr(){var h,b,y;for(w++,h=p,b=[],y=n.charAt(p),q.test(y)?p++:(y=t,w===0&&L(ct));y!==t;)b.push(y),y=n.charAt(p),q.test(y)?p++:(y=t,w===0&&L(ct));return h=n.substring(h,p),w--,b=t,w===0&&L(tt),h}function es(){var h,b,y;return h=p,b=Bn(),we(),y=os(),y===t&&(y=null),we(),h=Je(b,y),h}function Bn(){var h,b,y,j;for(h=p,b=an(),b===t&&(b=null),y=[],j=Fn();j!==t;)y.push(j),j=Fn();return h=Q(b,y),h}function Fn(){var h,b,y,j,D,F,dt,Ft;if(h=p,we(),ts(),we(),b=ns(),b!==t){for(y=rs(),y===t&&(y=null),j=[],D=zn();D!==t;)j.push(D),D=zn();for(D=we(),F=an(),F===t&&(F=null),dt=[],Ft=Wn();Ft!==t;)dt.push(Ft),Ft=Wn();h=ve(b,y,j,F,dt)}else p=h,h=t;return h}function ts(){var h,b,y,j,D,F;for(w++,h=p,b=[],y=n.charAt(p),K.test(y)?p++:(y=t,w===0&&L(Ye));y!==t;)b.push(y),y=n.charAt(p),K.test(y)?p++:(y=t,w===0&&L(Ye));if(n.charCodeAt(p)===46?(y=u,p++):(y=t,w===0&&L(ue)),y!==t){for(j=we(),D=[],F=n.charAt(p),P.test(F)?p++:(F=t,w===0&&L(Ue));F!==t;)D.push(F),F=n.charAt(p),P.test(F)?p++:(F=t,w===0&&L(Ue));b=[b,y,j,D],h=b}else p=h,h=t;return w--,h===t&&(b=t,w===0&&L(me)),h}function ns(){var h,b,y,j,D,F;if(w++,h=p,b=p,n.substr(p,5)===f?(y=f,p+=5):(y=t,w===0&&L(_e)),y===t&&(n.substr(p,3)===m?(y=m,p+=3):(y=t,w===0&&L($e)),y===t&&(n.substr(p,5)===g?(y=g,p+=5):(y=t,w===0&&L(Oe)),y===t&&(n.substr(p,3)===v?(y=v,p+=3):(y=t,w===0&&L(de)),y===t))))if(y=p,j=n.charAt(p),E.test(j)?p++:(j=t,w===0&&L(I)),j!==t){if(D=[],F=n.charAt(p),V.test(F)?p++:(F=t,w===0&&L(Ae)),F!==t)for(;F!==t;)D.push(F),F=n.charAt(p),V.test(F)?p++:(F=t,w===0&&L(Ae));else D=t;D!==t?(j=[j,D],y=j):(p=y,y=t)}else p=y,y=t;return y!==t?(j=n.charAt(p),U.test(j)?p++:(j=t,w===0&&L(fe)),j===t&&(j=null),y=[y,j],b=y):(p=b,b=t),b!==t?h=n.substring(h,p):h=b,w--,h===t&&(b=t,w===0&&L(X)),h}function rs(){var h,b,y;for(w++,h=p,b=[],y=n.charAt(p),le.test(y)?p++:(y=t,w===0&&L(nt));y!==t;)b.push(y),b.length>=2?y=t:(y=n.charAt(p),le.test(y)?p++:(y=t,w===0&&L(nt)));return b.length<1?(p=h,h=t):h=b,w--,h===t&&(b=t,w===0&&L(Qe)),h}function zn(){var h,b,y,j,D;if(w++,h=p,we(),n.charCodeAt(p)===36?(b=S,p++):(b=t,w===0&&L(he)),b!==t){if(y=p,j=[],D=n.charAt(p),K.test(D)?p++:(D=t,w===0&&L(Ye)),D!==t)for(;D!==t;)j.push(D),D=n.charAt(p),K.test(D)?p++:(D=t,w===0&&L(Ye));else j=t;j!==t?y=n.substring(y,p):y=j,y!==t?h=be(y):(p=h,h=t)}else p=h,h=t;return w--,h===t&&w===0&&L(Pe),h}function an(){var h;return h=ss(),h===t&&(h=is()),h}function ss(){var h,b,y,j,D;if(w++,h=p,n.charCodeAt(p)===123?(b=x,p++):(b=t,w===0&&L(rt)),b!==t){for(y=p,j=[],D=n.charAt(p),Ce.test(D)?p++:(D=t,w===0&&L(qe));D!==t;)j.push(D),D=n.charAt(p),Ce.test(D)?p++:(D=t,w===0&&L(qe));y=n.substring(y,p),n.charCodeAt(p)===125?(j=C,p++):(j=t,w===0&&L(Ge)),j!==t?h=He(y):(p=h,h=t)}else p=h,h=t;return w--,h===t&&(b=t,w===0&&L(Ve)),h}function is(){var h,b,y,j,D;if(w++,h=p,n.charCodeAt(p)===59?(b=N,p++):(b=t,w===0&&L(Ct)),b!==t){for(y=p,j=[],D=n.charAt(p),ze.test(D)?p++:(D=t,w===0&&L(Ie));D!==t;)j.push(D),D=n.charAt(p),ze.test(D)?p++:(D=t,w===0&&L(Ie));y=n.substring(y,p),h=ke(y)}else p=h,h=t;return w--,h===t&&(b=t,w===0&&L(St)),h}function Wn(){var h,b,y,j;return w++,h=p,we(),n.charCodeAt(p)===40?(b=M,p++):(b=t,w===0&&L(Xe)),b!==t?(y=Bn(),y!==t?(we(),n.charCodeAt(p)===41?(j=R,p++):(j=t,w===0&&L(pt)),j!==t?h=ye(y):(p=h,h=t)):(p=h,h=t)):(p=h,h=t),w--,h===t&&w===0&&L(Ke),h}function os(){var h,b,y;return w++,h=p,n.substr(p,3)===O?(b=O,p+=3):(b=t,w===0&&L(mt)),b===t&&(n.substr(p,3)===k?(b=k,p+=3):(b=t,w===0&&L(_t)),b===t&&(n.substr(p,7)===_?(b=_,p+=7):(b=t,w===0&&L(kt)),b===t&&(n.charCodeAt(p)===42?(b=A,p++):(b=t,w===0&&L(B))))),b!==t?(we(),y=an(),y===t&&(y=null),h=Me(b,y)):(p=h,h=t),w--,h===t&&(b=t,w===0&&L(De)),h}function we(){var h,b;for(w++,h=[],b=n.charAt(p),se.test(b)?p++:(b=t,w===0&&L(G));b!==t;)h.push(b),b=n.charAt(p),se.test(b)?p++:(b=t,w===0&&L(G));return w--,b=t,w===0&&L(W),h}if(Be=i(),e.peg$library)return{peg$result:Be,peg$currPos:p,peg$FAILED:t,peg$maxFailExpected:xe,peg$maxFailPos:Z};if(Be!==t&&p===n.length)return Be;throw Be!==t&&p<n.length&&L(ut()),Vr(xe,Z<n.length?n.charAt(Z):null,Z<n.length?qn(Z,Z+1):qn(Z,Z))}const Gt=0xffffffffffffffffn;function cn(n,e){return(n<<e|n>>64n-e)&0xffffffffffffffffn}function Un(n,e){return n*e&Gt}function _s(n){return function(){let e=BigInt(n&Gt),t=BigInt(n>>64n&Gt);const r=Un(cn(Un(e,5n),7n),9n);return t^=e,e=(cn(e,24n)^t^t<<16n)&Gt,t=cn(t,37n),n=t<<64n|e,r}}const en=_s(0xa187eb39cdcaed8f31c4b365b102e01en),ks=Array.from({length:2},()=>Array.from({length:6},()=>Array.from({length:128},()=>en()))),Es=Array.from({length:8},()=>en()),Ns=Array.from({length:16},()=>en()),un=en(),pe="w",je="b",ee="p",wn="n",Ht="b",jt="r",at="q",ne="k",dn="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1";class zt{color;from;to;piece;captured;promotion;flags;san;lan;before;after;constructor(e,t){const{color:r,piece:s,from:i,to:a,flags:o,captured:c,promotion:u}=t,f=ie(i),m=ie(a);this.color=r,this.piece=s,this.from=f,this.to=m,this.san=e._moveToSan(t,e._moves({legal:!0})),this.lan=f+m,this.before=e.fen(),e._makeMove(t),this.after=e.fen(),e._undoMove(),this.flags="";for(const g in $)$[g]&o&&(this.flags+=ft[g]);c&&(this.captured=c),u&&(this.promotion=u,this.lan+=u)}isCapture(){return this.flags.indexOf(ft.CAPTURE)>-1}isPromotion(){return this.flags.indexOf(ft.PROMOTION)>-1}isEnPassant(){return this.flags.indexOf(ft.EP_CAPTURE)>-1}isKingsideCastle(){return this.flags.indexOf(ft.KSIDE_CASTLE)>-1}isQueensideCastle(){return this.flags.indexOf(ft.QSIDE_CASTLE)>-1}isBigPawn(){return this.flags.indexOf(ft.BIG_PAWN)>-1}}const ae=-1,ft={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q",NULL_MOVE:"-"},$={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64,NULL_MOVE:128},Sn={Event:"?",Site:"?",Date:"????.??.??",Round:"?",White:"?",Black:"?",Result:"*"},Ls={WhiteTitle:null,BlackTitle:null,WhiteElo:null,BlackElo:null,WhiteUSCF:null,BlackUSCF:null,WhiteNA:null,BlackNA:null,WhiteType:null,BlackType:null,EventDate:null,EventSponsor:null,Section:null,Stage:null,Board:null,Opening:null,Variation:null,SubVariation:null,ECO:null,NIC:null,Time:null,UTCTime:null,UTCDate:null,TimeControl:null,SetUp:null,FEN:null,Termination:null,Annotator:null,Mode:null,PlyCount:null},js={...Sn,...Ls},T={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},fn={b:[16,32,17,15],w:[-16,-32,-17,-15]},Gn={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},As=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],Ds=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],Ms={p:1,n:2,b:4,r:8,q:16,k:32},Rs="pnbrqkPNBRQK",Hn=[wn,Ht,jt,at],Ts=7,$s=6,Os=1,Ps=0,Wt={[ne]:$.KSIDE_CASTLE,[at]:$.QSIDE_CASTLE},it={w:[{square:T.a1,flag:$.QSIDE_CASTLE},{square:T.h1,flag:$.KSIDE_CASTLE}],b:[{square:T.a8,flag:$.QSIDE_CASTLE},{square:T.h8,flag:$.KSIDE_CASTLE}]},qs={b:Os,w:$s},hn="--";function gt(n){return n>>4}function Rt(n){return n&15}function pr(n){return"0123456789".indexOf(n)!==-1}function ie(n){const e=Rt(n),t=gt(n);return"abcdefgh".substring(e,e+1)+"87654321".substring(t,t+1)}function Nt(n){return n===pe?je:pe}function Is(n){const e=n.split(/\s+/);if(e.length!==6)return{ok:!1,error:"Invalid FEN: must contain six space-delimited fields"};const t=parseInt(e[5],10);if(isNaN(t)||t<=0)return{ok:!1,error:"Invalid FEN: move number must be a positive integer"};const r=parseInt(e[4],10);if(isNaN(r)||r<0)return{ok:!1,error:"Invalid FEN: half move counter number must be a non-negative integer"};if(!/^(-|[abcdefgh][36])$/.test(e[3]))return{ok:!1,error:"Invalid FEN: en-passant square is invalid"};if(/[^kKqQ-]/.test(e[2]))return{ok:!1,error:"Invalid FEN: castling availability is invalid"};if(!/^(w|b)$/.test(e[1]))return{ok:!1,error:"Invalid FEN: side-to-move is invalid"};const s=e[0].split("/");if(s.length!==8)return{ok:!1,error:"Invalid FEN: piece data does not contain 8 '/'-delimited rows"};for(let a=0;a<s.length;a++){let o=0,c=!1;for(let u=0;u<s[a].length;u++)if(pr(s[a][u])){if(c)return{ok:!1,error:"Invalid FEN: piece data is invalid (consecutive number)"};o+=parseInt(s[a][u],10),c=!0}else{if(!/^[prnbqkPRNBQK]$/.test(s[a][u]))return{ok:!1,error:"Invalid FEN: piece data is invalid (invalid piece)"};o+=1,c=!1}if(o!==8)return{ok:!1,error:"Invalid FEN: piece data is invalid (too many squares in rank)"}}if(e[3][1]=="3"&&e[1]=="w"||e[3][1]=="6"&&e[1]=="b")return{ok:!1,error:"Invalid FEN: illegal en-passant square"};const i=[{color:"white",regex:/K/g},{color:"black",regex:/k/g}];for(const{color:a,regex:o}of i){if(!o.test(e[0]))return{ok:!1,error:`Invalid FEN: missing ${a} king`};if((e[0].match(o)||[]).length>1)return{ok:!1,error:`Invalid FEN: too many ${a} kings`}}return Array.from(s[0]+s[7]).some(a=>a.toUpperCase()==="P")?{ok:!1,error:"Invalid FEN: some pawns are on the edge rows"}:{ok:!0}}function Ks(n,e){const t=n.from,r=n.to,s=n.piece;let i=0,a=0,o=0;for(let c=0,u=e.length;c<u;c++){const f=e[c].from,m=e[c].to,g=e[c].piece;s===g&&t!==f&&r===m&&(i++,gt(t)===gt(f)&&a++,Rt(t)===Rt(f)&&o++)}return i>0?a>0&&o>0?ie(t):o>0?ie(t).charAt(1):ie(t).charAt(0):""}function ot(n,e,t,r,s,i=void 0,a=$.NORMAL){const o=gt(r);if(s===ee&&(o===Ts||o===Ps))for(let c=0;c<Hn.length;c++){const u=Hn[c];n.push({color:e,from:t,to:r,piece:s,captured:i,promotion:u,flags:a|$.PROMOTION})}else n.push({color:e,from:t,to:r,piece:s,captured:i,flags:a})}function Yn(n){let e=n.charAt(0);return e>="a"&&e<="h"?n.match(/[a-h]\d.*[a-h]\d/)?void 0:ee:(e=e.toLowerCase(),e==="o"?ne:e)}function gn(n){return n.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}class pn{_board=new Array(128);_turn=pe;_header={};_kings={w:ae,b:ae};_epSquare=-1;_halfMoves=0;_moveNumber=0;_history=[];_comments={};_castling={w:0,b:0};_hash=0n;_positionCount=new Map;constructor(e=dn,{skipValidation:t=!1}={}){this.load(e,{skipValidation:t})}clear({preserveHeaders:e=!1}={}){this._board=new Array(128),this._kings={w:ae,b:ae},this._turn=pe,this._castling={w:0,b:0},this._epSquare=ae,this._halfMoves=0,this._moveNumber=1,this._history=[],this._comments={},this._header=e?this._header:{...js},this._hash=this._computeHash(),this._positionCount=new Map,this._header.SetUp=null,this._header.FEN=null}load(e,{skipValidation:t=!1,preserveHeaders:r=!1}={}){let s=e.split(/\s+/);if(s.length>=2&&s.length<6){const o=["-","-","0","1"];e=s.concat(o.slice(-(6-s.length))).join(" ")}if(s=e.split(/\s+/),!t){const{ok:o,error:c}=Is(e);if(!o)throw new Error(c)}const i=s[0];let a=0;this.clear({preserveHeaders:r});for(let o=0;o<i.length;o++){const c=i.charAt(o);if(c==="/")a+=8;else if(pr(c))a+=parseInt(c,10);else{const u=c<"a"?pe:je;this._put({type:c.toLowerCase(),color:u},ie(a)),a++}}this._turn=s[1],s[2].indexOf("K")>-1&&(this._castling.w|=$.KSIDE_CASTLE),s[2].indexOf("Q")>-1&&(this._castling.w|=$.QSIDE_CASTLE),s[2].indexOf("k")>-1&&(this._castling.b|=$.KSIDE_CASTLE),s[2].indexOf("q")>-1&&(this._castling.b|=$.QSIDE_CASTLE),this._epSquare=s[3]==="-"?ae:T[s[3]],this._halfMoves=parseInt(s[4],10),this._moveNumber=parseInt(s[5],10),this._hash=this._computeHash(),this._updateSetup(e),this._incPositionCount()}fen({forceEnpassantSquare:e=!1}={}){let t=0,r="";for(let a=T.a8;a<=T.h1;a++){if(this._board[a]){t>0&&(r+=t,t=0);const{color:o,type:c}=this._board[a];r+=o===pe?c.toUpperCase():c.toLowerCase()}else t++;a+1&136&&(t>0&&(r+=t),a!==T.h1&&(r+="/"),t=0,a+=8)}let s="";this._castling[pe]&$.KSIDE_CASTLE&&(s+="K"),this._castling[pe]&$.QSIDE_CASTLE&&(s+="Q"),this._castling[je]&$.KSIDE_CASTLE&&(s+="k"),this._castling[je]&$.QSIDE_CASTLE&&(s+="q"),s=s||"-";let i="-";if(this._epSquare!==ae)if(e)i=ie(this._epSquare);else{const a=this._epSquare+(this._turn===pe?16:-16),o=[a+1,a-1];for(const c of o){if(c&136)continue;const u=this._turn;if(this._board[c]?.color===u&&this._board[c]?.type===ee){this._makeMove({color:u,from:c,to:this._epSquare,piece:ee,captured:ee,flags:$.EP_CAPTURE});const f=!this._isKingAttacked(u);if(this._undoMove(),f){i=ie(this._epSquare);break}}}}return[r,this._turn,s,i,this._halfMoves,this._moveNumber].join(" ")}_pieceKey(e){if(!this._board[e])return 0n;const{color:t,type:r}=this._board[e],s={w:0,b:1}[t],i={p:0,n:1,b:2,r:3,q:4,k:5}[r];return ks[s][i][e]}_epKey(){return this._epSquare===ae?0n:Es[this._epSquare&7]}_castlingKey(){const e=this._castling.w>>5|this._castling.b>>3;return Ns[e]}_computeHash(){let e=0n;for(let t=T.a8;t<=T.h1;t++){if(t&136){t+=7;continue}this._board[t]&&(e^=this._pieceKey(t))}return e^=this._epKey(),e^=this._castlingKey(),this._turn==="b"&&(e^=un),e}_updateSetup(e){this._history.length>0||(e!==dn?(this._header.SetUp="1",this._header.FEN=e):(this._header.SetUp=null,this._header.FEN=null))}reset(){this.load(dn)}get(e){return this._board[T[e]]}findPiece(e){const t=[];for(let r=T.a8;r<=T.h1;r++){if(r&136){r+=7;continue}!this._board[r]||this._board[r]?.color!==e.color||this._board[r].color===e.color&&this._board[r].type===e.type&&t.push(ie(r))}return t}put({type:e,color:t},r){return this._put({type:e,color:t},r)?(this._updateCastlingRights(),this._updateEnPassantSquare(),this._updateSetup(this.fen()),!0):!1}_set(e,t){this._hash^=this._pieceKey(e),this._board[e]=t,this._hash^=this._pieceKey(e)}_put({type:e,color:t},r){if(Rs.indexOf(e.toLowerCase())===-1||!(r in T))return!1;const s=T[r];if(e==ne&&!(this._kings[t]==ae||this._kings[t]==s))return!1;const i=this._board[s];return i&&i.type===ne&&(this._kings[i.color]=ae),this._set(s,{type:e,color:t}),e===ne&&(this._kings[t]=s),!0}_clear(e){this._hash^=this._pieceKey(e),delete this._board[e]}remove(e){const t=this.get(e);return this._clear(T[e]),t&&t.type===ne&&(this._kings[t.color]=ae),this._updateCastlingRights(),this._updateEnPassantSquare(),this._updateSetup(this.fen()),t}_updateCastlingRights(){this._hash^=this._castlingKey();const e=this._board[T.e1]?.type===ne&&this._board[T.e1]?.color===pe,t=this._board[T.e8]?.type===ne&&this._board[T.e8]?.color===je;(!e||this._board[T.a1]?.type!==jt||this._board[T.a1]?.color!==pe)&&(this._castling.w&=-65),(!e||this._board[T.h1]?.type!==jt||this._board[T.h1]?.color!==pe)&&(this._castling.w&=-33),(!t||this._board[T.a8]?.type!==jt||this._board[T.a8]?.color!==je)&&(this._castling.b&=-65),(!t||this._board[T.h8]?.type!==jt||this._board[T.h8]?.color!==je)&&(this._castling.b&=-33),this._hash^=this._castlingKey()}_updateEnPassantSquare(){if(this._epSquare===ae)return;const e=this._epSquare+(this._turn===pe?-16:16),t=this._epSquare+(this._turn===pe?16:-16),r=[t+1,t-1];if(this._board[e]!==null||this._board[this._epSquare]!==null||this._board[t]?.color!==Nt(this._turn)||this._board[t]?.type!==ee){this._hash^=this._epKey(),this._epSquare=ae;return}const s=i=>!(i&136)&&this._board[i]?.color===this._turn&&this._board[i]?.type===ee;r.some(s)||(this._hash^=this._epKey(),this._epSquare=ae)}_attacked(e,t,r){const s=[];for(let i=T.a8;i<=T.h1;i++){if(i&136){i+=7;continue}if(this._board[i]===void 0||this._board[i].color!==e)continue;const a=this._board[i],o=i-t;if(o===0)continue;const c=o+119;if(As[c]&Ms[a.type]){if(a.type===ee){if(o>0&&a.color===pe||o<=0&&a.color===je)if(r)s.push(ie(i));else return!0;continue}if(a.type==="n"||a.type==="k")if(r){s.push(ie(i));continue}else return!0;const u=Ds[c];let f=i+u,m=!1;for(;f!==t;){if(this._board[f]!=null){m=!0;break}f+=u}if(!m)if(r){s.push(ie(i));continue}else return!0}}return r?s:!1}attackers(e,t){return t?this._attacked(t,T[e],!0):this._attacked(this._turn,T[e],!0)}_isKingAttacked(e){const t=this._kings[e];return t===-1?!1:this._attacked(Nt(e),t)}hash(){return this._hash.toString(16)}isAttacked(e,t){return this._attacked(t,T[e])}isCheck(){return this._isKingAttacked(this._turn)}inCheck(){return this.isCheck()}isCheckmate(){return this.isCheck()&&this._moves().length===0}isStalemate(){return!this.isCheck()&&this._moves().length===0}isInsufficientMaterial(){const e={b:0,n:0,r:0,q:0,k:0,p:0},t=[];let r=0,s=0;for(let i=T.a8;i<=T.h1;i++){if(s=(s+1)%2,i&136){i+=7;continue}const a=this._board[i];a&&(e[a.type]=a.type in e?e[a.type]+1:1,a.type===Ht&&t.push(s),r++)}if(r===2)return!0;if(r===3&&(e[Ht]===1||e[wn]===1))return!0;if(r===e[Ht]+2){let i=0;const a=t.length;for(let o=0;o<a;o++)i+=t[o];if(i===0||i===a)return!0}return!1}isThreefoldRepetition(){return this._getPositionCount(this._hash)>=3}isDrawByFiftyMoves(){return this._halfMoves>=100}isDraw(){return this.isDrawByFiftyMoves()||this.isStalemate()||this.isInsufficientMaterial()||this.isThreefoldRepetition()}isGameOver(){return this.isCheckmate()||this.isDraw()}moves({verbose:e=!1,square:t=void 0,piece:r=void 0}={}){const s=this._moves({square:t,piece:r});return e?s.map(i=>new zt(this,i)):s.map(i=>this._moveToSan(i,s))}_moves({legal:e=!0,piece:t=void 0,square:r=void 0}={}){const s=r?r.toLowerCase():void 0,i=t?.toLowerCase(),a=[],o=this._turn,c=Nt(o);let u=T.a8,f=T.h1,m=!1;if(s)if(s in T)u=f=T[s],m=!0;else return[];for(let v=u;v<=f;v++){if(v&136){v+=7;continue}if(!this._board[v]||this._board[v].color===c)continue;const{type:S}=this._board[v];let x;if(S===ee){if(i&&i!==S)continue;x=v+fn[o][0],this._board[x]||(ot(a,o,v,x,ee),x=v+fn[o][1],qs[o]===gt(v)&&!this._board[x]&&ot(a,o,v,x,ee,void 0,$.BIG_PAWN));for(let C=2;C<4;C++)x=v+fn[o][C],!(x&136)&&(this._board[x]?.color===c?ot(a,o,v,x,ee,this._board[x].type,$.CAPTURE):x===this._epSquare&&ot(a,o,v,x,ee,ee,$.EP_CAPTURE))}else{if(i&&i!==S)continue;for(let C=0,N=Gn[S].length;C<N;C++){const M=Gn[S][C];for(x=v;x+=M,!(x&136);){if(!this._board[x])ot(a,o,v,x,S);else{if(this._board[x].color===o)break;ot(a,o,v,x,S,this._board[x].type,$.CAPTURE);break}if(S===wn||S===ne)break}}}}if((i===void 0||i===ne)&&(!m||f===this._kings[o])){if(this._castling[o]&$.KSIDE_CASTLE){const v=this._kings[o],S=v+2;!this._board[v+1]&&!this._board[S]&&!this._attacked(c,this._kings[o])&&!this._attacked(c,v+1)&&!this._attacked(c,S)&&ot(a,o,this._kings[o],S,ne,void 0,$.KSIDE_CASTLE)}if(this._castling[o]&$.QSIDE_CASTLE){const v=this._kings[o],S=v-2;!this._board[v-1]&&!this._board[v-2]&&!this._board[v-3]&&!this._attacked(c,this._kings[o])&&!this._attacked(c,v-1)&&!this._attacked(c,S)&&ot(a,o,this._kings[o],S,ne,void 0,$.QSIDE_CASTLE)}}if(!e||this._kings[o]===-1)return a;const g=[];for(let v=0,S=a.length;v<S;v++)this._makeMove(a[v]),this._isKingAttacked(o)||g.push(a[v]),this._undoMove();return g}move(e,{strict:t=!1}={}){let r=null;if(typeof e=="string")r=this._moveFromSan(e,t);else if(e===null)r=this._moveFromSan(hn,t);else if(typeof e=="object"){const i=this._moves();for(let a=0,o=i.length;a<o;a++)if(e.from===ie(i[a].from)&&e.to===ie(i[a].to)&&(!("promotion"in i[a])||e.promotion===i[a].promotion)){r=i[a];break}}if(!r)throw typeof e=="string"?new Error(`Invalid move: ${e}`):new Error(`Invalid move: ${JSON.stringify(e)}`);if(this.isCheck()&&r.flags&$.NULL_MOVE)throw new Error("Null move not allowed when in check");const s=new zt(this,r);return this._makeMove(r),this._incPositionCount(),s}_push(e){this._history.push({move:e,kings:{b:this._kings.b,w:this._kings.w},turn:this._turn,castling:{b:this._castling.b,w:this._castling.w},epSquare:this._epSquare,halfMoves:this._halfMoves,moveNumber:this._moveNumber})}_movePiece(e,t){this._hash^=this._pieceKey(e),this._board[t]=this._board[e],delete this._board[e],this._hash^=this._pieceKey(t)}_makeMove(e){const t=this._turn,r=Nt(t);if(this._push(e),e.flags&$.NULL_MOVE){t===je&&this._moveNumber++,this._halfMoves++,this._turn=r,this._epSquare=ae;return}if(this._hash^=this._epKey(),this._hash^=this._castlingKey(),e.captured&&(this._hash^=this._pieceKey(e.to)),this._movePiece(e.from,e.to),e.flags&$.EP_CAPTURE&&(this._turn===je?this._clear(e.to-16):this._clear(e.to+16)),e.promotion&&(this._clear(e.to),this._set(e.to,{type:e.promotion,color:t})),this._board[e.to].type===ne){if(this._kings[t]=e.to,e.flags&$.KSIDE_CASTLE){const s=e.to-1,i=e.to+1;this._movePiece(i,s)}else if(e.flags&$.QSIDE_CASTLE){const s=e.to+1,i=e.to-2;this._movePiece(i,s)}this._castling[t]=0}if(this._castling[t]){for(let s=0,i=it[t].length;s<i;s++)if(e.from===it[t][s].square&&this._castling[t]&it[t][s].flag){this._castling[t]^=it[t][s].flag;break}}if(this._castling[r]){for(let s=0,i=it[r].length;s<i;s++)if(e.to===it[r][s].square&&this._castling[r]&it[r][s].flag){this._castling[r]^=it[r][s].flag;break}}if(this._hash^=this._castlingKey(),e.flags&$.BIG_PAWN){let s;t===je?s=e.to-16:s=e.to+16,!(e.to-1&136)&&this._board[e.to-1]?.type===ee&&this._board[e.to-1]?.color===r||!(e.to+1&136)&&this._board[e.to+1]?.type===ee&&this._board[e.to+1]?.color===r?(this._epSquare=s,this._hash^=this._epKey()):this._epSquare=ae}else this._epSquare=ae;e.piece===ee?this._halfMoves=0:e.flags&($.CAPTURE|$.EP_CAPTURE)?this._halfMoves=0:this._halfMoves++,t===je&&this._moveNumber++,this._turn=r,this._hash^=un}undo(){const e=this._hash,t=this._undoMove();if(t){const r=new zt(this,t);return this._decPositionCount(e),r}return null}_undoMove(){const e=this._history.pop();if(e===void 0)return null;this._hash^=this._epKey(),this._hash^=this._castlingKey();const t=e.move;this._kings=e.kings,this._turn=e.turn,this._castling=e.castling,this._epSquare=e.epSquare,this._halfMoves=e.halfMoves,this._moveNumber=e.moveNumber,this._hash^=this._epKey(),this._hash^=this._castlingKey(),this._hash^=un;const r=this._turn,s=Nt(r);if(t.flags&$.NULL_MOVE)return t;if(this._movePiece(t.to,t.from),t.piece&&(this._clear(t.from),this._set(t.from,{type:t.piece,color:r})),t.captured)if(t.flags&$.EP_CAPTURE){let i;r===je?i=t.to-16:i=t.to+16,this._set(i,{type:ee,color:s})}else this._set(t.to,{type:t.captured,color:s});if(t.flags&($.KSIDE_CASTLE|$.QSIDE_CASTLE)){let i,a;t.flags&$.KSIDE_CASTLE?(i=t.to+1,a=t.to-1):(i=t.to-2,a=t.to+1),this._movePiece(a,i)}return t}pgn({newline:e=`
`,maxWidth:t=0}={}){const r=[];let s=!1;for(const g in this._header)this._header[g]&&r.push(`[${g} "${this._header[g]}"]`+e),s=!0;s&&this._history.length&&r.push(e);const i=g=>{const v=this._comments[this.fen()];if(typeof v<"u"){const S=g.length>0?" ":"";g=`${g}${S}{${v}}`}return g},a=[];for(;this._history.length>0;)a.push(this._undoMove());const o=[];let c="";for(a.length===0&&o.push(i(""));a.length>0;){c=i(c);const g=a.pop();if(!g)break;if(!this._history.length&&g.color==="b"){const v=`${this._moveNumber}. ...`;c=c?`${c} ${v}`:v}else g.color==="w"&&(c.length&&o.push(c),c=this._moveNumber+".");c=c+" "+this._moveToSan(g,this._moves({legal:!0})),this._makeMove(g)}if(c.length&&o.push(i(c)),o.push(this._header.Result||"*"),t===0)return r.join("")+o.join(" ");const u=function(){return r.length>0&&r[r.length-1]===" "?(r.pop(),!0):!1},f=function(g,v){for(const S of v.split(" "))if(S){if(g+S.length>t){for(;u();)g--;r.push(e),g=0}r.push(S),g+=S.length,r.push(" "),g++}return u()&&g--,g};let m=0;for(let g=0;g<o.length;g++){if(m+o[g].length>t&&o[g].includes("{")){m=f(m,o[g]);continue}m+o[g].length>t&&g!==0?(r[r.length-1]===" "&&r.pop(),r.push(e),m=0):g!==0&&(r.push(" "),m++),r.push(o[g]),m+=o[g].length}return r.join("")}header(...e){for(let t=0;t<e.length;t+=2)typeof e[t]=="string"&&typeof e[t+1]=="string"&&(this._header[e[t]]=e[t+1]);return this._header}setHeader(e,t){return this._header[e]=t??Sn[e]??null,this.getHeaders()}removeHeader(e){return e in this._header?(this._header[e]=Sn[e]||null,!0):!1}getHeaders(){const e={};for(const[t,r]of Object.entries(this._header))r!==null&&(e[t]=r);return e}loadPgn(e,{strict:t=!1,newlineChar:r=`\r?
`}={}){r!==`\r?
`&&(e=e.replace(new RegExp(r,"g"),`
`));const s=Cs(e);this.reset();const i=s.headers;let a="";for(const u in i)u.toLowerCase()==="fen"&&(a=i[u]),this.header(u,i[u]);if(!t)a&&this.load(a,{preserveHeaders:!0});else if(i.SetUp==="1"){if(!("FEN"in i))throw new Error("Invalid PGN: FEN tag must be supplied with SetUp tag");this.load(i.FEN,{preserveHeaders:!0})}let o=s.root;for(;o;){if(o.move){const u=this._moveFromSan(o.move,t);if(u==null)throw new Error(`Invalid move in PGN: ${o.move}`);this._makeMove(u),this._incPositionCount()}o.comment!==void 0&&(this._comments[this.fen()]=o.comment),o=o.variations[0]}const c=s.result;c&&Object.keys(this._header).length&&this._header.Result!==c&&this.setHeader("Result",c)}_moveToSan(e,t){let r="";if(e.flags&$.KSIDE_CASTLE)r="O-O";else if(e.flags&$.QSIDE_CASTLE)r="O-O-O";else{if(e.flags&$.NULL_MOVE)return hn;if(e.piece!==ee){const s=Ks(e,t);r+=e.piece.toUpperCase()+s}e.flags&($.CAPTURE|$.EP_CAPTURE)&&(e.piece===ee&&(r+=ie(e.from)[0]),r+="x"),r+=ie(e.to),e.promotion&&(r+="="+e.promotion.toUpperCase())}return this._makeMove(e),this.isCheck()&&(this.isCheckmate()?r+="#":r+="+"),this._undoMove(),r}_moveFromSan(e,t=!1){let r=gn(e);if(t||(r==="0-0"?r="O-O":r==="0-0-0"&&(r="O-O-O")),r==hn)return{color:this._turn,from:0,to:0,piece:"k",flags:$.NULL_MOVE};let s=Yn(r),i=this._moves({legal:!0,piece:s});for(let g=0,v=i.length;g<v;g++)if(r===gn(this._moveToSan(i[g],i)))return i[g];if(t)return null;let a,o,c,u,f,m=!1;if(o=r.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/),o?(a=o[1],c=o[2],u=o[3],f=o[4],c.length==1&&(m=!0)):(o=r.match(/([pnbrqkPNBRQK])?([a-h]?[1-8]?)x?-?([a-h][1-8])([qrbnQRBN])?/),o&&(a=o[1],c=o[2],u=o[3],f=o[4],c.length==1&&(m=!0))),s=Yn(r),i=this._moves({legal:!0,piece:a||s}),!u)return null;for(let g=0,v=i.length;g<v;g++)if(c){if((!a||a.toLowerCase()==i[g].piece)&&T[c]==i[g].from&&T[u]==i[g].to&&(!f||f.toLowerCase()==i[g].promotion))return i[g];if(m){const S=ie(i[g].from);if((!a||a.toLowerCase()==i[g].piece)&&T[u]==i[g].to&&(c==S[0]||c==S[1])&&(!f||f.toLowerCase()==i[g].promotion))return i[g]}}else if(r===gn(this._moveToSan(i[g],i)).replace("x",""))return i[g];return null}ascii(){let e=`   +------------------------+
`;for(let t=T.a8;t<=T.h1;t++){if(Rt(t)===0&&(e+=" "+"87654321"[gt(t)]+" |"),this._board[t]){const r=this._board[t].type,i=this._board[t].color===pe?r.toUpperCase():r.toLowerCase();e+=" "+i+" "}else e+=" . ";t+1&136&&(e+=`|
`,t+=8)}return e+=`   +------------------------+
`,e+="     a  b  c  d  e  f  g  h",e}perft(e){const t=this._moves({legal:!1});let r=0;const s=this._turn;for(let i=0,a=t.length;i<a;i++)this._makeMove(t[i]),this._isKingAttacked(s)||(e-1>0?r+=this.perft(e-1):r++),this._undoMove();return r}setTurn(e){return this._turn==e?!1:(this.move("--"),!0)}turn(){return this._turn}board(){const e=[];let t=[];for(let r=T.a8;r<=T.h1;r++)this._board[r]==null?t.push(null):t.push({square:ie(r),type:this._board[r].type,color:this._board[r].color}),r+1&136&&(e.push(t),t=[],r+=8);return e}squareColor(e){if(e in T){const t=T[e];return(gt(t)+Rt(t))%2===0?"light":"dark"}return null}history({verbose:e=!1}={}){const t=[],r=[];for(;this._history.length>0;)t.push(this._undoMove());for(;;){const s=t.pop();if(!s)break;e?r.push(new zt(this,s)):r.push(this._moveToSan(s,this._moves())),this._makeMove(s)}return r}_getPositionCount(e){return this._positionCount.get(e)??0}_incPositionCount(){this._positionCount.set(this._hash,(this._positionCount.get(this._hash)??0)+1)}_decPositionCount(e){const t=this._positionCount.get(e)??0;t===1?this._positionCount.delete(e):this._positionCount.set(e,t-1)}_pruneComments(){const e=[],t={},r=s=>{s in this._comments&&(t[s]=this._comments[s])};for(;this._history.length>0;)e.push(this._undoMove());for(r(this.fen());;){const s=e.pop();if(!s)break;this._makeMove(s),r(this.fen())}this._comments=t}getComment(){return this._comments[this.fen()]}setComment(e){this._comments[this.fen()]=e.replace("{","[").replace("}","]")}deleteComment(){return this.removeComment()}removeComment(){const e=this._comments[this.fen()];return delete this._comments[this.fen()],e}getComments(){return this._pruneComments(),Object.keys(this._comments).map(e=>({fen:e,comment:this._comments[e]}))}deleteComments(){return this.removeComments()}removeComments(){return this._pruneComments(),Object.keys(this._comments).map(e=>{const t=this._comments[e];return delete this._comments[e],{fen:e,comment:t}})}setCastlingRights(e,t){for(const s of[ne,at])t[s]!==void 0&&(t[s]?this._castling[e]|=Wt[s]:this._castling[e]&=~Wt[s]);this._updateCastlingRights();const r=this.getCastlingRights(e);return(t[ne]===void 0||t[ne]===r[ne])&&(t[at]===void 0||t[at]===r[at])}getCastlingRights(e){return{[ne]:(this._castling[e]&Wt[ne])!==0,[at]:(this._castling[e]&Wt[at])!==0}}moveNumber(){return this._moveNumber}}const tn=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function yt(n){const e=Object.prototype.toString.call(n);return e==="[object Window]"||e==="[object global]"}function Nn(n){return"nodeType"in n}function Se(n){var e,t;return n?yt(n)?n:Nn(n)&&(e=(t=n.ownerDocument)==null?void 0:t.defaultView)!=null?e:window:window}function Ln(n){const{Document:e}=Se(n);return n instanceof e}function qt(n){return yt(n)?!1:n instanceof Se(n).HTMLElement}function mr(n){return n instanceof Se(n).SVGElement}function xt(n){return n?yt(n)?n.document:Nn(n)?Ln(n)?n:qt(n)||mr(n)?n.ownerDocument:document:document:document}const Ze=tn?d.useLayoutEffect:d.useEffect;function nn(n){const e=d.useRef(n);return Ze(()=>{e.current=n}),d.useCallback(function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return e.current==null?void 0:e.current(...r)},[])}function Bs(){const n=d.useRef(null),e=d.useCallback((r,s)=>{n.current=setInterval(r,s)},[]),t=d.useCallback(()=>{n.current!==null&&(clearInterval(n.current),n.current=null)},[]);return[e,t]}function Tt(n,e){e===void 0&&(e=[n]);const t=d.useRef(n);return Ze(()=>{t.current!==n&&(t.current=n)},e),t}function It(n,e){const t=d.useRef();return d.useMemo(()=>{const r=n(t.current);return t.current=r,r},[...e])}function Qt(n){const e=nn(n),t=d.useRef(null),r=d.useCallback(s=>{s!==t.current&&e?.(s,t.current),t.current=s},[]);return[t,r]}function Vt(n){const e=d.useRef();return d.useEffect(()=>{e.current=n},[n]),e.current}let mn={};function rn(n,e){return d.useMemo(()=>{if(e)return e;const t=mn[n]==null?0:mn[n]+1;return mn[n]=t,n+"-"+t},[n,e])}function vr(n){return function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];return r.reduce((i,a)=>{const o=Object.entries(a);for(const[c,u]of o){const f=i[c];f!=null&&(i[c]=f+n*u)}return i},{...e})}}const vt=vr(1),Xt=vr(-1);function Fs(n){return"clientX"in n&&"clientY"in n}function jn(n){if(!n)return!1;const{KeyboardEvent:e}=Se(n.target);return e&&n instanceof e}function zs(n){if(!n)return!1;const{TouchEvent:e}=Se(n.target);return e&&n instanceof e}function $t(n){if(zs(n)){if(n.touches&&n.touches.length){const{clientX:e,clientY:t}=n.touches[0];return{x:e,y:t}}else if(n.changedTouches&&n.changedTouches.length){const{clientX:e,clientY:t}=n.changedTouches[0];return{x:e,y:t}}}return Fs(n)?{x:n.clientX,y:n.clientY}:null}const Ot=Object.freeze({Translate:{toString(n){if(!n)return;const{x:e,y:t}=n;return"translate3d("+(e?Math.round(e):0)+"px, "+(t?Math.round(t):0)+"px, 0)"}},Scale:{toString(n){if(!n)return;const{scaleX:e,scaleY:t}=n;return"scaleX("+e+") scaleY("+t+")"}},Transform:{toString(n){if(n)return[Ot.Translate.toString(n),Ot.Scale.toString(n)].join(" ")}},Transition:{toString(n){let{property:e,duration:t,easing:r}=n;return e+" "+t+"ms "+r}}}),Qn="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Ws(n){return n.matches(Qn)?n:n.querySelector(Qn)}const Us={display:"none"};function Gs(n){let{id:e,value:t}=n;return J.createElement("div",{id:e,style:Us},t)}function Hs(n){let{id:e,announcement:t,ariaLiveType:r="assertive"}=n;const s={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return J.createElement("div",{id:e,style:s,role:"status","aria-live":r,"aria-atomic":!0},t)}function Ys(){const[n,e]=d.useState("");return{announce:d.useCallback(r=>{r!=null&&e(r)},[]),announcement:n}}const br=d.createContext(null);function Qs(n){const e=d.useContext(br);d.useEffect(()=>{if(!e)throw new Error("useDndMonitor must be used within a children of <DndContext>");return e(n)},[n,e])}function Vs(){const[n]=d.useState(()=>new Set),e=d.useCallback(r=>(n.add(r),()=>n.delete(r)),[n]);return[d.useCallback(r=>{let{type:s,event:i}=r;n.forEach(a=>{var o;return(o=a[s])==null?void 0:o.call(a,i)})},[n]),e]}const Xs={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Js={onDragStart(n){let{active:e}=n;return"Picked up draggable item "+e.id+"."},onDragOver(n){let{active:e,over:t}=n;return t?"Draggable item "+e.id+" was moved over droppable area "+t.id+".":"Draggable item "+e.id+" is no longer over a droppable area."},onDragEnd(n){let{active:e,over:t}=n;return t?"Draggable item "+e.id+" was dropped over droppable area "+t.id:"Draggable item "+e.id+" was dropped."},onDragCancel(n){let{active:e}=n;return"Dragging was cancelled. Draggable item "+e.id+" was dropped."}};function Zs(n){let{announcements:e=Js,container:t,hiddenTextDescribedById:r,screenReaderInstructions:s=Xs}=n;const{announce:i,announcement:a}=Ys(),o=rn("DndLiveRegion"),[c,u]=d.useState(!1);if(d.useEffect(()=>{u(!0)},[]),Qs(d.useMemo(()=>({onDragStart(m){let{active:g}=m;i(e.onDragStart({active:g}))},onDragMove(m){let{active:g,over:v}=m;e.onDragMove&&i(e.onDragMove({active:g,over:v}))},onDragOver(m){let{active:g,over:v}=m;i(e.onDragOver({active:g,over:v}))},onDragEnd(m){let{active:g,over:v}=m;i(e.onDragEnd({active:g,over:v}))},onDragCancel(m){let{active:g,over:v}=m;i(e.onDragCancel({active:g,over:v}))}}),[i,e])),!c)return null;const f=J.createElement(J.Fragment,null,J.createElement(Gs,{id:r,value:s.draggable}),J.createElement(Hs,{id:o,announcement:a}));return t?Lt.createPortal(f,t):f}var re;(function(n){n.DragStart="dragStart",n.DragMove="dragMove",n.DragEnd="dragEnd",n.DragCancel="dragCancel",n.DragOver="dragOver",n.RegisterDroppable="registerDroppable",n.SetDroppableDisabled="setDroppableDisabled",n.UnregisterDroppable="unregisterDroppable"})(re||(re={}));function Jt(){}function Ut(n,e){return d.useMemo(()=>({sensor:n,options:e??{}}),[n,e])}function ei(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return d.useMemo(()=>[...e].filter(r=>r!=null),[...e])}const Fe=Object.freeze({x:0,y:0});function ti(n,e){return Math.sqrt(Math.pow(n.x-e.x,2)+Math.pow(n.y-e.y,2))}function ni(n,e){const t=$t(n);if(!t)return"0 0";const r={x:(t.x-e.left)/e.width*100,y:(t.y-e.top)/e.height*100};return r.x+"% "+r.y+"%"}function ri(n,e){let{data:{value:t}}=n,{data:{value:r}}=e;return t-r}function si(n,e){let{data:{value:t}}=n,{data:{value:r}}=e;return r-t}function ii(n){let{left:e,top:t,height:r,width:s}=n;return[{x:e,y:t},{x:e+s,y:t},{x:e,y:t+r},{x:e+s,y:t+r}]}function oi(n,e){if(!n||n.length===0)return null;const[t]=n;return t[e]}function ai(n,e){const t=Math.max(e.top,n.top),r=Math.max(e.left,n.left),s=Math.min(e.left+e.width,n.left+n.width),i=Math.min(e.top+e.height,n.top+n.height),a=s-r,o=i-t;if(r<s&&t<i){const c=e.width*e.height,u=n.width*n.height,f=a*o,m=f/(c+u-f);return Number(m.toFixed(4))}return 0}const yr=n=>{let{collisionRect:e,droppableRects:t,droppableContainers:r}=n;const s=[];for(const i of r){const{id:a}=i,o=t.get(a);if(o){const c=ai(o,e);c>0&&s.push({id:a,data:{droppableContainer:i,value:c}})}}return s.sort(si)};function li(n,e){const{top:t,left:r,bottom:s,right:i}=e;return t<=n.y&&n.y<=s&&r<=n.x&&n.x<=i}const ci=n=>{let{droppableContainers:e,droppableRects:t,pointerCoordinates:r}=n;if(!r)return[];const s=[];for(const i of e){const{id:a}=i,o=t.get(a);if(o&&li(r,o)){const u=ii(o).reduce((m,g)=>m+ti(r,g),0),f=Number((u/4).toFixed(4));s.push({id:a,data:{droppableContainer:i,value:f}})}}return s.sort(ri)};function ui(n,e,t){return{...n,scaleX:e&&t?e.width/t.width:1,scaleY:e&&t?e.height/t.height:1}}function xr(n,e){return n&&e?{x:n.left-e.left,y:n.top-e.top}:Fe}function di(n){return function(t){for(var r=arguments.length,s=new Array(r>1?r-1:0),i=1;i<r;i++)s[i-1]=arguments[i];return s.reduce((a,o)=>({...a,top:a.top+n*o.y,bottom:a.bottom+n*o.y,left:a.left+n*o.x,right:a.right+n*o.x}),{...t})}}const fi=di(1);function wr(n){if(n.startsWith("matrix3d(")){const e=n.slice(9,-1).split(/, /);return{x:+e[12],y:+e[13],scaleX:+e[0],scaleY:+e[5]}}else if(n.startsWith("matrix(")){const e=n.slice(7,-1).split(/, /);return{x:+e[4],y:+e[5],scaleX:+e[0],scaleY:+e[3]}}return null}function hi(n,e,t){const r=wr(e);if(!r)return n;const{scaleX:s,scaleY:i,x:a,y:o}=r,c=n.left-a-(1-s)*parseFloat(t),u=n.top-o-(1-i)*parseFloat(t.slice(t.indexOf(" ")+1)),f=s?n.width/s:n.width,m=i?n.height/i:n.height;return{width:f,height:m,top:u,right:c+f,bottom:u+m,left:c}}const gi={ignoreTransform:!1};function Kt(n,e){e===void 0&&(e=gi);let t=n.getBoundingClientRect();if(e.ignoreTransform){const{transform:u,transformOrigin:f}=Se(n).getComputedStyle(n);u&&(t=hi(t,u,f))}const{top:r,left:s,width:i,height:a,bottom:o,right:c}=t;return{top:r,left:s,width:i,height:a,bottom:o,right:c}}function Vn(n){return Kt(n,{ignoreTransform:!0})}function pi(n){const e=n.innerWidth,t=n.innerHeight;return{top:0,left:0,right:e,bottom:t,width:e,height:t}}function mi(n,e){return e===void 0&&(e=Se(n).getComputedStyle(n)),e.position==="fixed"}function vi(n,e){e===void 0&&(e=Se(n).getComputedStyle(n));const t=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(s=>{const i=e[s];return typeof i=="string"?t.test(i):!1})}function An(n,e){const t=[];function r(s){if(e!=null&&t.length>=e||!s)return t;if(Ln(s)&&s.scrollingElement!=null&&!t.includes(s.scrollingElement))return t.push(s.scrollingElement),t;if(!qt(s)||mr(s)||t.includes(s))return t;const i=Se(n).getComputedStyle(s);return s!==n&&vi(s,i)&&t.push(s),mi(s,i)?t:r(s.parentNode)}return n?r(n):t}function Sr(n){const[e]=An(n,1);return e??null}function vn(n){return!tn||!n?null:yt(n)?n:Nn(n)?Ln(n)||n===xt(n).scrollingElement?window:qt(n)?n:null:null}function Cr(n){return yt(n)?n.scrollX:n.scrollLeft}function _r(n){return yt(n)?n.scrollY:n.scrollTop}function Cn(n){return{x:Cr(n),y:_r(n)}}var oe;(function(n){n[n.Forward=1]="Forward",n[n.Backward=-1]="Backward"})(oe||(oe={}));function kr(n){return!tn||!n?!1:n===document.scrollingElement}function Er(n){const e={x:0,y:0},t=kr(n)?{height:window.innerHeight,width:window.innerWidth}:{height:n.clientHeight,width:n.clientWidth},r={x:n.scrollWidth-t.width,y:n.scrollHeight-t.height},s=n.scrollTop<=e.y,i=n.scrollLeft<=e.x,a=n.scrollTop>=r.y,o=n.scrollLeft>=r.x;return{isTop:s,isLeft:i,isBottom:a,isRight:o,maxScroll:r,minScroll:e}}const bi={x:.2,y:.2};function yi(n,e,t,r,s){let{top:i,left:a,right:o,bottom:c}=t;r===void 0&&(r=10),s===void 0&&(s=bi);const{isTop:u,isBottom:f,isLeft:m,isRight:g}=Er(n),v={x:0,y:0},S={x:0,y:0},x={height:e.height*s.y,width:e.width*s.x};return!u&&i<=e.top+x.height?(v.y=oe.Backward,S.y=r*Math.abs((e.top+x.height-i)/x.height)):!f&&c>=e.bottom-x.height&&(v.y=oe.Forward,S.y=r*Math.abs((e.bottom-x.height-c)/x.height)),!g&&o>=e.right-x.width?(v.x=oe.Forward,S.x=r*Math.abs((e.right-x.width-o)/x.width)):!m&&a<=e.left+x.width&&(v.x=oe.Backward,S.x=r*Math.abs((e.left+x.width-a)/x.width)),{direction:v,speed:S}}function xi(n){if(n===document.scrollingElement){const{innerWidth:i,innerHeight:a}=window;return{top:0,left:0,right:i,bottom:a,width:i,height:a}}const{top:e,left:t,right:r,bottom:s}=n.getBoundingClientRect();return{top:e,left:t,right:r,bottom:s,width:n.clientWidth,height:n.clientHeight}}function Nr(n){return n.reduce((e,t)=>vt(e,Cn(t)),Fe)}function wi(n){return n.reduce((e,t)=>e+Cr(t),0)}function Si(n){return n.reduce((e,t)=>e+_r(t),0)}function Lr(n,e){if(e===void 0&&(e=Kt),!n)return;const{top:t,left:r,bottom:s,right:i}=e(n);Sr(n)&&(s<=0||i<=0||t>=window.innerHeight||r>=window.innerWidth)&&n.scrollIntoView({block:"center",inline:"center"})}const Ci=[["x",["left","right"],wi],["y",["top","bottom"],Si]];class Dn{constructor(e,t){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=An(t),s=Nr(r);this.rect={...e},this.width=e.width,this.height=e.height;for(const[i,a,o]of Ci)for(const c of a)Object.defineProperty(this,c,{get:()=>{const u=o(r),f=s[i]-u;return this.rect[c]+f},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class At{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(t=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...t)})},this.target=e}add(e,t,r){var s;(s=this.target)==null||s.addEventListener(e,t,r),this.listeners.push([e,t,r])}}function _i(n){const{EventTarget:e}=Se(n);return n instanceof e?n:xt(n)}function bn(n,e){const t=Math.abs(n.x),r=Math.abs(n.y);return typeof e=="number"?Math.sqrt(t**2+r**2)>e:"x"in e&&"y"in e?t>e.x&&r>e.y:"x"in e?t>e.x:"y"in e?r>e.y:!1}var Re;(function(n){n.Click="click",n.DragStart="dragstart",n.Keydown="keydown",n.ContextMenu="contextmenu",n.Resize="resize",n.SelectionChange="selectionchange",n.VisibilityChange="visibilitychange"})(Re||(Re={}));function Xn(n){n.preventDefault()}function ki(n){n.stopPropagation()}var z;(function(n){n.Space="Space",n.Down="ArrowDown",n.Right="ArrowRight",n.Left="ArrowLeft",n.Up="ArrowUp",n.Esc="Escape",n.Enter="Enter",n.Tab="Tab"})(z||(z={}));const jr={start:[z.Space,z.Enter],cancel:[z.Esc],end:[z.Space,z.Enter,z.Tab]},Ei=(n,e)=>{let{currentCoordinates:t}=e;switch(n.code){case z.Right:return{...t,x:t.x+25};case z.Left:return{...t,x:t.x-25};case z.Down:return{...t,y:t.y+25};case z.Up:return{...t,y:t.y-25}}};class Mn{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:t}}=e;this.props=e,this.listeners=new At(xt(t)),this.windowListeners=new At(Se(t)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Re.Resize,this.handleCancel),this.windowListeners.add(Re.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Re.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:t}=this.props,r=e.node.current;r&&Lr(r),t(Fe)}handleKeyDown(e){if(jn(e)){const{active:t,context:r,options:s}=this.props,{keyboardCodes:i=jr,coordinateGetter:a=Ei,scrollBehavior:o="smooth"}=s,{code:c}=e;if(i.end.includes(c)){this.handleEnd(e);return}if(i.cancel.includes(c)){this.handleCancel(e);return}const{collisionRect:u}=r.current,f=u?{x:u.left,y:u.top}:Fe;this.referenceCoordinates||(this.referenceCoordinates=f);const m=a(e,{active:t,context:r.current,currentCoordinates:f});if(m){const g=Xt(m,f),v={x:0,y:0},{scrollableAncestors:S}=r.current;for(const x of S){const C=e.code,{isTop:N,isRight:M,isLeft:R,isBottom:O,maxScroll:k,minScroll:_}=Er(x),A=xi(x),E={x:Math.min(C===z.Right?A.right-A.width/2:A.right,Math.max(C===z.Right?A.left:A.left+A.width/2,m.x)),y:Math.min(C===z.Down?A.bottom-A.height/2:A.bottom,Math.max(C===z.Down?A.top:A.top+A.height/2,m.y))},q=C===z.Right&&!M||C===z.Left&&!R,K=C===z.Down&&!O||C===z.Up&&!N;if(q&&E.x!==m.x){const P=x.scrollLeft+g.x,V=C===z.Right&&P<=k.x||C===z.Left&&P>=_.x;if(V&&!g.y){x.scrollTo({left:P,behavior:o});return}V?v.x=x.scrollLeft-P:v.x=C===z.Right?x.scrollLeft-k.x:x.scrollLeft-_.x,v.x&&x.scrollBy({left:-v.x,behavior:o});break}else if(K&&E.y!==m.y){const P=x.scrollTop+g.y,V=C===z.Down&&P<=k.y||C===z.Up&&P>=_.y;if(V&&!g.x){x.scrollTo({top:P,behavior:o});return}V?v.y=x.scrollTop-P:v.y=C===z.Down?x.scrollTop-k.y:x.scrollTop-_.y,v.y&&x.scrollBy({top:-v.y,behavior:o});break}}this.handleMove(e,vt(Xt(m,this.referenceCoordinates),v))}}}handleMove(e,t){const{onMove:r}=this.props;e.preventDefault(),r(t)}handleEnd(e){const{onEnd:t}=this.props;e.preventDefault(),this.detach(),t()}handleCancel(e){const{onCancel:t}=this.props;e.preventDefault(),this.detach(),t()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}Mn.activators=[{eventName:"onKeyDown",handler:(n,e,t)=>{let{keyboardCodes:r=jr,onActivation:s}=e,{active:i}=t;const{code:a}=n.nativeEvent;if(r.start.includes(a)){const o=i.activatorNode.current;return o&&n.target!==o?!1:(n.preventDefault(),s?.({event:n.nativeEvent}),!0)}return!1}}];function Jn(n){return!!(n&&"distance"in n)}function Zn(n){return!!(n&&"delay"in n)}class Rn{constructor(e,t,r){var s;r===void 0&&(r=_i(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=t;const{event:i}=e,{target:a}=i;this.props=e,this.events=t,this.document=xt(a),this.documentListeners=new At(this.document),this.listeners=new At(r),this.windowListeners=new At(Se(a)),this.initialCoordinates=(s=$t(i))!=null?s:Fe,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:t,bypassActivationConstraint:r}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(Re.Resize,this.handleCancel),this.windowListeners.add(Re.DragStart,Xn),this.windowListeners.add(Re.VisibilityChange,this.handleCancel),this.windowListeners.add(Re.ContextMenu,Xn),this.documentListeners.add(Re.Keydown,this.handleKeydown),t){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(Zn(t)){this.timeoutId=setTimeout(this.handleStart,t.delay),this.handlePending(t);return}if(Jn(t)){this.handlePending(t);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,t){const{active:r,onPending:s}=this.props;s(r,e,this.initialCoordinates,t)}handleStart(){const{initialCoordinates:e}=this,{onStart:t}=this.props;e&&(this.activated=!0,this.documentListeners.add(Re.Click,ki,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Re.SelectionChange,this.removeTextSelection),t(e))}handleMove(e){var t;const{activated:r,initialCoordinates:s,props:i}=this,{onMove:a,options:{activationConstraint:o}}=i;if(!s)return;const c=(t=$t(e))!=null?t:Fe,u=Xt(s,c);if(!r&&o){if(Jn(o)){if(o.tolerance!=null&&bn(u,o.tolerance))return this.handleCancel();if(bn(u,o.distance))return this.handleStart()}if(Zn(o)&&bn(u,o.tolerance))return this.handleCancel();this.handlePending(o,u);return}e.cancelable&&e.preventDefault(),a(c)}handleEnd(){const{onAbort:e,onEnd:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleCancel(){const{onAbort:e,onCancel:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleKeydown(e){e.code===z.Esc&&this.handleCancel()}removeTextSelection(){var e;(e=this.document.getSelection())==null||e.removeAllRanges()}}const Ni={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Tn extends Rn{constructor(e){const{event:t}=e,r=xt(t.target);super(e,Ni,r)}}Tn.activators=[{eventName:"onPointerDown",handler:(n,e)=>{let{nativeEvent:t}=n,{onActivation:r}=e;return!t.isPrimary||t.button!==0?!1:(r?.({event:t}),!0)}}];const Li={move:{name:"mousemove"},end:{name:"mouseup"}};var _n;(function(n){n[n.RightClick=2]="RightClick"})(_n||(_n={}));class Ar extends Rn{constructor(e){super(e,Li,xt(e.event.target))}}Ar.activators=[{eventName:"onMouseDown",handler:(n,e)=>{let{nativeEvent:t}=n,{onActivation:r}=e;return t.button===_n.RightClick?!1:(r?.({event:t}),!0)}}];const yn={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Dr extends Rn{constructor(e){super(e,yn)}static setup(){return window.addEventListener(yn.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(yn.move.name,e)};function e(){}}}Dr.activators=[{eventName:"onTouchStart",handler:(n,e)=>{let{nativeEvent:t}=n,{onActivation:r}=e;const{touches:s}=t;return s.length>1?!1:(r?.({event:t}),!0)}}];var Dt;(function(n){n[n.Pointer=0]="Pointer",n[n.DraggableRect=1]="DraggableRect"})(Dt||(Dt={}));var Zt;(function(n){n[n.TreeOrder=0]="TreeOrder",n[n.ReversedTreeOrder=1]="ReversedTreeOrder"})(Zt||(Zt={}));function ji(n){let{acceleration:e,activator:t=Dt.Pointer,canScroll:r,draggingRect:s,enabled:i,interval:a=5,order:o=Zt.TreeOrder,pointerCoordinates:c,scrollableAncestors:u,scrollableAncestorRects:f,delta:m,threshold:g}=n;const v=Di({delta:m,disabled:!i}),[S,x]=Bs(),C=d.useRef({x:0,y:0}),N=d.useRef({x:0,y:0}),M=d.useMemo(()=>{switch(t){case Dt.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case Dt.DraggableRect:return s}},[t,s,c]),R=d.useRef(null),O=d.useCallback(()=>{const _=R.current;if(!_)return;const A=C.current.x*N.current.x,E=C.current.y*N.current.y;_.scrollBy(A,E)},[]),k=d.useMemo(()=>o===Zt.TreeOrder?[...u].reverse():u,[o,u]);d.useEffect(()=>{if(!i||!u.length||!M){x();return}for(const _ of k){if(r?.(_)===!1)continue;const A=u.indexOf(_),E=f[A];if(!E)continue;const{direction:q,speed:K}=yi(_,E,M,e,g);for(const P of["x","y"])v[P][q[P]]||(K[P]=0,q[P]=0);if(K.x>0||K.y>0){x(),R.current=_,S(O,a),C.current=K,N.current=q;return}}C.current={x:0,y:0},N.current={x:0,y:0},x()},[e,O,r,x,i,a,JSON.stringify(M),JSON.stringify(v),S,u,k,f,JSON.stringify(g)])}const Ai={x:{[oe.Backward]:!1,[oe.Forward]:!1},y:{[oe.Backward]:!1,[oe.Forward]:!1}};function Di(n){let{delta:e,disabled:t}=n;const r=Vt(e);return It(s=>{if(t||!r||!s)return Ai;const i={x:Math.sign(e.x-r.x),y:Math.sign(e.y-r.y)};return{x:{[oe.Backward]:s.x[oe.Backward]||i.x===-1,[oe.Forward]:s.x[oe.Forward]||i.x===1},y:{[oe.Backward]:s.y[oe.Backward]||i.y===-1,[oe.Forward]:s.y[oe.Forward]||i.y===1}}},[t,e,r])}function Mi(n,e){const t=e!=null?n.get(e):void 0,r=t?t.node.current:null;return It(s=>{var i;return e==null?null:(i=r??s)!=null?i:null},[r,e])}function Ri(n,e){return d.useMemo(()=>n.reduce((t,r)=>{const{sensor:s}=r,i=s.activators.map(a=>({eventName:a.eventName,handler:e(a.handler,r)}));return[...t,...i]},[]),[n,e])}var Pt;(function(n){n[n.Always=0]="Always",n[n.BeforeDragging=1]="BeforeDragging",n[n.WhileDragging=2]="WhileDragging"})(Pt||(Pt={}));var kn;(function(n){n.Optimized="optimized"})(kn||(kn={}));const er=new Map;function Ti(n,e){let{dragging:t,dependencies:r,config:s}=e;const[i,a]=d.useState(null),{frequency:o,measure:c,strategy:u}=s,f=d.useRef(n),m=C(),g=Tt(m),v=d.useCallback(function(N){N===void 0&&(N=[]),!g.current&&a(M=>M===null?N:M.concat(N.filter(R=>!M.includes(R))))},[g]),S=d.useRef(null),x=It(N=>{if(m&&!t)return er;if(!N||N===er||f.current!==n||i!=null){const M=new Map;for(let R of n){if(!R)continue;if(i&&i.length>0&&!i.includes(R.id)&&R.rect.current){M.set(R.id,R.rect.current);continue}const O=R.node.current,k=O?new Dn(c(O),O):null;R.rect.current=k,k&&M.set(R.id,k)}return M}return N},[n,i,t,m,c]);return d.useEffect(()=>{f.current=n},[n]),d.useEffect(()=>{m||v()},[t,m]),d.useEffect(()=>{i&&i.length>0&&a(null)},[JSON.stringify(i)]),d.useEffect(()=>{m||typeof o!="number"||S.current!==null||(S.current=setTimeout(()=>{v(),S.current=null},o))},[o,m,v,...r]),{droppableRects:x,measureDroppableContainers:v,measuringScheduled:i!=null};function C(){switch(u){case Pt.Always:return!1;case Pt.BeforeDragging:return t;default:return!t}}}function $n(n,e){return It(t=>n?t||(typeof e=="function"?e(n):n):null,[e,n])}function $i(n,e){return $n(n,e)}function Oi(n){let{callback:e,disabled:t}=n;const r=nn(e),s=d.useMemo(()=>{if(t||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(r)},[r,t]);return d.useEffect(()=>()=>s?.disconnect(),[s]),s}function sn(n){let{callback:e,disabled:t}=n;const r=nn(e),s=d.useMemo(()=>{if(t||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(r)},[t]);return d.useEffect(()=>()=>s?.disconnect(),[s]),s}function Pi(n){return new Dn(Kt(n),n)}function tr(n,e,t){e===void 0&&(e=Pi);const[r,s]=d.useState(null);function i(){s(c=>{if(!n)return null;if(n.isConnected===!1){var u;return(u=c??t)!=null?u:null}const f=e(n);return JSON.stringify(c)===JSON.stringify(f)?c:f})}const a=Oi({callback(c){if(n)for(const u of c){const{type:f,target:m}=u;if(f==="childList"&&m instanceof HTMLElement&&m.contains(n)){i();break}}}}),o=sn({callback:i});return Ze(()=>{i(),n?(o?.observe(n),a?.observe(document.body,{childList:!0,subtree:!0})):(o?.disconnect(),a?.disconnect())},[n]),r}function qi(n){const e=$n(n);return xr(n,e)}const nr=[];function Ii(n){const e=d.useRef(n),t=It(r=>n?r&&r!==nr&&n&&e.current&&n.parentNode===e.current.parentNode?r:An(n):nr,[n]);return d.useEffect(()=>{e.current=n},[n]),t}function Ki(n){const[e,t]=d.useState(null),r=d.useRef(n),s=d.useCallback(i=>{const a=vn(i.target);a&&t(o=>o?(o.set(a,Cn(a)),new Map(o)):null)},[]);return d.useEffect(()=>{const i=r.current;if(n!==i){a(i);const o=n.map(c=>{const u=vn(c);return u?(u.addEventListener("scroll",s,{passive:!0}),[u,Cn(u)]):null}).filter(c=>c!=null);t(o.length?new Map(o):null),r.current=n}return()=>{a(n),a(i)};function a(o){o.forEach(c=>{const u=vn(c);u?.removeEventListener("scroll",s)})}},[s,n]),d.useMemo(()=>n.length?e?Array.from(e.values()).reduce((i,a)=>vt(i,a),Fe):Nr(n):Fe,[n,e])}function rr(n,e){e===void 0&&(e=[]);const t=d.useRef(null);return d.useEffect(()=>{t.current=null},e),d.useEffect(()=>{const r=n!==Fe;r&&!t.current&&(t.current=n),!r&&t.current&&(t.current=null)},[n]),t.current?Xt(n,t.current):Fe}function Bi(n){d.useEffect(()=>{if(!tn)return;const e=n.map(t=>{let{sensor:r}=t;return r.setup==null?void 0:r.setup()});return()=>{for(const t of e)t?.()}},n.map(e=>{let{sensor:t}=e;return t}))}function Fi(n,e){return d.useMemo(()=>n.reduce((t,r)=>{let{eventName:s,handler:i}=r;return t[s]=a=>{i(a,e)},t},{}),[n,e])}function Mr(n){return d.useMemo(()=>n?pi(n):null,[n])}const sr=[];function zi(n,e){e===void 0&&(e=Kt);const[t]=n,r=Mr(t?Se(t):null),[s,i]=d.useState(sr);function a(){i(()=>n.length?n.map(c=>kr(c)?r:new Dn(e(c),c)):sr)}const o=sn({callback:a});return Ze(()=>{o?.disconnect(),a(),n.forEach(c=>o?.observe(c))},[n]),s}function Rr(n){if(!n)return null;if(n.children.length>1)return n;const e=n.children[0];return qt(e)?e:n}function Wi(n){let{measure:e}=n;const[t,r]=d.useState(null),s=d.useCallback(u=>{for(const{target:f}of u)if(qt(f)){r(m=>{const g=e(f);return m?{...m,width:g.width,height:g.height}:g});break}},[e]),i=sn({callback:s}),a=d.useCallback(u=>{const f=Rr(u);i?.disconnect(),f&&i?.observe(f),r(f?e(f):null)},[e,i]),[o,c]=Qt(a);return d.useMemo(()=>({nodeRef:o,rect:t,setRef:c}),[t,o,c])}const Ui=[{sensor:Tn,options:{}},{sensor:Mn,options:{}}],Gi={current:{}},Yt={draggable:{measure:Vn},droppable:{measure:Vn,strategy:Pt.WhileDragging,frequency:kn.Optimized},dragOverlay:{measure:Kt}};class Mt extends Map{get(e){var t;return e!=null&&(t=super.get(e))!=null?t:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:t}=e;return!t})}getNodeFor(e){var t,r;return(t=(r=this.get(e))==null?void 0:r.node.current)!=null?t:void 0}}const Hi={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Mt,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Jt},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Yt,measureDroppableContainers:Jt,windowRect:null,measuringScheduled:!1},Tr={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Jt,draggableNodes:new Map,over:null,measureDroppableContainers:Jt},Bt=d.createContext(Tr),$r=d.createContext(Hi);function Yi(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Mt}}}function Qi(n,e){switch(e.type){case re.DragStart:return{...n,draggable:{...n.draggable,initialCoordinates:e.initialCoordinates,active:e.active}};case re.DragMove:return n.draggable.active==null?n:{...n,draggable:{...n.draggable,translate:{x:e.coordinates.x-n.draggable.initialCoordinates.x,y:e.coordinates.y-n.draggable.initialCoordinates.y}}};case re.DragEnd:case re.DragCancel:return{...n,draggable:{...n.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case re.RegisterDroppable:{const{element:t}=e,{id:r}=t,s=new Mt(n.droppable.containers);return s.set(r,t),{...n,droppable:{...n.droppable,containers:s}}}case re.SetDroppableDisabled:{const{id:t,key:r,disabled:s}=e,i=n.droppable.containers.get(t);if(!i||r!==i.key)return n;const a=new Mt(n.droppable.containers);return a.set(t,{...i,disabled:s}),{...n,droppable:{...n.droppable,containers:a}}}case re.UnregisterDroppable:{const{id:t,key:r}=e,s=n.droppable.containers.get(t);if(!s||r!==s.key)return n;const i=new Mt(n.droppable.containers);return i.delete(t),{...n,droppable:{...n.droppable,containers:i}}}default:return n}}function Vi(n){let{disabled:e}=n;const{active:t,activatorEvent:r,draggableNodes:s}=d.useContext(Bt),i=Vt(r),a=Vt(t?.id);return d.useEffect(()=>{if(!e&&!r&&i&&a!=null){if(!jn(i)||document.activeElement===i.target)return;const o=s.get(a);if(!o)return;const{activatorNode:c,node:u}=o;if(!c.current&&!u.current)return;requestAnimationFrame(()=>{for(const f of[c.current,u.current]){if(!f)continue;const m=Ws(f);if(m){m.focus();break}}})}},[r,e,s,a,i]),null}function Or(n,e){let{transform:t,...r}=e;return n!=null&&n.length?n.reduce((s,i)=>i({transform:s,...r}),t):t}function Xi(n){return d.useMemo(()=>({draggable:{...Yt.draggable,...n?.draggable},droppable:{...Yt.droppable,...n?.droppable},dragOverlay:{...Yt.dragOverlay,...n?.dragOverlay}}),[n?.draggable,n?.droppable,n?.dragOverlay])}function Ji(n){let{activeNode:e,measure:t,initialRect:r,config:s=!0}=n;const i=d.useRef(!1),{x:a,y:o}=typeof s=="boolean"?{x:s,y:s}:s;Ze(()=>{if(!a&&!o||!e){i.current=!1;return}if(i.current||!r)return;const u=e?.node.current;if(!u||u.isConnected===!1)return;const f=t(u),m=xr(f,r);if(a||(m.x=0),o||(m.y=0),i.current=!0,Math.abs(m.x)>0||Math.abs(m.y)>0){const g=Sr(u);g&&g.scrollBy({top:m.y,left:m.x})}},[e,a,o,r,t])}const on=d.createContext({...Fe,scaleX:1,scaleY:1});var lt;(function(n){n[n.Uninitialized=0]="Uninitialized",n[n.Initializing=1]="Initializing",n[n.Initialized=2]="Initialized"})(lt||(lt={}));const Zi=d.memo(function(e){var t,r,s,i;let{id:a,accessibility:o,autoScroll:c=!0,children:u,sensors:f=Ui,collisionDetection:m=yr,measuring:g,modifiers:v,...S}=e;const x=d.useReducer(Qi,void 0,Yi),[C,N]=x,[M,R]=Vs(),[O,k]=d.useState(lt.Uninitialized),_=O===lt.Initialized,{draggable:{active:A,nodes:E,translate:q},droppable:{containers:K}}=C,P=A!=null?E.get(A):null,V=d.useRef({initial:null,translated:null}),U=d.useMemo(()=>{var Q;return A!=null?{id:A,data:(Q=P?.data)!=null?Q:Gi,rect:V}:null},[A,P]),le=d.useRef(null),[Ce,ze]=d.useState(null),[se,et]=d.useState(null),Ee=Tt(S,Object.values(S)),Te=rn("DndDescribedBy",a),We=d.useMemo(()=>K.getEnabled(),[K]),ce=Xi(g),{droppableRects:I,measureDroppableContainers:tt,measuringScheduled:ct}=Ti(We,{dragging:_,dependencies:[q.x,q.y],config:ce.droppable}),me=Mi(E,A),Ye=d.useMemo(()=>se?$t(se):null,[se]),ue=Je(),Ue=$i(me,ce.draggable.measure);Ji({activeNode:A!=null?E.get(A):null,config:ue.layoutShiftCompensation,initialRect:Ue,measure:ce.draggable.measure});const X=tr(me,ce.draggable.measure,Ue),_e=tr(me?me.parentElement:null),$e=d.useRef({activatorEvent:null,active:null,activeNode:me,collisionRect:null,collisions:null,droppableRects:I,draggableNodes:E,draggingNode:null,draggingNodeRect:null,droppableContainers:K,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Oe=K.getNodeFor((t=$e.current.over)==null?void 0:t.id),de=Wi({measure:ce.dragOverlay.measure}),Ae=(r=de.nodeRef.current)!=null?r:me,fe=_?(s=de.rect)!=null?s:X:null,Qe=!!(de.nodeRef.current&&de.rect),nt=qi(Qe?null:X),Pe=Mr(Ae?Se(Ae):null),he=Ii(_?Oe??me:null),Ve=zi(he),rt=Or(v,{transform:{x:q.x-nt.x,y:q.y-nt.y,scaleX:1,scaleY:1},activatorEvent:se,active:U,activeNodeRect:X,containerNodeRect:_e,draggingNodeRect:fe,over:$e.current.over,overlayNodeRect:de.rect,scrollableAncestors:he,scrollableAncestorRects:Ve,windowRect:Pe}),qe=Ye?vt(Ye,q):null,Ge=Ki(he),St=rr(Ge),Ct=rr(Ge,[X]),Ie=vt(rt,St),Ke=fe?fi(fe,rt):null,Xe=U&&Ke?m({active:U,collisionRect:Ke,droppableRects:I,droppableContainers:We,pointerCoordinates:qe}):null,pt=oi(Xe,"id"),[De,mt]=d.useState(null),_t=Qe?rt:vt(rt,Ct),kt=ui(_t,(i=De?.rect)!=null?i:null,X),B=d.useRef(null),W=d.useCallback((Q,ve)=>{let{sensor:be,options:He}=ve;if(le.current==null)return;const ke=E.get(le.current);if(!ke)return;const ye=Q.nativeEvent,Me=new be({active:le.current,activeNode:ke,event:ye,options:He,context:$e,onAbort(H){if(!E.get(H))return;const{onDragAbort:xe}=Ee.current,w={id:H};xe?.(w),M({type:"onDragAbort",event:w})},onPending(H,Z,xe,w){if(!E.get(H))return;const{onDragPending:Y}=Ee.current,te={id:H,constraint:Z,initialCoordinates:xe,offset:w};Y?.(te),M({type:"onDragPending",event:te})},onStart(H){const Z=le.current;if(Z==null)return;const xe=E.get(Z);if(!xe)return;const{onDragStart:w}=Ee.current,Be={activatorEvent:ye,active:{id:Z,data:xe.data,rect:V}};Lt.unstable_batchedUpdates(()=>{w?.(Be),k(lt.Initializing),N({type:re.DragStart,initialCoordinates:H,active:Z}),M({type:"onDragStart",event:Be}),ze(B.current),et(ye)})},onMove(H){N({type:re.DragMove,coordinates:H})},onEnd:p(re.DragEnd),onCancel:p(re.DragCancel)});B.current=Me;function p(H){return async function(){const{active:xe,collisions:w,over:Be,scrollAdjustedTranslate:Y}=$e.current;let te=null;if(xe&&Y){const{cancelDrop:ut}=Ee.current;te={activatorEvent:ye,active:xe,collisions:w,delta:Y,over:Be},H===re.DragEnd&&typeof ut=="function"&&await Promise.resolve(ut(te))&&(H=re.DragCancel)}le.current=null,Lt.unstable_batchedUpdates(()=>{N({type:H}),k(lt.Uninitialized),mt(null),ze(null),et(null),B.current=null;const ut=H===re.DragEnd?"onDragEnd":"onDragCancel";if(te){const ge=Ee.current[ut];ge?.(te),M({type:ut,event:te})}})}}},[E]),G=d.useCallback((Q,ve)=>(be,He)=>{const ke=be.nativeEvent,ye=E.get(He);if(le.current!==null||!ye||ke.dndKit||ke.defaultPrevented)return;const Me={active:ye};Q(be,ve.options,Me)===!0&&(ke.dndKit={capturedBy:ve.sensor},le.current=He,W(be,ve))},[E,W]),st=Ri(f,G);Bi(f),Ze(()=>{X&&O===lt.Initializing&&k(lt.Initialized)},[X,O]),d.useEffect(()=>{const{onDragMove:Q}=Ee.current,{active:ve,activatorEvent:be,collisions:He,over:ke}=$e.current;if(!ve||!be)return;const ye={active:ve,activatorEvent:be,collisions:He,delta:{x:Ie.x,y:Ie.y},over:ke};Lt.unstable_batchedUpdates(()=>{Q?.(ye),M({type:"onDragMove",event:ye})})},[Ie.x,Ie.y]),d.useEffect(()=>{const{active:Q,activatorEvent:ve,collisions:be,droppableContainers:He,scrollAdjustedTranslate:ke}=$e.current;if(!Q||le.current==null||!ve||!ke)return;const{onDragOver:ye}=Ee.current,Me=He.get(pt),p=Me&&Me.rect.current?{id:Me.id,rect:Me.rect.current,data:Me.data,disabled:Me.disabled}:null,H={active:Q,activatorEvent:ve,collisions:be,delta:{x:ke.x,y:ke.y},over:p};Lt.unstable_batchedUpdates(()=>{mt(p),ye?.(H),M({type:"onDragOver",event:H})})},[pt]),Ze(()=>{$e.current={activatorEvent:se,active:U,activeNode:me,collisionRect:Ke,collisions:Xe,droppableRects:I,draggableNodes:E,draggingNode:Ae,draggingNodeRect:fe,droppableContainers:K,over:De,scrollableAncestors:he,scrollAdjustedTranslate:Ie},V.current={initial:fe,translated:Ke}},[U,me,Xe,Ke,E,Ae,fe,I,K,De,he,Ie]),ji({...ue,delta:q,draggingRect:Ke,pointerCoordinates:qe,scrollableAncestors:he,scrollableAncestorRects:Ve});const Ne=d.useMemo(()=>({active:U,activeNode:me,activeNodeRect:X,activatorEvent:se,collisions:Xe,containerNodeRect:_e,dragOverlay:de,draggableNodes:E,droppableContainers:K,droppableRects:I,over:De,measureDroppableContainers:tt,scrollableAncestors:he,scrollableAncestorRects:Ve,measuringConfiguration:ce,measuringScheduled:ct,windowRect:Pe}),[U,me,X,se,Xe,_e,de,E,K,I,De,tt,he,Ve,ce,ct,Pe]),Le=d.useMemo(()=>({activatorEvent:se,activators:st,active:U,activeNodeRect:X,ariaDescribedById:{draggable:Te},dispatch:N,draggableNodes:E,over:De,measureDroppableContainers:tt}),[se,st,U,X,N,Te,E,De,tt]);return J.createElement(br.Provider,{value:R},J.createElement(Bt.Provider,{value:Le},J.createElement($r.Provider,{value:Ne},J.createElement(on.Provider,{value:kt},u)),J.createElement(Vi,{disabled:o?.restoreFocus===!1})),J.createElement(Zs,{...o,hiddenTextDescribedById:Te}));function Je(){const Q=Ce?.autoScrollEnabled===!1,ve=typeof c=="object"?c.enabled===!1:c===!1,be=_&&!Q&&!ve;return typeof c=="object"?{...c,enabled:be}:{enabled:be}}}),eo=d.createContext(null),ir="button",to="Draggable";function no(n){let{id:e,data:t,disabled:r=!1,attributes:s}=n;const i=rn(to),{activators:a,activatorEvent:o,active:c,activeNodeRect:u,ariaDescribedById:f,draggableNodes:m,over:g}=d.useContext(Bt),{role:v=ir,roleDescription:S="draggable",tabIndex:x=0}=s??{},C=c?.id===e,N=d.useContext(C?on:eo),[M,R]=Qt(),[O,k]=Qt(),_=Fi(a,e),A=Tt(t);Ze(()=>(m.set(e,{id:e,key:i,node:M,activatorNode:O,data:A}),()=>{const q=m.get(e);q&&q.key===i&&m.delete(e)}),[m,e]);const E=d.useMemo(()=>({role:v,tabIndex:x,"aria-disabled":r,"aria-pressed":C&&v===ir?!0:void 0,"aria-roledescription":S,"aria-describedby":f.draggable}),[r,v,x,C,S,f.draggable]);return{active:c,activatorEvent:o,activeNodeRect:u,attributes:E,isDragging:C,listeners:r?void 0:_,node:M,over:g,setNodeRef:R,setActivatorNodeRef:k,transform:N}}function ro(){return d.useContext($r)}const so="Droppable",io={timeout:25};function oo(n){let{data:e,disabled:t=!1,id:r,resizeObserverConfig:s}=n;const i=rn(so),{active:a,dispatch:o,over:c,measureDroppableContainers:u}=d.useContext(Bt),f=d.useRef({disabled:t}),m=d.useRef(!1),g=d.useRef(null),v=d.useRef(null),{disabled:S,updateMeasurementsFor:x,timeout:C}={...io,...s},N=Tt(x??r),M=d.useCallback(()=>{if(!m.current){m.current=!0;return}v.current!=null&&clearTimeout(v.current),v.current=setTimeout(()=>{u(Array.isArray(N.current)?N.current:[N.current]),v.current=null},C)},[C]),R=sn({callback:M,disabled:S||!a}),O=d.useCallback((E,q)=>{R&&(q&&(R.unobserve(q),m.current=!1),E&&R.observe(E))},[R]),[k,_]=Qt(O),A=Tt(e);return d.useEffect(()=>{!R||!k.current||(R.disconnect(),m.current=!1,R.observe(k.current))},[k,R]),d.useEffect(()=>(o({type:re.RegisterDroppable,element:{id:r,key:i,disabled:t,node:k,rect:g,data:A}}),()=>o({type:re.UnregisterDroppable,key:i,id:r})),[r]),d.useEffect(()=>{t!==f.current.disabled&&(o({type:re.SetDroppableDisabled,id:r,key:i,disabled:t}),f.current.disabled=t)},[r,i,t,o]),{active:a,rect:g,isOver:c?.id===r,node:k,over:c,setNodeRef:_}}function ao(n){let{animation:e,children:t}=n;const[r,s]=d.useState(null),[i,a]=d.useState(null),o=Vt(t);return!t&&!r&&o&&s(o),Ze(()=>{if(!i)return;const c=r?.key,u=r?.props.id;if(c==null||u==null){s(null);return}Promise.resolve(e(u,i)).then(()=>{s(null)})},[e,r,i]),J.createElement(J.Fragment,null,t,r?d.cloneElement(r,{ref:a}):null)}const lo={x:0,y:0,scaleX:1,scaleY:1};function co(n){let{children:e}=n;return J.createElement(Bt.Provider,{value:Tr},J.createElement(on.Provider,{value:lo},e))}const uo={position:"fixed",touchAction:"none"},fo=n=>jn(n)?"transform 250ms ease":void 0,ho=d.forwardRef((n,e)=>{let{as:t,activatorEvent:r,adjustScale:s,children:i,className:a,rect:o,style:c,transform:u,transition:f=fo}=n;if(!o)return null;const m=s?u:{...u,scaleX:1,scaleY:1},g={...uo,width:o.width,height:o.height,top:o.top,left:o.left,transform:Ot.Transform.toString(m),transformOrigin:s&&r?ni(r,o):void 0,transition:typeof f=="function"?f(r):f,...c};return J.createElement(t,{className:a,style:g,ref:e},i)}),go=n=>e=>{let{active:t,dragOverlay:r}=e;const s={},{styles:i,className:a}=n;if(i!=null&&i.active)for(const[o,c]of Object.entries(i.active))c!==void 0&&(s[o]=t.node.style.getPropertyValue(o),t.node.style.setProperty(o,c));if(i!=null&&i.dragOverlay)for(const[o,c]of Object.entries(i.dragOverlay))c!==void 0&&r.node.style.setProperty(o,c);return a!=null&&a.active&&t.node.classList.add(a.active),a!=null&&a.dragOverlay&&r.node.classList.add(a.dragOverlay),function(){for(const[c,u]of Object.entries(s))t.node.style.setProperty(c,u);a!=null&&a.active&&t.node.classList.remove(a.active)}},po=n=>{let{transform:{initial:e,final:t}}=n;return[{transform:Ot.Transform.toString(e)},{transform:Ot.Transform.toString(t)}]},mo={duration:250,easing:"ease",keyframes:po,sideEffects:go({styles:{active:{opacity:"0"}}})};function vo(n){let{config:e,draggableNodes:t,droppableContainers:r,measuringConfiguration:s}=n;return nn((i,a)=>{if(e===null)return;const o=t.get(i);if(!o)return;const c=o.node.current;if(!c)return;const u=Rr(a);if(!u)return;const{transform:f}=Se(a).getComputedStyle(a),m=wr(f);if(!m)return;const g=typeof e=="function"?e:bo(e);return Lr(c,s.draggable.measure),g({active:{id:i,data:o.data,node:c,rect:s.draggable.measure(c)},draggableNodes:t,dragOverlay:{node:a,rect:s.dragOverlay.measure(u)},droppableContainers:r,measuringConfiguration:s,transform:m})})}function bo(n){const{duration:e,easing:t,sideEffects:r,keyframes:s}={...mo,...n};return i=>{let{active:a,dragOverlay:o,transform:c,...u}=i;if(!e)return;const f={x:o.rect.left-a.rect.left,y:o.rect.top-a.rect.top},m={scaleX:c.scaleX!==1?a.rect.width*c.scaleX/o.rect.width:1,scaleY:c.scaleY!==1?a.rect.height*c.scaleY/o.rect.height:1},g={x:c.x-f.x,y:c.y-f.y,...m},v=s({...u,active:a,dragOverlay:o,transform:{initial:c,final:g}}),[S]=v,x=v[v.length-1];if(JSON.stringify(S)===JSON.stringify(x))return;const C=r?.({active:a,dragOverlay:o,...u}),N=o.node.animate(v,{duration:e,easing:t,fill:"forwards"});return new Promise(M=>{N.onfinish=()=>{C?.(),M()}})}}let or=0;function yo(n){return d.useMemo(()=>{if(n!=null)return or++,or},[n])}const xo=J.memo(n=>{let{adjustScale:e=!1,children:t,dropAnimation:r,style:s,transition:i,modifiers:a,wrapperElement:o="div",className:c,zIndex:u=999}=n;const{activatorEvent:f,active:m,activeNodeRect:g,containerNodeRect:v,draggableNodes:S,droppableContainers:x,dragOverlay:C,over:N,measuringConfiguration:M,scrollableAncestors:R,scrollableAncestorRects:O,windowRect:k}=ro(),_=d.useContext(on),A=yo(m?.id),E=Or(a,{activatorEvent:f,active:m,activeNodeRect:g,containerNodeRect:v,draggingNodeRect:C.rect,over:N,overlayNodeRect:C.rect,scrollableAncestors:R,scrollableAncestorRects:O,transform:_,windowRect:k}),q=$n(g),K=vo({config:r,draggableNodes:S,droppableContainers:x,measuringConfiguration:M}),P=q?C.setRef:void 0;return J.createElement(co,null,J.createElement(ao,{animation:K},m&&A?J.createElement(ho,{key:A,id:m.id,ref:P,as:o,activatorEvent:f,adjustScale:e,className:c,transition:i,rect:q,style:{zIndex:u,...s},transform:E},t):null))}),wo=n=>{let{activatorEvent:e,draggingNodeRect:t,transform:r}=n;if(t&&e){const s=$t(e);if(!s)return r;const i=s.x-t.left,a=s.y-t.top;return{...r,x:r.x+i-t.width/2,y:r.y+a-t.height/2}}return r};function So(n,e,t){const r=Array.from(Array(n),()=>new Array(e));for(let s=0;s<n;s++)for(let i=0;i<e;i++)r[s][i]={squareId:`${On(i,e,t)}${Pr(s,n,t)}`,isLightSquare:(s+i)%2===0};return r}function Pr(n,e,t){return t==="white"?(e-n).toString():(n+1).toString()}function On(n,e,t){return t==="white"?String.fromCharCode(97+n):String.fromCharCode(97+e-n-1)}function ht(n,e,t){return t==="white"?n.charCodeAt(0)-97:e-(n.charCodeAt(0)-97)-1}function En(n,e,t){return t==="white"?e-Number(n):Number(n)-1}function xn(n,e,t){const r={},s=n.split(" ")[0].split("/");for(let i=0;i<s.length;i++){let a=0;for(const o of s[i])if(isNaN(Number(o))){const c=`${On(a,t,"white")}${Pr(i,e,"white")}`;r[c]={pieceType:Co(o)},a++}else a+=Number(o)}return r}function Co(n){return n.toLowerCase()===n?"b"+n.toUpperCase():"w"+n.toUpperCase()}function _o(n,e,t,r){const s={};for(const i in e){const a=[];if(n[i]?.pieceType!==e[i].pieceType){for(const o in n)n[o].pieceType===e[i].pieceType&&o!==i&&n[o].pieceType!==e[o]?.pieceType&&a.push(o);if(a.length===1)s[a[0]]=i;else{for(const o of a){const c=n[o].pieceType[1],u=Math.abs(ht(o.match(/^[a-z]+/)?.[0]??"",t,r)-ht(i.match(/^[a-z]+/)?.[0]??"",t,r)),f=Math.abs(Number(o.match(/\d+$/)?.[0]??"")-Number(i.match(/\d+$/)?.[0]??"")),m=(ht(o.match(/^[a-z]+/)?.[0]??"",t,r)+Number(o.match(/\d+$/)?.[0]??""))%2===0,g=(ht(i.match(/^[a-z]+/)?.[0]??"",t,r)+Number(i.match(/\d+$/)?.[0]??""))%2===0;if(c==="P"&&o.match(/^[a-z]+/)?.[0]===i.match(/^[a-z]+/)?.[0]){s[o]=i;break}if(c==="N"&&(u===2&&f===1||u===1&&f===2)){s[o]=i;break}if(c==="B"&&u===f&&m===g){s[o]=i;break}if(c==="R"&&(u===0||f===0)){s[o]=i;break}if(c==="Q"&&(u===0||f===0||u===f)){s[o]=i;break}if(c==="K"&&u<=1&&f<=1){s[o]=i;break}}if(!Object.values(s).includes(i)&&a.length>0){for(const o of a)if(!Object.keys(s).includes(o)){s[o]=i;break}}}}}return s}function ko(n,e,t,r){const s={};for(const i in e)if(n[i]?.pieceType!==e[i].pieceType)for(const a in n)e[a]?.pieceType!==n[a].pieceType&&Eo(n,e,a,i,t,r)&&(s[a]=i);return s}function Eo(n,e,t,r,s,i){const a=n[t].pieceType,o=e[r].pieceType,c=new Set(["Q","R","B","N"]);let u,f;if(a[1]==="P"&&c.has(o[1]))u=t,f=r;else if(o[1]==="P"&&c.has(a[1]))u=r,f=t;else return!1;if(Math.abs(ht(u[0],i,"black")-ht(f[0],i,"black"))>1||a[0]!==o[0])return!1;const g=En(u[1],s,"black"),v=En(f[1],s,"black");return a[0]==="b"&&g===1&&v===0?!0:a[0]==="w"&&g===s-2&&v===s-1}function ar(n,e,t,r,s){const i=e/t,a=ht(s.match(/^[a-z]+/)?.[0]??"",t,n)*i+i/2,o=En(s.match(/\d+$/)?.[0]??"",r,n)*i+i/2;return{x:a,y:o}}const No={wP:n=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",viewBox:"0 0 45 45",width:"100%",height:"100%",style:n?.svgStyle,children:l.jsx("path",{d:"m 22.5,9 c -2.21,0 -4,1.79 -4,4 0,0.89 0.29,1.71 0.78,2.38 C 17.33,16.5 16,18.59 16,21 c 0,2.03 0.94,3.84 2.41,5.03 C 15.41,27.09 11,31.58 11,39.5 H 34 C 34,31.58 29.59,27.09 26.59,26.03 28.06,24.84 29,23.03 29,21 29,18.59 27.67,16.5 25.72,15.38 26.21,14.71 26.5,13.89 26.5,13 c 0,-2.21 -1.79,-4 -4,-4 z",style:{opacity:"1",fill:n?.fill??"#ffffff",fillOpacity:"1",fillRule:"nonzero",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"miter",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}})}),wR:n=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",viewBox:"0 0 45 45",width:"100%",height:"100%",style:n?.svgStyle,children:l.jsxs("g",{style:{opacity:"1",fill:n?.fill??"#ffffff",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"},children:[l.jsx("path",{d:"M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z ",style:{strokeLinecap:"butt"}}),l.jsx("path",{d:"M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z ",style:{strokeLinecap:"butt"}}),l.jsx("path",{d:"M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14",style:{strokeLinecap:"butt"}}),l.jsx("path",{d:"M 34,14 L 31,17 L 14,17 L 11,14"}),l.jsx("path",{d:"M 31,17 L 31,29.5 L 14,29.5 L 14,17",style:{strokeLinecap:"butt",strokeLinejoin:"miter"}}),l.jsx("path",{d:"M 31,29.5 L 32.5,32 L 12.5,32 L 14,29.5"}),l.jsx("path",{d:"M 11,14 L 34,14",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}})]})}),wN:n=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",viewBox:"0 0 45 45",width:"100%",height:"100%",style:n?.svgStyle,children:l.jsxs("g",{style:{opacity:"1",fill:"none",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"},children:[l.jsx("path",{d:"M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18",style:{fill:n?.fill??"#ffffff",stroke:"#000000"}}),l.jsx("path",{d:"M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10",style:{fill:n?.fill??"#ffffff",stroke:"#000000"}}),l.jsx("path",{d:"M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z",style:{fill:"#000000",stroke:"#000000"}}),l.jsx("path",{d:"M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z",transform:"matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)",style:{fill:"#000000",stroke:"#000000"}})]})}),wB:n=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",viewBox:"0 0 45 45",width:"100%",height:"100%",style:n?.svgStyle,children:l.jsxs("g",{style:{opacity:"1",fill:"none",fillRule:"evenodd",fillOpacity:"1",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"},children:[l.jsxs("g",{style:{fill:n?.fill??"#ffffff",stroke:"#000000",strokeLinecap:"butt"},children:[l.jsx("path",{d:"M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.65,38.99 6.68,38.97 6,38 C 7.35,36.54 9,36 9,36 z"}),l.jsx("path",{d:"M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z"}),l.jsx("path",{d:"M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z"})]}),l.jsx("path",{d:"M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}})]})}),wQ:n=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",viewBox:"0 0 45 45",width:"100%",height:"100%",style:n?.svgStyle,children:l.jsxs("g",{style:{fill:n?.fill??"#ffffff",stroke:"#000000",strokeWidth:"1.5",strokeLinejoin:"round"},children:[l.jsx("path",{d:"M 9,26 C 17.5,24.5 30,24.5 36,26 L 38.5,13.5 L 31,25 L 30.7,10.9 L 25.5,24.5 L 22.5,10 L 19.5,24.5 L 14.3,10.9 L 14,25 L 6.5,13.5 L 9,26 z"}),l.jsx("path",{d:"M 9,26 C 9,28 10.5,28 11.5,30 C 12.5,31.5 12.5,31 12,33.5 C 10.5,34.5 11,36 11,36 C 9.5,37.5 11,38.5 11,38.5 C 17.5,39.5 27.5,39.5 34,38.5 C 34,38.5 35.5,37.5 34,36 C 34,36 34.5,34.5 33,33.5 C 32.5,31 32.5,31.5 33.5,30 C 34.5,28 36,28 36,26 C 27.5,24.5 17.5,24.5 9,26 z"}),l.jsx("path",{d:"M 11.5,30 C 15,29 30,29 33.5,30",style:{fill:"none"}}),l.jsx("path",{d:"M 12,33.5 C 18,32.5 27,32.5 33,33.5",style:{fill:"none"}}),l.jsx("circle",{cx:"6",cy:"12",r:"2"}),l.jsx("circle",{cx:"14",cy:"9",r:"2"}),l.jsx("circle",{cx:"22.5",cy:"8",r:"2"}),l.jsx("circle",{cx:"31",cy:"9",r:"2"}),l.jsx("circle",{cx:"39",cy:"12",r:"2"})]})}),wK:n=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",viewBox:"0 0 45 45",width:"100%",height:"100%",style:n?.svgStyle,children:l.jsxs("g",{style:{fill:"none",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"},children:[l.jsx("path",{d:"M 22.5,11.63 L 22.5,6",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}}),l.jsx("path",{d:"M 20,8 L 25,8",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}}),l.jsx("path",{d:"M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25",style:{fill:n?.fill??"#ffffff",stroke:"#000000",strokeLinecap:"butt",strokeLinejoin:"miter"}}),l.jsx("path",{d:"M 12.5,37 C 18,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 20,16 10.5,13 6.5,19.5 C 3.5,25.5 12.5,30 12.5,30 L 12.5,37",style:{fill:n?.fill??"#ffffff",stroke:"#000000"}}),l.jsx("path",{d:"M 12.5,30 C 18,27 27,27 32.5,30",style:{fill:"none",stroke:"#000000"}}),l.jsx("path",{d:"M 12.5,33.5 C 18,30.5 27,30.5 32.5,33.5",style:{fill:"none",stroke:"#000000"}}),l.jsx("path",{d:"M 12.5,37 C 18,34 27,34 32.5,37",style:{fill:"none",stroke:"#000000"}})]})}),bP:n=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",viewBox:"0 0 45 45",width:"100%",height:"100%",style:n?.svgStyle,children:l.jsx("path",{d:"m 22.5,9 c -2.21,0 -4,1.79 -4,4 0,0.89 0.29,1.71 0.78,2.38 C 17.33,16.5 16,18.59 16,21 c 0,2.03 0.94,3.84 2.41,5.03 C 15.41,27.09 11,31.58 11,39.5 H 34 C 34,31.58 29.59,27.09 26.59,26.03 28.06,24.84 29,23.03 29,21 29,18.59 27.67,16.5 25.72,15.38 26.21,14.71 26.5,13.89 26.5,13 c 0,-2.21 -1.79,-4 -4,-4 z",style:{opacity:"1",fill:n?.fill??"#000000",fillOpacity:"1",fillRule:"nonzero",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"miter",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}})}),bR:n=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",viewBox:"0 0 45 45",width:"100%",height:"100%",style:n?.svgStyle,children:l.jsxs("g",{style:{opacity:"1",fill:n?.fill??"#000000",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"},children:[l.jsx("path",{d:"M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z ",style:{strokeLinecap:"butt"}}),l.jsx("path",{d:"M 12.5,32 L 14,29.5 L 31,29.5 L 32.5,32 L 12.5,32 z ",style:{strokeLinecap:"butt"}}),l.jsx("path",{d:"M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z ",style:{strokeLinecap:"butt"}}),l.jsx("path",{d:"M 14,29.5 L 14,16.5 L 31,16.5 L 31,29.5 L 14,29.5 z ",style:{strokeLinecap:"butt",strokeLinejoin:"miter"}}),l.jsx("path",{d:"M 14,16.5 L 11,14 L 34,14 L 31,16.5 L 14,16.5 z ",style:{strokeLinecap:"butt"}}),l.jsx("path",{d:"M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14 L 11,14 z ",style:{strokeLinecap:"butt"}}),l.jsx("path",{d:"M 12,35.5 L 33,35.5 L 33,35.5",style:{fill:"none",stroke:"#ffffff",strokeWidth:"1",strokeLinejoin:"miter"}}),l.jsx("path",{d:"M 13,31.5 L 32,31.5",style:{fill:"none",stroke:"#ffffff",strokeWidth:"1",strokeLinejoin:"miter"}}),l.jsx("path",{d:"M 14,29.5 L 31,29.5",style:{fill:"none",stroke:"#ffffff",strokeWidth:"1",strokeLinejoin:"miter"}}),l.jsx("path",{d:"M 14,16.5 L 31,16.5",style:{fill:"none",stroke:"#ffffff",strokeWidth:"1",strokeLinejoin:"miter"}}),l.jsx("path",{d:"M 11,14 L 34,14",style:{fill:"none",stroke:"#ffffff",strokeWidth:"1",strokeLinejoin:"miter"}})]})}),bN:n=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",viewBox:"0 0 45 45",width:"100%",height:"100%",style:n?.svgStyle,children:l.jsxs("g",{style:{opacity:"1",fill:"none",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"},children:[l.jsx("path",{d:"M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18",style:{fill:n?.fill??"#000000",stroke:"#000000"}}),l.jsx("path",{d:"M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10",style:{fill:n?.fill??"#000000",stroke:"#000000"}}),l.jsx("path",{d:"M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z",style:{fill:"#ffffff",stroke:"#ffffff"}}),l.jsx("path",{d:"M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z",transform:"matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)",style:{fill:"#ffffff",stroke:"#ffffff"}}),l.jsx("path",{d:"M 24.55,10.4 L 24.1,11.85 L 24.6,12 C 27.75,13 30.25,14.49 32.5,18.75 C 34.75,23.01 35.75,29.06 35.25,39 L 35.2,39.5 L 37.45,39.5 L 37.5,39 C 38,28.94 36.62,22.15 34.25,17.66 C 31.88,13.17 28.46,11.02 25.06,10.5 L 24.55,10.4 z ",style:{fill:"#ffffff",stroke:"none"}})]})}),bB:n=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",viewBox:"0 0 45 45",width:"100%",height:"100%",style:n?.svgStyle,children:l.jsxs("g",{style:{opacity:"1",fill:"none",fillRule:"evenodd",fillOpacity:"1",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"},children:[l.jsxs("g",{style:{fill:n?.fill??"#000000",stroke:"#000000",strokeLinecap:"butt"},children:[l.jsx("path",{d:"M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.65,38.99 6.68,38.97 6,38 C 7.35,36.54 9,36 9,36 z"}),l.jsx("path",{d:"M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z"}),l.jsx("path",{d:"M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z"})]}),l.jsx("path",{d:"M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18",style:{fill:"none",stroke:"#ffffff",strokeLinejoin:"miter"}})]})}),bQ:n=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",viewBox:"0 0 45 45",width:"100%",height:"100%",style:n?.svgStyle,children:l.jsxs("g",{style:{fill:n?.fill??"#000000",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},children:[l.jsx("path",{d:"M 9,26 C 17.5,24.5 30,24.5 36,26 L 38.5,13.5 L 31,25 L 30.7,10.9 L 25.5,24.5 L 22.5,10 L 19.5,24.5 L 14.3,10.9 L 14,25 L 6.5,13.5 L 9,26 z",style:{strokeLinecap:"butt",fill:n?.fill??"#000000"}}),l.jsx("path",{d:"m 9,26 c 0,2 1.5,2 2.5,4 1,1.5 1,1 0.5,3.5 -1.5,1 -1,2.5 -1,2.5 -1.5,1.5 0,2.5 0,2.5 6.5,1 16.5,1 23,0 0,0 1.5,-1 0,-2.5 0,0 0.5,-1.5 -1,-2.5 -0.5,-2.5 -0.5,-2 0.5,-3.5 1,-2 2.5,-2 2.5,-4 -8.5,-1.5 -18.5,-1.5 -27,0 z"}),l.jsx("path",{d:"M 11.5,30 C 15,29 30,29 33.5,30"}),l.jsx("path",{d:"m 12,33.5 c 6,-1 15,-1 21,0"}),l.jsx("circle",{cx:"6",cy:"12",r:"2"}),l.jsx("circle",{cx:"14",cy:"9",r:"2"}),l.jsx("circle",{cx:"22.5",cy:"8",r:"2"}),l.jsx("circle",{cx:"31",cy:"9",r:"2"}),l.jsx("circle",{cx:"39",cy:"12",r:"2"}),l.jsx("path",{d:"M 11,38.5 A 35,35 1 0 0 34,38.5",style:{fill:"none",stroke:"#000000",strokeLinecap:"butt"}}),l.jsxs("g",{style:{fill:"none",stroke:"#ffffff"},children:[l.jsx("path",{d:"M 11,29 A 35,35 1 0 1 34,29"}),l.jsx("path",{d:"M 12.5,31.5 L 32.5,31.5"}),l.jsx("path",{d:"M 11.5,34.5 A 35,35 1 0 0 33.5,34.5"}),l.jsx("path",{d:"M 10.5,37.5 A 35,35 1 0 0 34.5,37.5"})]})]})}),bK:n=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",viewBox:"0 0 45 45",width:"100%",height:"100%",style:n?.svgStyle,children:l.jsxs("g",{style:{fill:"none",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"},children:[l.jsx("path",{d:"M 22.5,11.63 L 22.5,6",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"},id:"path6570"}),l.jsx("path",{d:"M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25",style:{fill:n?.fill??"#000000",fillOpacity:"1",strokeLinecap:"butt",strokeLinejoin:"miter"}}),l.jsx("path",{d:"M 12.5,37 C 18,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 20,16 10.5,13 6.5,19.5 C 3.5,25.5 12.5,30 12.5,30 L 12.5,37",style:{fill:n?.fill??"#000000",stroke:"#000000"}}),l.jsx("path",{d:"M 20,8 L 25,8",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}}),l.jsx("path",{d:"M 32,29.5 C 32,29.5 40.5,25.5 38.03,19.85 C 34.15,14 25,18 22.5,24.5 L 22.5,26.6 L 22.5,24.5 C 20,18 10.85,14 6.97,19.85 C 4.5,25.5 13,29.5 13,29.5",style:{fill:"none",stroke:"#ffffff"}}),l.jsx("path",{d:"M 12.5,30 C 18,27 27,27 32.5,30 M 12.5,33.5 C 18,30.5 27,30.5 32.5,33.5 M 12.5,37 C 18,34 27,34 32.5,37",style:{fill:"none",stroke:"#ffffff"}})]})})};function qr(n){return{display:"grid",gridTemplateColumns:`repeat(${n}, 1fr)`,overflow:"hidden",width:"100%",height:"100%",position:"relative"}}const Ir={aspectRatio:"1/1",display:"flex",justifyContent:"center",alignItems:"center",position:"relative"},Kr={backgroundColor:"#B58863"},Br={backgroundColor:"#F0D9B5"},Fr={boxShadow:"inset 0px 0px 0px 1px black"},zr={color:"#F0D9B5"},Wr={color:"#B58863"},Ur={fontSize:"13px",position:"absolute",bottom:1,right:4,userSelect:"none"},Gr={fontSize:"13px",position:"absolute",top:2,left:2,userSelect:"none"},Hr={transform:"scale(1.2)"},Yr={opacity:.5},Lo={color:"#ffaa00",secondaryColor:"#4caf50",tertiaryColor:"#f44336",arrowLengthReducerDenominator:8,sameTargetArrowLengthReducerDenominator:4,arrowWidthDenominator:5,activeArrowWidthMultiplier:.9,opacity:.65,activeOpacity:.5};class jo extends Tn{handleContextMenu=()=>{this.props&&typeof this.props.onCancel=="function"&&this.props.onCancel()};constructor(e){super(e),typeof window<"u"&&window.addEventListener("contextmenu",this.handleContextMenu,{passive:!1})}teardown(){typeof window<"u"&&window.removeEventListener("contextmenu",this.handleContextMenu)}}const Qr=d.createContext(null),wt=()=>d.use(Qr);function Ao({children:n,options:e}){const{id:t="chessboard",pieces:r=No,position:s="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR",boardOrientation:i="white",chessboardRows:a=8,chessboardColumns:o=8,boardStyle:c=qr(o),squareStyle:u=Ir,squareStyles:f={},darkSquareStyle:m=Kr,lightSquareStyle:g=Br,dropSquareStyle:v=Fr,draggingPieceStyle:S=Hr,draggingPieceGhostStyle:x=Yr,darkSquareNotationStyle:C=zr,lightSquareNotationStyle:N=Wr,alphaNotationStyle:M=Ur,numericNotationStyle:R=Gr,showNotation:O=!0,animationDurationInMs:k=300,showAnimations:_=!0,allowDragging:A=!0,allowDragOffBoard:E=!0,allowAutoScroll:q=!1,dragActivationDistance:K=1,allowDrawingArrows:P=!0,arrows:V=[],arrowOptions:U=Lo,clearArrowsOnClick:le=!0,clearArrowsOnPositionChange:Ce=!0,canDragPiece:ze,onArrowsChange:se,onMouseOutSquare:et,onMouseOverSquare:Ee,onPieceClick:Te,onPieceDrag:We,onPieceDrop:ce,onSquareClick:I,onSquareMouseDown:tt,onSquareMouseUp:ct,onSquareRightClick:me,squareRenderer:Ye}=e||{},[ue,Ue]=d.useState(null),[X,_e]=d.useState(typeof s=="string"?xn(s,a,o):s),[$e,Oe]=d.useState({}),[de,Ae]=d.useState(null),[fe,Qe]=d.useState(null),[nt,Pe]=d.useState(null),[he,Ve]=d.useState([]),[rt,qe]=d.useState(null),Ge=d.useRef(null),St=`dnd-${t}`;d.useEffect(()=>{const B=typeof s=="string"?xn(s,a,o):s;if(Ce&&Ke(),!_){_e(B);return}const W=rt;W&&(_e(W),qe(null));const G=_o(W??X,B,o,i),st=Object.keys(G).length>1;if(de&&st){const Le={...X};delete Le[de.sourceSquare],Le[de.targetSquare]={pieceType:de.piece},_e(Le);const Je={...G};delete Je[de.sourceSquare],Oe(Je);const Q=setTimeout(()=>{_e(B),Oe({}),Ae(null)},k);Ge.current=Q;return}if(de){_e(B),Ae(null);return}if(Object.keys(G).length===0){const Le=ko(W??X,B,a,o);if(Object.keys(Le).length===1){Oe(Le),qe(B);const Je=setTimeout(()=>{_e(B),Oe({}),qe(null)},k);Ge.current=Je;return}}Oe(G),qe(B);const Ne=setTimeout(()=>{_e(B),Oe({}),qe(null)},k);return Ge.current=Ne,()=>{Ge.current&&clearTimeout(Ge.current)}},[s]),d.useEffect(()=>{_e(typeof s=="string"?xn(s,a,o):s)},[a,o,i]),d.useEffect(()=>{se?.({arrows:he})},[he]);const Ct=d.useMemo(()=>So(a,o,i),[a,o,i]),Ie=d.useCallback((B,W)=>{if(!P)return;const G=he.findIndex(Ne=>Ne.startSquare===fe&&Ne.endSquare===B);if(V.some(Ne=>Ne.startSquare===fe&&Ne.endSquare===B)){Qe(null),Pe(null);return}if(fe&&fe!==B){const Ne=W?.shiftKey?U.secondaryColor:W?.ctrlKey?U.tertiaryColor:U.color;Ve(Le=>G===-1?[...Le,{startSquare:fe,endSquare:B,color:Ne}]:Le.filter((Je,Q)=>Q!==G)),Qe(null),Pe(null)}},[P,V,U.color,U.secondaryColor,U.tertiaryColor,he,fe,nt]),Ke=d.useCallback(()=>{le&&(Ve([]),Qe(null),Pe(null))},[le]),Xe=d.useCallback((B,W)=>{const G=W?.shiftKey?U.secondaryColor:W?.ctrlKey?U.tertiaryColor:U.color;Pe(B?{square:B,color:G}:null)},[U]),pt=d.useCallback(()=>{Ue(null)},[]),De=d.useCallback(function(W){if(!ue)return;const G=W.over?.id.toString();if(!G){ce?.({piece:ue,sourceSquare:ue.position,targetSquare:null}),Ae({piece:ue.pieceType,sourceSquare:ue.position,targetSquare:""}),Ue(null);return}W.over&&(ce?.({piece:ue,sourceSquare:ue.position,targetSquare:G})&&Ae({piece:ue.pieceType,sourceSquare:ue.position,targetSquare:G}),Ue(null))},[ue]),mt=d.useCallback(function({active:W}){const G=W.data.current?.isSparePiece;We?.({isSparePiece:G,piece:G?{pieceType:W.id}:X[W.id],square:G?null:W.id}),Ue({isSparePiece:G,position:W.id,pieceType:G?W.id:X[W.id].pieceType})},[X]),_t=ei(Ut(jo,{activationConstraint:K>0?{distance:K}:void 0}),Ut(Mn),Ut(Dr),Ut(Ar));function kt(B){return B.pointerCoordinates?ci(B):yr(B)}return l.jsx(Qr.Provider,{value:{id:t,pieces:r,boardOrientation:i,chessboardRows:a,chessboardColumns:o,boardStyle:c,squareStyle:u,squareStyles:f,darkSquareStyle:m,lightSquareStyle:g,dropSquareStyle:v,draggingPieceStyle:S,draggingPieceGhostStyle:x,darkSquareNotationStyle:C,lightSquareNotationStyle:N,alphaNotationStyle:M,numericNotationStyle:R,showNotation:O,animationDurationInMs:k,showAnimations:_,allowDragging:A,allowDragOffBoard:E,allowDrawingArrows:P,arrows:V,arrowOptions:U,canDragPiece:ze,onMouseOutSquare:et,onMouseOverSquare:Ee,onPieceClick:Te,onSquareClick:I,onSquareMouseDown:tt,onSquareMouseUp:ct,onSquareRightClick:me,squareRenderer:Ye,board:Ct,isWrapped:!0,draggingPiece:ue,currentPosition:X,positionDifferences:$e,newArrowStartSquare:fe,newArrowOverSquare:nt,setNewArrowStartSquare:Qe,setNewArrowOverSquare:Xe,internalArrows:he,drawArrow:Ie,clearArrows:Ke},children:l.jsx(Zi,{autoScroll:q,collisionDetection:kt,onDragStart:mt,onDragEnd:De,onDragCancel:pt,sensors:_t,id:St,children:n})})}function Do(){const{id:n,arrows:e,arrowOptions:t,boardOrientation:r,chessboardColumns:s,chessboardRows:i,internalArrows:a,newArrowStartSquare:o,newArrowOverSquare:c}=wt(),u=2048,f=u*(i/s),m=o&&c&&o!==c.square?{startSquare:o,endSquare:c.square,color:c.color}:null,g=m?[...e,...a,m]:[...e,...a];return l.jsx("svg",{viewBox:`0 0 ${u} ${f}`,style:{position:"absolute",top:"0",right:"0",bottom:"0",left:"0",pointerEvents:"none",zIndex:"20"},children:g.map((v,S)=>{const x=ar(r,u,s,i,v.startSquare),C=ar(r,u,s,i,v.endSquare),N=u/s;let M=N/t.arrowLengthReducerDenominator;const R=m&&S===g.length-1;g.some(E=>E.startSquare!==v.startSquare&&E.endSquare===v.endSquare)&&!R&&(M=N/t.sameTargetArrowLengthReducerDenominator);const O=C.x-x.x,k=C.y-x.y,_=Math.hypot(k,O);let A;if(_===Math.hypot(1,2)*N){const E=Math.abs(O)<Math.abs(k)?{x:x.x,y:C.y}:{x:C.x,y:x.y},q=C.x-E.x,K=C.y-E.y,P=N,V={x:E.x+q*(P-M)/P,y:E.y+K*(P-M)/P};A=`M${x.x},${x.y} L${E.x},${E.y} L${V.x},${V.y}`}else{const E={x:x.x+O*(_-M)/_,y:x.y+k*(_-M)/_};A=`M${x.x},${x.y} L${E.x},${E.y}`}return l.jsxs(d.Fragment,{children:[l.jsx("marker",{id:`${n}-arrowhead-${S}-${v.startSquare}-${v.endSquare}`,markerWidth:"2",markerHeight:"2.5",refX:"1.25",refY:"1.25",orient:"auto",children:l.jsx("polygon",{points:"0.3 0, 2 1.25, 0.3 2.5",fill:v.color})}),l.jsx("path",{d:A,fill:"none",opacity:R?t.activeOpacity:t.opacity,stroke:v.color,strokeWidth:R?t.activeArrowWidthMultiplier*(N/t.arrowWidthDenominator):N/t.arrowWidthDenominator,markerEnd:`url(#${n}-arrowhead-${S}-${v.startSquare}-${v.endSquare})`})]},`${n}-arrow-${v.startSquare}-${v.endSquare}${R?"-active":""}`)})})}function Mo({children:n,isSparePiece:e=!1,pieceType:t,position:r}){const{allowDragging:s,canDragPiece:i}=wt(),{setNodeRef:a,attributes:o,listeners:c}=no({id:r,data:{isSparePiece:e,pieceType:t},disabled:!s||i&&!i({piece:{pieceType:t},isSparePiece:e,square:r})});return l.jsx("div",{ref:a,...o,...c,children:n})}function Ro({children:n,squareId:e}){const{isOver:t,setNodeRef:r}=oo({id:e});return l.jsx("div",{ref:r,children:n({isOver:t})})}const lr=d.memo(function({clone:e,isSparePiece:t=!1,position:r,pieceType:s}){const{id:i,allowDragging:a,animationDurationInMs:o,boardOrientation:c,canDragPiece:u,draggingPiece:f,draggingPieceStyle:m,draggingPieceGhostStyle:g,pieces:v,positionDifferences:S,onPieceClick:x}=wt(),[C,N]=d.useState({});let M=e?"grabbing":"grab";(!a||u&&!u({piece:{pieceType:s},isSparePiece:t,square:r}))&&(M="pointer"),d.useEffect(()=>{if(S[r]){const O=r,k=S[r],_=document.querySelector(`#${i}-square-${O}`)?.getBoundingClientRect().width;if(!_)throw new Error("Square width not found");N({transform:`translate(${(c==="black"?-1:1)*(k.charCodeAt(0)-O.charCodeAt(0))*_}px, ${(c==="black"?-1:1)*(Number(O[1])-Number(k[1]))*_}px)`,transition:`transform ${o}ms`,position:"relative",zIndex:10})}else N({})},[S]);const R=v[s];return l.jsx("div",{id:`${i}-piece-${s}-${r}`,"data-piece":s,style:{...C,...e?{...Hr,...m}:{},...!e&&f?.position===r?{...Yr,...g}:{},width:"100%",height:"100%",cursor:M,touchAction:"none"},onClick:()=>x?.({isSparePiece:t,piece:{pieceType:s},square:r}),children:l.jsx(R,{})})}),To=d.memo(function({children:e,squareId:t,isLightSquare:r,isOver:s}){const[i,a]=d.useState(!1),{id:o,allowDrawingArrows:c,boardOrientation:u,chessboardColumns:f,chessboardRows:m,currentPosition:g,draggingPiece:v,squareStyle:S,squareStyles:x,darkSquareStyle:C,lightSquareStyle:N,dropSquareStyle:M,darkSquareNotationStyle:R,lightSquareNotationStyle:O,alphaNotationStyle:k,numericNotationStyle:_,showNotation:A,onMouseOutSquare:E,onMouseOverSquare:q,onSquareClick:K,onSquareMouseDown:P,onSquareMouseUp:V,onSquareRightClick:U,squareRenderer:le,newArrowStartSquare:Ce,setNewArrowStartSquare:ze,setNewArrowOverSquare:se,drawArrow:et,clearArrows:Ee}=wt(),Te=d.useRef(s);d.useEffect(()=>{s&&v?q?.({piece:g[t]??null,square:t}):!s&&v&&Te.current&&E?.({piece:g[t]??null,square:t}),Te.current=s},[g,v,s,t]);const We=t.match(/^[a-z]+/)?.[0],ce=t.match(/\d+$/)?.[0];return l.jsxs("div",{id:`${o}-square-${t}`,style:{...Ir,...S,...r?{...Br,...N}:{...Kr,...C},...s?{...Fr,...M}:{}},"data-column":We,"data-row":ce,"data-square":t,onClick:I=>{I.button===0&&K?.({piece:g[t]??null,square:t})},onTouchEnd:I=>{I.preventDefault(),K?.({piece:g[t]??null,square:t})},onContextMenu:I=>{I.preventDefault(),i||U?.({piece:g[t]??null,square:t}),a(!1)},onMouseDown:I=>{I.button===0&&Ee(),I.button===2&&c&&ze(t),P?.({piece:g[t]??null,square:t},I)},onMouseUp:I=>{I.button===2&&(c&&Ce&&Ce!==t?(a(!0),et(t,{shiftKey:I.shiftKey,ctrlKey:I.ctrlKey})):Ce===t&&(ze(null),se(null))),V?.({piece:g[t]??null,square:t},I)},onMouseOver:I=>{I.buttons===2&&c&&Ce&&Ce!==t?se(t,{shiftKey:I.shiftKey,ctrlKey:I.ctrlKey}):Ce===t&&se(null),v||q?.({piece:g[t]??null,square:t})},onMouseLeave:()=>{v||E?.({piece:g[t]??null,square:t})},children:[A?l.jsxs("span",{style:r?{...Wr,...O}:{...zr,...R},children:[ce===(u==="white"?"1":m.toString())&&l.jsx("span",{style:{...Ur,...k},children:We}),We===(u==="white"?"a":On(0,f,u))&&l.jsx("span",{style:{...Gr,..._},children:ce})]}):null,le?.({piece:g[t]??null,square:t,children:e})||l.jsx("div",{style:{width:"100%",height:"100%",...x[t]},children:e})]})}),$o=(n,e)=>({transform:t})=>{const r=typeof document<"u"?document.getElementById(`${n}-board`):null;if(!r)return t;const s=r.getBoundingClientRect(),i=r.querySelector('[data-column="a"][data-row="1"]');if(!i)return t;const o=i.getBoundingClientRect().width/2,c=e.match(/^([a-zA-Z]+)(\d+)$/);if(!c)return t;const[,u,f]=c,m=r.querySelector(`[data-column="${u}"][data-row="${f}"]`);if(!m)return t;const g=m.getBoundingClientRect(),v=g.left+o-s.left,S=g.top+o-s.top,x=-v,C=s.width-v,N=-S,M=s.height-S,R=Math.min(Math.max(t.x,x),C),O=Math.min(Math.max(t.y,N),M);return{...t,x:R,y:O}};function cr(){const{allowDragOffBoard:n,board:e,boardStyle:t,chessboardColumns:r,currentPosition:s,draggingPiece:i,id:a}=wt();return l.jsxs(l.Fragment,{children:[l.jsxs("div",{id:`${a}-board`,style:{...qr(r),...t},children:[e.map(o=>o.map(c=>{const u=s[c.squareId];return l.jsx(Ro,{squareId:c.squareId,children:({isOver:f})=>l.jsx(To,{isOver:f,...c,children:u?l.jsx(Mo,{isSparePiece:!1,position:c.squareId,pieceType:u.pieceType,children:l.jsx(lr,{...u,position:c.squareId})}):null})},c.squareId)})),l.jsx(Do,{})]}),l.jsx(xo,{dropAnimation:null,modifiers:[wo,...n?[]:[$o(a,i?.position||"")]],children:i?l.jsx(lr,{clone:!0,position:i.position,pieceType:i.pieceType}):null})]})}function Oo({options:n}){const{isWrapped:e}=wt()??{isWrapped:!1};return e?l.jsx(cr,{}):l.jsx(Ao,{options:n,children:l.jsx(cr,{})})}class Po{constructor(){this.worker=new Worker("/stockfish/stockfish.js"),this.isReady=!1,this.worker.onmessage=e=>{e.data==="uciok"&&(this.isReady=!0)},this.worker.postMessage("uci")}onMessage(e){this.worker.onmessage=t=>{e(t.data)}}evaluatePosition(e,t=10){this.worker.postMessage(`position fen ${e}`),this.worker.postMessage(`go depth ${t}`)}stop(){this.worker.postMessage("stop")}quit(){this.worker.postMessage("quit"),this.worker.terminate()}}function qo({moves:n=[]}){const e=d.useRef(null);d.useEffect(()=>{e.current&&(e.current.scrollTop=e.current.scrollHeight)},[n]);const t=[];for(let r=0;r<n.length;r+=2)t.push({number:Math.floor(r/2)+1,white:n[r],black:n[r+1]||null});return l.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-xl overflow-hidden flex flex-col h-64 md:h-96",children:[l.jsx("div",{className:"bg-brand-navy/50 p-3 border-b border-white/10",children:l.jsx("h3",{className:"text-white font-display font-bold text-sm uppercase tracking-wider",children:"Move History"})}),l.jsxs("div",{ref:e,className:"flex-1 overflow-y-auto p-2 scrollbar-thin scrollbar-thumb-white/20 scrollbar-track-transparent",children:[l.jsxs("table",{className:"w-full text-sm text-slate-300",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"text-xs text-slate-500 uppercase text-left",children:[l.jsx("th",{className:"py-1 pl-2 w-10",children:"#"}),l.jsx("th",{className:"py-1",children:"White"}),l.jsx("th",{className:"py-1",children:"Black"})]})}),l.jsx("tbody",{children:t.map(r=>l.jsxs("tr",{className:"hover:bg-white/5 transition-colors border-b border-white/5 last:border-0",children:[l.jsxs("td",{className:"py-2 pl-2 font-mono text-slate-500",children:[r.number,"."]}),l.jsx("td",{className:"py-2 font-medium text-white",children:r.white.san}),l.jsx("td",{className:"py-2 font-medium text-slate-300",children:r.black?r.black.san:""})]},r.number))})]}),n.length===0&&l.jsx("div",{className:"h-full flex items-center justify-center text-slate-500 text-sm italic",children:"No moves yet. Start the game!"})]})]})}function Io({onCommand:n}){const[e,t]=d.useState(!1),[r,s]=d.useState(""),[i,a]=d.useState(!1);d.useEffect(()=>{!("webkitSpeechRecognition"in window)&&!("SpeechRecognition"in window)&&a(!0)},[]);const o=()=>{if(i)return;if(e){t(!1);return}const c=window.SpeechRecognition||window.webkitSpeechRecognition,u=new c;u.lang="en-US",u.interimResults=!1,u.maxAlternatives=1,u.onstart=()=>{t(!0),s("Listening...")},u.onresult=f=>{const m=f.results.length-1,g=f.results[m][0].transcript;s(`Recognized: "${g}"`),n&&n(g)},u.onerror=f=>{s(`Error: ${f.error}`),t(!1)},u.onend=()=>{t(!1)},u.start()};return i?l.jsx("div",{className:"mt-4 text-xs text-red-400",children:"Voice control not supported in this browser."}):l.jsxs("div",{className:"mt-4 flex flex-col items-center gap-2",children:[l.jsxs("button",{onClick:o,className:`flex items-center gap-2 px-6 py-3 rounded-full transition-all shadow-lg ${e?"bg-red-500 hover:bg-red-600 text-white animate-pulse":"bg-brand-orange hover:bg-orange-600 text-white"}`,children:[l.jsx("span",{className:"material-symbols-outlined",children:e?"mic":"mic_none"}),l.jsx("span",{className:"font-medium",children:e?"Stop Listening":"Voice Command"})]}),r&&l.jsx("div",{className:"text-white/80 text-sm font-light italic",children:r})]})}function Ko(){const{user:n}=dr(),[e,t]=d.useState([]),[r,s]=d.useState(!1);return d.useEffect(()=>{if(!n)return;s(!0);const i=ls(fr(hr,`users/${n.uid}/games`),us("date","desc"),cs(10)),a=ds(i,o=>{const c=o.docs.map(u=>({id:u.id,...u.data()}));t(c),s(!1)},o=>{console.error("Error fetching games:",o),s(!1)});return()=>a()},[n]),n?l.jsxs("div",{className:"bg-white/5 p-4 rounded-xl border border-white/10 mt-4 h-64 overflow-hidden flex flex-col",children:[l.jsx("h3",{className:"font-display font-bold text-white mb-2 text-sm uppercase",children:"Recent Matches"}),l.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-thin scrollbar-thumb-white/20",children:r?l.jsx("div",{className:"text-slate-400 text-xs",children:"Loading..."}):e.length===0?l.jsx("div",{className:"text-slate-400 text-xs",children:"No matches found."}):l.jsx("div",{className:"space-y-2",children:e.map(i=>l.jsxs("div",{className:"bg-white/5 p-2 rounded text-xs hover:bg-white/10 transition-colors cursor-default",children:[l.jsxs("div",{className:"flex justify-between text-slate-300 mb-1",children:[l.jsx("span",{children:new Date(i.date?.toDate()).toLocaleDateString()}),l.jsx("span",{className:i.result==="Win"?"text-green-400":"text-slate-400",children:i.result})]}),l.jsx("div",{className:"text-slate-500 truncate font-mono",children:i.pgn?i.pgn.substring(0,20)+"...":"No moves"})]},i.id))})})]}):l.jsx("div",{className:"text-slate-500 text-xs mt-2",children:"Sign in to see history."})}function Bo(){const{user:n}=dr(),[e,t]=d.useState(new pn),[r,s]=d.useState(e.fen()),[i,a]=d.useState([]),[o,c]=d.useState("white"),[u,f]=d.useState("Initializing AI..."),[m,g]=d.useState(!1),[v,S]=d.useState(!1),x=d.useMemo(()=>new Po,[]);d.useEffect(()=>(x.onMessage(k=>{if(k.startsWith("bestmove")){const _=k.split(" ")[1];_&&(N({from:_.substring(0,2),to:_.substring(2,4),promotion:_.length>4?_[4]:"q"}),g(!1),f("Your Turn"))}}),f("AI Ready"),()=>x.quit()),[x]),d.useEffect(()=>{e.isGameOver()&&!v&&(S(!0),f("Game Over"),C())},[e,v]);async function C(){if(!n)return;let k="Draw";if(e.isCheckmate()){const _=e.turn()==="w"?"Black":"White";k=_==="White"&&o==="white"?"Win":"Loss",_!==(e.turn()==="w"?"Black":"White")&&(k="Loss")}try{await fs(fr(hr,`users/${n.uid}/games`),{pgn:e.pgn(),fen:e.fen(),date:hs(),result:k,opponent:"Stockfish AI"}),console.log("Game saved!")}catch(_){console.error("Error saving game:",_)}}function N(k){try{const _=new pn(e.fen()),A=_.move(k);if(A)return t(_),s(_.fen()),a(_.history({verbose:!0})),A}catch{return console.warn("Invalid move:",k),null}return null}function M(k,_){return e.turn()!==o[0]||m||v||N({from:k,to:_,promotion:"q"})===null?!1:(R(),!0)}function R(){e.isGameOver()||(g(!0),f("AI Thinking..."),setTimeout(()=>{x.evaluatePosition(e.fen(),15)},500))}function O(k){if(v)return;const A=k.toLowerCase().replace(/to/g,"").replace(/ /g,"").match(/[a-h][1-8]/g);if(A&&A.length>=2){const E={from:A[0],to:A[1],promotion:"q"};N(E)?R():f("Invalid Voice Move")}}return l.jsxs("div",{className:"flex flex-col lg:flex-row h-full w-full gap-6 p-4",children:[l.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center bg-white/5 rounded-2xl p-4 shadow-xl backdrop-blur-sm border border-white/10",children:[l.jsx("div",{className:"w-full max-w-[60vh] aspect-square shadow-2xl rounded-sm overflow-hidden border-4 border-[#3D3242]",children:l.jsx(Oo,{position:r,onPieceDrop:M,boardOrientation:o,customDarkSquareStyle:{backgroundColor:"#779556"},customLightSquareStyle:{backgroundColor:"#ebecd0"}})}),l.jsx("div",{className:"mt-6 flex items-center gap-4 text-white",children:l.jsx("div",{className:`px-4 py-2 rounded-full text-sm font-medium ${m?"bg-orange-500 animate-pulse":"bg-green-600"}`,children:u})}),l.jsx(Io,{onCommand:O})]}),l.jsxs("div",{className:"w-full lg:w-80 flex flex-col gap-4",children:[l.jsx(qo,{moves:i}),l.jsx(Ko,{}),l.jsxs("div",{className:"bg-white/5 p-4 rounded-xl border border-white/10 text-white",children:[l.jsx("h3",{className:"font-display font-bold mb-4",children:"Game Controls"}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsx("button",{className:"bg-brand-navy hover:bg-brand-navy/80 py-2 rounded text-sm transition-colors",onClick:()=>{const k=new pn;t(k),s(k.fen()),a([]),g(!1),S(!1)},children:"New Game"}),l.jsx("button",{className:"bg-slate-700 hover:bg-slate-600 py-2 rounded text-sm transition-colors",onClick:()=>{c(o==="white"?"black":"white"),e.turn()==="w"&&o==="white"&&(g(!0),x.evaluatePosition(e.fen(),5))},children:"Switch Sides"})]})]})]})]})}const ur=[{id:"chess",title:"Grandmaster AI",icon:"smart_toy",component:Bo},{id:"premier",title:"Retail Premier League",icon:"workspace_premium",component:gr},{id:"ramadan",title:"Kindness Quest",icon:"volunteer_activism",component:ps},{id:"green",title:"Sustainability",icon:"eco",component:vs}];function zo(){const[n,e]=d.useState("chess"),t=ur.find(r=>r.id===n)?.component||gr;return l.jsxs("div",{className:"games-page-container fade-in",children:[l.jsx("div",{className:"games-header",children:l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl md:text-4xl font-display font-medium text-brand-navy mb-1 md:mb-2",children:"Gamified Insights"}),l.jsx("p",{className:"text-slate-500 text-sm md:text-lg font-light",children:"Information made fun and interactive."})]})}),l.jsxs("div",{className:"games-layout",children:[l.jsx("div",{className:"games-sidebar",children:ur.map(r=>l.jsxs("button",{className:`game-nav-item ${n===r.id?"active":""}`,onClick:()=>e(r.id),children:[l.jsx("span",{className:"material-symbols-outlined",children:r.icon}),l.jsx("span",{className:"game-nav-label",children:r.title})]},r.id))}),l.jsx("div",{className:"game-display-area",children:l.jsx(t,{})})]})]})}export{zo as default};
